{"version":3,"sources":["controllers/Exporter.js","controllers/Importer.js","controllers/Input.js","controllers/ItemNavController.js","controllers/PlaceItemController.js","controllers/SelectionBox.js","controllers/SideNavController.js","controllers/Tool.js","controllers/TransformController.js","controllers/WireController.js","libraries/Camera.js","libraries/Clipboard.js","libraries/Context.js","libraries/CopyUtils.js","libraries/HistoryManager.js","libraries/Propogation.js","libraries/UIDManager.js","libraries/Utils.js","views/CircuitDesigner.js","views/ICDesigner.js","views/Main.js","views/Renderer.js","models/IOObject.js","models/IOPort.js","models/IPort.js","models/OPort.js","models/Wire.js","models/WirePort.js","controllers/selectionpopup/BusButtonModule.js","controllers/selectionpopup/ColorPickerModule.js","controllers/selectionpopup/ICButtonModule.js","controllers/selectionpopup/InputCountModule.js","controllers/selectionpopup/PositionXModule.js","controllers/selectionpopup/PositionYModule.js","controllers/selectionpopup/SelectionPopup.js","controllers/selectionpopup/TitleModule.js","controllers/contextmenu/ContextMenu.js","controllers/contextmenu/CopyModule.js","controllers/contextmenu/CutModule.js","controllers/contextmenu/PasteModule.js","controllers/contextmenu/RedoModule.js","controllers/contextmenu/SelectAllModule.js","controllers/contextmenu/UndoModule.js","controllers/tools/ItemTool.js","controllers/tools/SelectionTool.js","controllers/tools/WiringTool.js","libraries/actions/Action.js","libraries/actions/DeleteAction.js","libraries/actions/GroupAction.js","libraries/actions/PlaceAction.js","libraries/actions/PlaceWireAction.js","libraries/actions/SelectAction.js","libraries/actions/SplitWireAction.js","libraries/actions/TransformAction.js","libraries/math/Bezier.js","libraries/math/Matrix.js","libraries/math/Transform.js","libraries/math/Vector.js","libraries/popup/Module.js","libraries/popup/Popup.js","models/ioobjects/Gate.js","models/ioobjects/gates/ANDGate.js","models/ioobjects/gates/BUFGate.js","models/ioobjects/gates/ORGate.js","models/ioobjects/gates/XORGate.js","models/ioobjects/flipflops/SRFlipFlop.js","models/ioobjects/inputs/Button.js","models/ioobjects/inputs/Clock.js","models/ioobjects/inputs/ConstantHigh.js","models/ioobjects/inputs/ConstantLow.js","models/ioobjects/inputs/Keyboard.js","models/ioobjects/inputs/Switch.js","models/ioobjects/other/Decoder.js","models/ioobjects/other/Demultiplexer.js","models/ioobjects/other/Encoder.js","models/ioobjects/other/IC.js","models/ioobjects/other/ICData.js","models/ioobjects/other/Label.js","models/ioobjects/other/Multiplexer.js","models/ioobjects/outputs/LED.js","models/ioobjects/outputs/SevenSegmentDisplay.js"],"names":["Exporter","projectNameInput","document","getElementById","ROOT","undefined","saveFile","data","write","getCurrentContext","projectName","value","filename","file","Blob","type","window","navigator","msSaveOrOpenBlob","saved","a","createElement","url","URL","createObjectURL","href","download","body","appendChild","click","setTimeout","removeChild","revokeObjectURL","context","root","DOMParser","parseFromString","objects","getObjects","wires","getWires","projectNode","getChildNode","icNode","createChildNode","writeICs","writeGroup","xml","XMLSerializer","serializeToString","node","objectsNode","wiresNode","i","length","writeTo","ICData","ICs","ic","ICNode","createTextElement","icuid","transform","size","x","y","iportNode","j","iports","oportNode","oports","componentsNode","inputs","concat","components","outputs","getAllWires","parent","tag","child","text","b","createTextNode","Importer","fileInput","types","openFile","open","confirm","reset","reader","FileReader","onload","e","load","result","render","readAsText","files","documentElement","nodeName","project","icsNode","ics","loadICs","group","loadGroup","addObjects","addWires","add","redistributeUIDs","nodes","getChildrenByTagName","getXMLName","push","wiresArr","Wire","loadConnections","icNodes","getIntValue","width","height","create","setSize","V","IPort","OPort","name","childNodes","children","getBooleanValue","def","nodeValue","parseInt","getFloatValue","parseFloat","getStringValue","Input","rawMousePos","Vector","mousePos","prevMousePos","worldMousePos","mouseDown","mouseDownPos","mouseListeners","z","shiftKeyDown","modifierKeyDown","optionKeyDown","isDragging","startTapTime","console","log","onKeyDown","code","keyCode","SHIFT_KEY","CONTROL_KEY","COMMAND_KEY","OPTION_KEY","setCursor","ENTER_KEY","activeElement","blur","Keyboard","getHistoryManager","CurrentTool","onKeyUp","onDoubleClick","onWheel","camera","getCamera","delta","deltaY","factor","getWorldPos","zoomBy","newMousePos","getScreenPos","dx","zoom","dy","translate","popup","onMouseDown","canvas","getRenderer","rect","getBoundingClientRect","Date","now","clientX","left","clientY","top","button","LEFT_MOUSE_BUTTON","shouldRender","contextmenu","hide","listener","disabled","onMouseMove","pos","dPos","sub","onMove","onMouseUp","onClick","addEventListener","registerContext","ctx","PlaceItemController","drag","show","preventDefault","addMouseListener","l","getWorldMousePos","getRawMousePos","getShiftKeyDown","getModifierKeyDown","getOptionKeyDown","getIsDragging","ItemNavController","tab","container","style","ITEMNAV_WIDTH","marginLeft","getTabOffset","borderColor","backgroundColor","fontSize","innerHTML","close","isOpen","toggle","offsetWidth","place","item","not","itemTool","activate","onDragEnd","event","srcElement","parentElement","onclick","SelectionBox","pos1","pos2","getSelections","selections","trans","Transform","Math","abs","obj","t","selectionBoxTransform","transformContains","input","rectContains","getPos","output","somethingHappened","selectionTool","isActive","contains","sContains","oPortContains","iPortContains","wire","getNearestT","deselectAll","select","draw","renderer","p1","p2","w","h","save","globalAlpha","restore","SideNavController","tab2","otherContent","overlay","visibility","SIDENAV_WIDTH","opacity","getWidth","Tool","deactivate","TransformController","pressedObj","isRotating","dragPos","dragObjects","startAngle","prevAngle","realAngles","rotateObjects","startTransforms","shift","newPos","floor","GRID_SIZE","setPos","recalculateMidpoint","rotate","origin","midpoint","dAngle","atan2","newAngle","PI","setRotationAbout","startDrag","selected","copy","startRotation","objs","getAngle","d","len2","ROTATION_CIRCLE_R2","ROTATION_CIRCLE_R1","addAction","createTransformAction","r","ROTATION_CIRCLE_RADIUS","fillStyle","strokeStyle","lineWidth","beginPath","moveTo","da","arc","fill","closePath","WireController","pressedPort","pressedWire","wireSplitPoint","ii","wiringTool","split","action","SplitWireAction","connection","Camera","designer","startPos","startZoom","center","dirty","scale","mat","Matrix2x3","inv","inverse","s","getTransform","updateMatrix","v","getInverseMatrix","mul","getMatrix","Clipboard","cut","paste","things","getAllThingsBetween","clipboardData","setData","RemoveObjects","getData","GroupAction","PlaceAction","clipboard","Context","uidmanager","UIDManager","sender","receiver","signal","propogate","o","addWire","addObject","giveUIDTo","arr","history","cursor","index","getIndexOf","splice","undo","redo","redistribute","CopyArray","getIndexOfWire","getIndexOfObject","uid","findObjectByUID","findWireByUID","find","currentContext","copyGroup","copies","WirePort","wireCopies","connections","k","ww","findIPort","connect","port","lastConnection","isOn","target","HistoryManager","undoStack","redoStack","Y_KEY","Z_KEY","actions","pop","update","PROPOGATION_TIME","updateRequests","Propogation","counter","DEFAULT_SIZE","DEFAULT_FILL_COLOR","DEFAULT_BORDER_COLOR","DEFAULT_ON_COLOR","IO_PORT_LENGTH","IO_PORT_RADIUS","IO_PORT_BORDER_WIDTH","IO_PORT_LINE_WIDTH","WIRE_DIST_THRESHOLD","WIRE_DIST_THRESHOLD2","WIRE_DIST_ITERATIONS","WIRE_NEWTON_ITERATIONS","WIRE_SNAP_THRESHOLD","ROTATION_CIRCLE_THICKNESS","ROTATION_CIRCLE_THRESHOLD","pow","RIGHT_MOUSE_BUTTON","BACKSPACE_KEY","DELETE_KEY","ESC_KEY","A_KEY","C_KEY","V_KEY","X_KEY","tr","bl","p","toLocalSpace","circleContains","A","B","aPos","aSize","getSize","bPos","bSize","r1","getRadius","r2","sr","dpos","dot","getLocalCorners","bworld","getCorners","corners","minA","maxA","minB","maxB","min","max","normals","normal","Infinity","s2","getNearestPointOnRect","clamp","wiresAndPorts","IOObject","allTheThings","iport","findByUID","oport","doAction","deselect","oldinput","oldconnection","remove","DeleteAction","findIC","id","t0","equals","TransformAction","mx","my","findRoots","iterations","f","df","dv","separateGroup","object","Switch","Button","Clock","LED","getBrowser","ua","userAgent","tem","M","match","test","exec","version","appName","appVersion","CircuitDesigner","vw","vh","Renderer","propogationQueue","resize","tempQueue","send","inScene","clear","step","cpos","cpx","cpy","setStyles","_line","stroke","cull","getCullBox","error","ICDesigner","dragObj","dragEdge","confirmButton","cancelButton","out","setContext","getDesigner","hidden","IC","inp","transform1","transform2","v1","normalize","v2","setOrigin","setTarget","setWidth","setHeight","recalculatePorts","images","icdesigner","browser","onbeforeunload","dialogText","returnValue","start","SelectionPopup","ContextMenu","loadImage","onFinishLoading","source","renderQueue","requestAnimationFrame","actualRender","imgs","imageNames","onFinish","img","Image","ratio","src","tintCanvas","getContext","tintContext","innerWidth","innerHeight","clearRect","borderStyle","borderSize","alpha","tint","drawImage","tintImage","fillRect","globalCompositeOperation","txt","textAlign","font","textBaseline","fillText","measureText","x1","y1","x2","y2","lineTo","cx1","cy1","cx2","cy2","bezierCurveTo","cx","cy","quadraticCurveTo","points","isPressable","maxInputs","maxOutputs","selectionBoxWidth","selectionBoxHeight","cullTransform","getDisplayName","setOutputAmount","updatePosition","onTransformChange","setAngle","setScale","getScale","updateCullTransform","c","cos","sin","on","transformCtx","localSpace","getCol","getBorderColor","image","getImageTint","setCamera","rotateAbout","angle","constructor","objNode","getName","setName","IOPort","dir","lineColor","set","getArray","getIndex","prevParentLength","setParent","len","distanceTo","pos0","lineCol","line","circleFillCol","circleBorderCol","circle","n","toLowerCase","replace","ioPortNode","originx","originy","targetx","targety","disconnect","curve","BezierCurve","straight","boundingBox","prevConnection","end1","end2","c1","getODir","getDir","c2","color","getBoundingBox","updateBoundingBox","wireNode","inputNode","connectionNode","bezier","sourceUID","sourceIndx","targetUID","targetIndx","_input","hasSetTransform","snap","BusButtonModule","divName","setVisibility","createBus","maxDist","maxDistIndex","maxMinDistIndex","opos","minDist","minDistIndex","dist","Module","ColorPickerModule","divTextName","allLEDs","allSame","setValue","getValue","focused","onChange","ICButtonModule","count","InputCountModule","display","maxMinValue","minMaxValue","noChange","getInputAmount","getMinInputFieldCount","getMaxInputFieldCount","setPlaceholder","div","setInputAmount","Number","PositionXModule","toFixed","onShow","PositionYModule","TitleModule","clientHeight","Popup","CutModule","CopyModule","PasteModule","SelectAllModule","UndoModule","RedoModule","setDisabled","execCommand","selectAll","ItemTool","SelectionTool","press","release","deselectAction","selectAction","combined","sendToFront","SelectAction","indexOf","br","WiringTool","clickOPort","removeWire","success","PlaceWireAction","Action","flip","reselect","wireport","newwire","t1","setTransform","updatePopup","discriminant1","sqrt","t2","getY","discriminant2","t3","t4","getX","it","getDX","getDY","m","dbx","dby","getDDX","getDDY","tt","getDist","getDistDenominator","getDistDenominatorDerivative","getDist2","getDistNumerator","getDistNumeratorDerivative","bezierNode","other","identity","zero","theta","m11","m12","m21","m22","Array","det","localCorners","dirtySize","dirtyCorners","matrix","mult","radius","toWorldSpace","xx","yy","updateSize","updateCorners","m1","m2","print","invLen","divtext","oninput","onfocus","onFocus","onblur","onBlur","val","placeholder","position","modules","focus","clientWidth","header","Gate","_not","gateNode","inputCount","ANDGate","l1","l2","BUFGate","ORGate","quadCurveXAt","amt","quadCurve","XORGate","SRFlipFlop","clock","frequency","tick","ConstantHigh","ConstantLow","codeMap","num","codeCount","addKey","switchNode","Decoder","Demultiplexer","selectLines","p3","p4","shape","Encoder","indx","setup","getOutputAmount","inputObjects","outputObjects","getHeight","align","padding","getTextWidth","getUID","longestName","targ","orig","separate","Label","Multiplexer","connectorWidth","LEDNode","SevenSegmentDisplay","segmentWidth","segmentHeight","sw","sh","segmentPositions","segmentSizes","segmentImages","segmentOnImages"],"mappings":"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","file":"combined-min.js","sourcesContent":["var Exporter = (function() {    \r\n    var projectNameInput = document.getElementById(\"project-name\");\r\n\r\n    return {\r\n        ROOT: undefined,\r\n        saveFile: function() {\r\n            var data = this.write(getCurrentContext());\r\n            var projectName = projectNameInput.value;\r\n            if (projectName === \"Untitled Circuit*\")\r\n                projectName = \"Untitled Circuit\";\r\n            var filename = projectName + \".circuit\";\r\n\r\n            var file = new Blob([data], {type: \"text/plain\"});\r\n            if (window.navigator.msSaveOrOpenBlob) { // IE10+\r\n                window.navigator.msSaveOrOpenBlob(file, filename);\r\n                saved = true;\r\n            } else { // Others\r\n                var a = document.createElement(\"a\");\r\n                var url = URL.createObjectURL(file);\r\n                a.href = url;\r\n                a.download = filename;\r\n                document.body.appendChild(a);\r\n                a.click();\r\n                setTimeout(function() {\r\n                    document.body.removeChild(a);\r\n                    window.URL.revokeObjectURL(url);\r\n                    saved = true;\r\n                }, 0);\r\n            }\r\n        },\r\n        write: function(context) {\r\n            var root = new window.DOMParser().parseFromString(\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?><project></project>\", \"text/xml\");\r\n            this.ROOT = root;\r\n\r\n            var objects = context.getObjects();\r\n            var wires = context.getWires();\r\n\r\n            var projectNode = getChildNode(root, \"project\");\r\n\r\n            var icNode = createChildNode(projectNode, \"ics\");\r\n\r\n            this.writeICs(icNode);\r\n            this.writeGroup(projectNode, objects, wires);\r\n\r\n            return root.xml ? root.xml : (new XMLSerializer()).serializeToString(root);\r\n        },\r\n        writeGroup: function(node, objects, wires) {\r\n            var objectsNode = createChildNode(node, \"objects\");\r\n            var wiresNode = createChildNode(node, \"wires\");\r\n\r\n            for (var i = 0; i < objects.length; i++)\r\n                objects[i].writeTo(objectsNode);\r\n\r\n            for (var i = 0; i < wires.length; i++)\r\n                wires[i].writeTo(wiresNode);\r\n        },\r\n        writeICs: function(node) {\r\n            for (var i = 0; i < ICData.ICs.length; i++) {\r\n                var ic = ICData.ICs[i];\r\n                var ICNode = createChildNode(node, \"ic\");\r\n                createTextElement(ICNode, \"icuid\", ic.icuid);\r\n                createTextElement(ICNode, \"width\", ic.transform.size.x);\r\n                createTextElement(ICNode, \"height\", ic.transform.size.y);\r\n\r\n                var iportNode = createChildNode(ICNode, \"iports\");\r\n                for (var j = 0; j < ic.iports.length; j++)\r\n                    ic.iports[j].writeTo(iportNode);\r\n\r\n                var oportNode = createChildNode(ICNode, \"oports\");\r\n                for (var j = 0; j < ic.oports.length; j++)\r\n                    ic.oports[j].writeTo(oportNode);\r\n\r\n                var componentsNode = createChildNode(ICNode, \"components\");\r\n                var objects = ic.inputs.concat(ic.components, ic.outputs);\r\n                var wires = getAllWires(objects);\r\n                this.writeGroup(componentsNode, objects, wires);\r\n            }\r\n        }\r\n    };\r\n})();\r\n\r\n// UTILS\r\nfunction createChildNode(parent, tag) {\r\n    var child = Exporter.ROOT.createElement(tag);\r\n    parent.appendChild(child);\r\n    return child;\r\n}\r\n\r\nfunction createTextElement(node, tag, text) {\r\n    var a = Exporter.ROOT.createElement(tag);\r\n    var b = Exporter.ROOT.createTextNode(text);\r\n    a.appendChild(b);\r\n    node.appendChild(a);\r\n}\r\n","var Importer = (function() {   \r\n    var fileInput = document.getElementById('file-input');\r\n     \r\n    return {\r\n        types: [],\r\n        openFile: function() {\r\n            // TODO: Custom popup w/ option to save\r\n            var open = confirm(\"Are you sure you want to overwrite your current scene?\");\r\n\r\n            if (open) {\r\n                reset();\r\n\r\n                var reader = new FileReader();\r\n\r\n                reader.onload = function(e) {\r\n                    Importer.load(reader.result, getCurrentContext());\r\n                    render();\r\n                }\r\n\r\n                reader.readAsText(fileInput.files[0]);\r\n            }\r\n        },\r\n        load: function(text, context) {\r\n            //\r\n            // Why?!?!\r\n            // \r\n            // // Remove all whitespace from XML file except for header\r\n            // var header = text.substring(0, text.indexOf(\">\")+1);\r\n            // text = header + text.substring(text.indexOf(\">\")+1).replace(/\\s/g,'');\r\n\r\n            var root = new window.DOMParser().parseFromString(text, \"text/xml\");\r\n            if (root.documentElement.nodeName == \"parsererror\")\r\n                return;\r\n\r\n            var project = getChildNode(root, \"project\");\r\n            var icsNode = getChildNode(project, \"ics\");\r\n\r\n            var ics = this.loadICs(icsNode, context);\r\n\r\n            var group = this.loadGroup(project, context, ics);\r\n            context.addObjects(group.objects);\r\n            context.addWires(group.wires);\r\n\r\n            for (var i = 0; i < ics.length; i++)\r\n                ICData.add(ics[i]);\r\n\r\n            context.redistributeUIDs();\r\n            ICData.redistributeUIDs();\r\n\r\n            return group;\r\n        },\r\n        loadGroup: function(node, context, ics) {\r\n            var objectsNode = getChildNode(node, \"objects\");\r\n            var wiresNode = getChildNode(node, \"wires\");\r\n\r\n            var objects = [];\r\n            var wires = [];\r\n\r\n            for (var i = 0; i < this.types.length; i++) {\r\n                var type = this.types[i];\r\n                var nodes = getChildrenByTagName(objectsNode, type.getXMLName());\r\n                for (var j = 0; j < nodes.length; j++)\r\n                    objects.push(new type(context).load(nodes[j], ics));\r\n            }\r\n\r\n            var wiresArr = getChildrenByTagName(wiresNode, \"wire\");\r\n            for (var i = 0; i < wiresArr.length; i++)\r\n                wires.push(new Wire(context).load(wiresArr[i]));\r\n\r\n            for (var i = 0; i < wires.length; i++)\r\n                wires[i].loadConnections(wiresArr[i], objects);\r\n\r\n            return {objects:objects, wires:wires};\r\n        },\r\n        loadICs: function(node, context) {\r\n            var ics = [];\r\n            var icNodes = getChildrenByTagName(node, \"ic\");\r\n            for (var i = 0; i < icNodes.length; i++) {\r\n                var icNode = icNodes[i];\r\n                var icuid = getIntValue(getChildNode(icNode, \"icuid\"));\r\n                var width = getIntValue(getChildNode(icNode, \"width\"));\r\n                var height = getIntValue(getChildNode(icNode, \"height\"));\r\n\r\n                var componentsNode = getChildNode(icNode, \"components\");\r\n                var group = this.loadGroup(componentsNode, context, ics);\r\n                var data = ICData.create(group.objects);\r\n\r\n                data.icuid = icuid;\r\n                data.transform.setSize(V(width, height));\r\n\r\n                var iports = getChildrenByTagName(getChildNode(icNode, \"iports\"), \"iport\");\r\n                for (var j = 0; j < iports.length; j++)\r\n                    data.iports[j] = new IPort().load(iports[j]);\r\n\r\n                var oports = getChildrenByTagName(getChildNode(icNode, \"oports\"), \"oport\");\r\n                for (var j = 0; j < oports.length; j++)\r\n                    data.oports[j] = new OPort().load(oports[j]);\r\n\r\n                ics.push(data);\r\n            }\r\n            return ics;\r\n        }\r\n    };\r\n})();\r\n\r\n// UTILS\r\nfunction getChildNode(parent, name) {\r\n    for (var i = 0; i < parent.childNodes.length; i++) {\r\n        if (parent.childNodes[i].nodeName === name)\r\n            return parent.childNodes[i];\r\n    }\r\n    return undefined;\r\n}\r\nfunction getChildrenByTagName(parent, name) {\r\n    var children = [];\r\n    for (var i = 0; i < parent.childNodes.length; i++) {\r\n        if (parent.childNodes[i].nodeName === name)\r\n            children.push(parent.childNodes[i]);\r\n    }\r\n    return children;\r\n}\r\nfunction getBooleanValue(node, def) {\r\n    if (node == undefined)\r\n        return def;\r\n    return node.childNodes[0].nodeValue === \"true\" ? true : false;\r\n}\r\nfunction getIntValue(node, def) {\r\n    if (node == undefined)\r\n        return def;\r\n    return parseInt(node.childNodes[0].nodeValue);\r\n}\r\nfunction getFloatValue(node, def) {\r\n    if (node == undefined)\r\n        return def;\r\n    return parseFloat(node.childNodes[0].nodeValue);\r\n}\r\nfunction getStringValue(node, def) {\r\n    if (node == undefined)\r\n        return def;\r\n    return node.childNodes[0].nodeValue;\r\n}\r\n","var Input = (function () {\r\n    var rawMousePos = new Vector(0, 0);\r\n    var mousePos = new Vector(0,0);\r\n    var prevMousePos = new Vector(0,0);\r\n    var worldMousePos = new Vector(0,0);\r\n\r\n    var mouseDown = false;\r\n    var mouseDownPos = undefined;\r\n    \r\n    var mouseListeners = [];\r\n\r\n    var z = 0;\r\n\r\n    var shiftKeyDown = false;\r\n    var modifierKeyDown = false;\r\n    var optionKeyDown = false;\r\n\r\n    var isDragging = false;\r\n    var startTapTime = undefined;\r\n    \r\n    console.log(shiftKeyDown);\r\n    \r\n    var onKeyDown = function(e) {\r\n        var code = e.keyCode;\r\n        \r\n        console.log(shiftKeyDown);\r\n        \r\n        switch (code) {\r\n            case SHIFT_KEY:\r\n                shiftKeyDown = true;\r\n                break;\r\n            case CONTROL_KEY:\r\n            case COMMAND_KEY:\r\n                modifierKeyDown = true;\r\n                break;\r\n            case OPTION_KEY:\r\n                optionKeyDown = true;\r\n                getCurrentContext().setCursor(\"pointer\");\r\n                break;\r\n            case ENTER_KEY:\r\n                if (document.activeElement !== document.body)\r\n                    document.activeElement.blur();\r\n                break;\r\n        }\r\n\r\n        var objects = getCurrentContext().getObjects();\r\n        for (var i = 0; i < objects.length; i++) {\r\n            if (objects[i] instanceof Keyboard)\r\n                objects[i].onKeyDown(code);\r\n        }\r\n\r\n        getCurrentContext().getHistoryManager().onKeyDown(code);\r\n        if (CurrentTool.onKeyDown(code))\r\n            render();\r\n    }\r\n    var onKeyUp = function(e) {\r\n        var code = e.keyCode;\r\n\r\n        switch (code) {\r\n            case SHIFT_KEY:\r\n                shiftKeyDown = false;\r\n                break;\r\n            case CONTROL_KEY:\r\n            case COMMAND_KEY:\r\n                modifierKeyDown = false;\r\n                break;\r\n            case OPTION_KEY:\r\n                optionKeyDown = false;\r\n                getCurrentContext().setCursor(\"default\");\r\n                break;\r\n        }\r\n\r\n        var objects = getCurrentContext().getObjects();\r\n        for (var i = 0; i < objects.length; i++) {\r\n            if (objects[i] instanceof Keyboard)\r\n                objects[i].onKeyUp(code);\r\n        }\r\n\r\n        if (CurrentTool.onKeyUp(code))\r\n            render();\r\n    }\r\n    var onDoubleClick = function(e) {\r\n    }\r\n    var onWheel = function(e) {\r\n        var camera = getCurrentContext().getCamera();\r\n        var delta = -e.deltaY / 120.0;\r\n\r\n        var factor = 0.95;\r\n        if (delta < 0)\r\n            factor = 1 / factor;\r\n\r\n        var worldMousePos = camera.getWorldPos(mousePos);\r\n        camera.zoomBy(factor);\r\n        var newMousePos = camera.getScreenPos(worldMousePos);\r\n        var dx = (mousePos.x - newMousePos.x) * camera.zoom;\r\n        var dy = (mousePos.y - newMousePos.y) * camera.zoom;\r\n\r\n        camera.translate(-dx, -dy);\r\n\r\n        popup.onWheel();\r\n\r\n        render();\r\n    }\r\n    var onMouseDown = function(e) {\r\n        var canvas = getCurrentContext().getRenderer().canvas;\r\n        var rect = canvas.getBoundingClientRect();\r\n        isDragging = false;\r\n        startTapTime = Date.now();\r\n        mouseDown = true;\r\n        mouseDownPos = new Vector(e.clientX - rect.left, e.clientY - rect.top);\r\n\r\n        if (e.button === LEFT_MOUSE_BUTTON) {\r\n            var shouldRender = false;\r\n            contextmenu.hide();\r\n            shouldRender = CurrentTool.onMouseDown(shouldRender);\r\n            for (var i = 0; i < mouseListeners.length; i++) {\r\n                var listener = mouseListeners[i];\r\n                if (!listener.disabled && listener.onMouseDown(shouldRender))\r\n                    shouldRender = true;\r\n            }\r\n            if (shouldRender)\r\n                render();\r\n        }\r\n    }\r\n    var onMouseMove = function(e) {\r\n        var canvas = getCurrentContext().getRenderer().canvas;\r\n        var camera = getCurrentContext().getCamera();\r\n        var rect = canvas.getBoundingClientRect();\r\n\r\n        prevMousePos.x = mousePos.x;\r\n        prevMousePos.y = mousePos.y;\r\n\r\n        rawMousePos = new Vector(e.clientX, e.clientY);\r\n        mousePos = new Vector(e.clientX - rect.left, e.clientY - rect.top);\r\n        worldMousePos = camera.getWorldPos(mousePos);\r\n\r\n        isDragging = (mouseDown && (Date.now() - startTapTime > 50));\r\n\r\n        var shouldRender = false;\r\n\r\n        if (optionKeyDown && isDragging) {\r\n            var pos = new Vector(mousePos.x, mousePos.y);\r\n            var dPos = mouseDownPos.sub(pos);\r\n            camera.translate(camera.zoom * dPos.x, camera.zoom * dPos.y);\r\n            mouseDownPos = mousePos;\r\n\r\n            popup.onMove();\r\n            shouldRender = true;\r\n        }\r\n\r\n        shouldRender = CurrentTool.onMouseMove(shouldRender) || shouldRender;\r\n        for (var i = 0; i < mouseListeners.length; i++) {\r\n            var listener = mouseListeners[i];\r\n            if (!listener.disabled && listener.onMouseMove(shouldRender))\r\n                shouldRender = true;\r\n        }       \r\n        if (shouldRender)\r\n            render();\r\n    }\r\n    var onMouseUp = function(e) {\r\n        mouseDown = false;\r\n\r\n        var shouldRender = false;\r\n        shouldRender = CurrentTool.onMouseUp(shouldRender);\r\n        for (var i = 0; i < mouseListeners.length; i++) {\r\n            var listener = mouseListeners[i];\r\n            if (!listener.disabled && listener.onMouseUp(shouldRender))\r\n                shouldRender = true;\r\n        }       \r\n        if (shouldRender)\r\n            render();\r\n    }\r\n    var onClick = function(e) {\r\n        var shouldRender = false;\r\n        shouldRender = CurrentTool.onClick(shouldRender);\r\n        for (var i = 0; i < mouseListeners.length; i++) {\r\n            var listener = mouseListeners[i];\r\n            if (!listener.disabled && listener.onClick(shouldRender))\r\n                shouldRender = true;\r\n        }\r\n        if (shouldRender)\r\n            render();\r\n    }\r\n    \r\n    window.addEventListener('keydown', e => {onKeyDown(e);}, false);\r\n    window.addEventListener('keyup', e => {onKeyUp(e);}, false);\r\n    \r\n    return {\r\n        registerContext: function(ctx) {\r\n            var canvas = ctx.getRenderer().canvas;\r\n            canvas.addEventListener('click', e => onClick(e), false);\r\n            canvas.addEventListener('dblclick', e => onDoubleClick(e), false);\r\n            // if (browser.name !== \"Firefox\")\r\n                canvas.addEventListener('wheel', e => onWheel(e), false);\r\n            // else\r\n            //     canvas.addEventListener('DOMMouseScroll', e => onWheel(e), false);\r\n            canvas.addEventListener('mousedown', e => onMouseDown(e), false);\r\n            canvas.addEventListener('mouseup', e => onMouseUp(e), false);\r\n            canvas.addEventListener('mousemove', e => onMouseMove(e), false);\r\n            canvas.addEventListener('mouseenter', e => { if (PlaceItemController.drag) { onMouseMove(e); onClick(e); PlaceItemController.drag = false; }}, false);\r\n            canvas.addEventListener(\"mouseleave\", e => { if (mouseDown) { onMouseUp(e); onClick(e); } });\r\n\r\n            canvas.addEventListener(\"contextmenu\", function(e) {\r\n                contextmenu.show(e);\r\n                e.preventDefault();\r\n            });\r\n        },\r\n        addMouseListener: function(l) {\r\n            mouseListeners.push(l);\r\n        },\r\n        getWorldMousePos() {\r\n            return V(worldMousePos);\r\n        },\r\n        getRawMousePos() {\r\n            return V(rawMousePos);\r\n        },\r\n        getShiftKeyDown() {\r\n            return shiftKeyDown;\r\n        },\r\n        getModifierKeyDown() {\r\n            return modifierKeyDown;\r\n        },\r\n        getOptionKeyDown() {\r\n            return optionKeyDown;\r\n        },\r\n        getIsDragging() {\r\n            return isDragging;\r\n        }\r\n    }\r\n})();","var ItemNavController = (function() {\r\n    var tab = document.getElementById(\"open-items-tab\");\r\n    var container = document.getElementById(\"items\");\r\n\r\n    var open = function() {\r\n        container.style.width       = ITEMNAV_WIDTH + \"px\";\r\n        tab.style.marginLeft        = (ItemNavController.getTabOffset()) + \"px\";\r\n        tab.style.borderColor       = \"rgba(153, 153, 153, 0.0)\";\r\n        tab.style.backgroundColor   = \"rgba(200, 200, 200, 0.0)\";\r\n        tab.style.fontSize          = \"2.5em\";\r\n        tab.innerHTML               = \"&times;\";\r\n    }\r\n    var close = function() {\r\n        container.style.width       = \"0px\";\r\n        tab.style.marginLeft        = (ItemNavController.getTabOffset()) + \"px\";\r\n        tab.style.borderColor       = \"rgba(153, 153, 153, 0.7)\";\r\n        tab.style.backgroundColor   = \"rgba(200, 200, 200, 0.7)\";\r\n        tab.style.fontSize          = \"2em\";\r\n        tab.innerHTML               = \"&#9776;\";\r\n    }\r\n\r\n    return {\r\n        disabled: false,\r\n        isOpen: false,\r\n        toggle: function() {\r\n            if (this.isOpen) {\r\n                this.isOpen = false;\r\n                close();\r\n            } else {\r\n                this.isOpen = true;\r\n                open();\r\n            }\r\n\r\n            // if (popup)\r\n            //     popup.onMove();\r\n        },\r\n        getTabOffset: function() {\r\n            return (this.isOpen ? ITEMNAV_WIDTH - tab.offsetWidth : 0);\r\n        }\r\n    };\r\n})();\r\n// ItemNavController.toggle();\r\n","var PlaceItemController = (function() {\r\n    return {\r\n        disabled: false,\r\n        drag: false,\r\n        place: function(item, not) {\r\n            if (not)\r\n                item.not = not;\r\n            var canvas = getCurrentContext().getRenderer().canvas;\r\n            var rect = canvas.getBoundingClientRect();\r\n            itemTool.activate(item, getCurrentContext());\r\n        },\r\n        onDragEnd: function(event) {\r\n            this.drag = true;\r\n            event.srcElement.parentElement.onclick();\r\n        }\r\n    };\r\n})();\r\n","var SelectionBox = (function () {\r\n    var pos1 = undefined; // First corner\r\n    var pos2 = undefined; // Second corner\r\n    \r\n    var getSelections = function() {\r\n        var objects = getCurrentContext().getObjects();\r\n        var selections = [];\r\n        if (pos1 != undefined) {\r\n            var trans = new Transform(V((pos1.x+pos2.x)/2, (pos1.y+pos2.y)/2), \r\n                                      V(Math.abs(pos2.x-pos1.x), Math.abs(pos2.y-pos1.y)), \r\n                                      0, getCurrentContext().getCamera());\r\n            for (var i = 0; i < objects.length; i++) {\r\n                var obj = objects[i];\r\n                var t = (obj.selectionBoxTransform != undefined ? obj.selectionBoxTransform : obj.transform);\r\n                if (transformContains(t, trans)) {\r\n                    selections.push(obj);\r\n                } else if (obj.inputs != undefined && obj.outputs != undefined) {\r\n                    // Check if an iport or oport is selected\r\n                    for (var j = 0; j < obj.inputs.length; j++) {\r\n                        var input = obj.inputs[j];\r\n                        if (rectContains(trans, input.getPos()))\r\n                            selections.push(input);\r\n                    }\r\n                    for (var j = 0; j < obj.outputs.length; j++) {\r\n                        var output = obj.outputs[j];\r\n                        if (rectContains(trans, output.getPos()))\r\n                            selections.push(output);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return selections;\r\n    }\r\n    \r\n    return {\r\n        disabled: false,\r\n        onMouseDown: function(somethingHappened) {\r\n            var objects = getCurrentContext().getObjects();\r\n            var wires = getCurrentContext().getWires();\r\n            var worldMousePos = Input.getWorldMousePos();\r\n            \r\n            // Make sure nothing but blank canvas was clicked\r\n            if (somethingHappened || !selectionTool.isActive \r\n                || Input.getOptionKeyDown())\r\n                return;\r\n            for (var i = 0; i < objects.length; i++) {\r\n                var obj = objects[i];\r\n                if (obj.contains(worldMousePos) || obj.sContains(worldMousePos) ||\r\n                    obj.oPortContains(worldMousePos) !== -1 || obj.iPortContains(worldMousePos) !== -1)\r\n                    return;\r\n            }\r\n            for (var i = 0; i < wires.length; i++) {\r\n                var wire = wires[i];\r\n                if (wire.getNearestT(worldMousePos.x, worldMousePos.y) !== -1)\r\n                    return;\r\n            }\r\n            \r\n            pos1 = V(worldMousePos);\r\n            popup.hide();\r\n        },\r\n        onMouseMove: function() {\r\n            var objects = getCurrentContext().getObjects();\r\n            var worldMousePos = Input.getWorldMousePos();\r\n\r\n            if (pos1 != undefined) {\r\n                pos2 = V(worldMousePos);\r\n                popup.hide();\r\n                return true;\r\n            }\r\n        },\r\n        onMouseUp: function() {\r\n        },\r\n        onClick: function(somethingHappened) {\r\n            var objects = getCurrentContext().getObjects();\r\n            var worldMousePos = Input.getWorldMousePos();\r\n\r\n            // Stop selection box\r\n            if (pos1 != undefined) {\r\n                pos2 = V(worldMousePos);\r\n                var selections = getSelections();\r\n                if (!Input.getShiftKeyDown())\r\n                    selectionTool.deselectAll(true);\r\n                selectionTool.select(selections, true);\r\n                pos1 = undefined;\r\n                pos2 = undefined;\r\n                return true;\r\n            }\r\n        },\r\n        draw(renderer) {\r\n            var camera = renderer.getCamera();\r\n            if (pos1 != undefined && pos2 != undefined) {\r\n                var p1 = camera.getScreenPos(pos1);\r\n                var p2 = camera.getScreenPos(pos2);\r\n                var w = p2.x - p1.x, h = p2.y - p1.y;\r\n                renderer.save();\r\n                renderer.context.globalAlpha = 0.4;\r\n                renderer.rect(p1.x+w/2, p1.y+h/2, w, h, '#ffffff', '#6666ff', 2 / camera.zoom);\r\n                renderer.restore();\r\n            }\r\n        }\r\n    }\r\n})();\r\n","var SideNavController = (function() {\r\n    var tab = document.getElementById(\"open-sive-nav-button\");\r\n    var tab2 = document.getElementById(\"open-items-tab\");\r\n    var container = document.getElementById(\"sidenav\");\r\n    var otherContent = document.getElementById(\"content\");\r\n    var overlay = document.getElementById(\"overlay\");\r\n    if (overlay) {\r\n        overlay.addEventListener(\"transitionend\", function(event) {\r\n            if (!SideNavController.isOpen)\r\n                overlay.style.visibility = \"hidden\";        \r\n        }, false);\r\n    }\r\n    \r\n    var open = function() {\r\n        container.style.width           = SIDENAV_WIDTH + \"px\";\r\n        otherContent.style.marginLeft   = SIDENAV_WIDTH + \"px\";\r\n        overlay.style.visibility        = \"visible\"; \r\n        overlay.style.opacity           = \"1\"; \r\n        overlay.onclick = function() { SideNavController.toggle(); }\r\n    }\r\n    var close = function() {\r\n        container.style.width           = \"0px\";\r\n        otherContent.style.marginLeft   = \"0px\";\r\n        overlay.style.opacity           = \"0\"; \r\n        overlay.onclick = function() {  }\r\n    }\r\n\r\n    return {\r\n        disabled: false,\r\n        isOpen: false,\r\n        toggle: function() {\r\n            if (this.isOpen) {\r\n                this.isOpen = false;\r\n                close();\r\n            } else {\r\n                this.isOpen = true;\r\n                open();\r\n            }\r\n        },\r\n        getWidth: function() {\r\n            return (this.isOpen ? SIDENAV_WIDTH : 0);\r\n        }\r\n    }\r\n})();\r\n// SideNavController.toggle();\r\n","class Tool {\r\n    constructor() {\r\n        this.isActive = false;\r\n    }\r\n    activate() {\r\n        if (CurrentTool)\r\n            CurrentTool.deactivate();\r\n\r\n        CurrentTool = this;\r\n        this.isActive = true;\r\n        render();\r\n    }\r\n    deactivate() {\r\n        this.isActive = false;\r\n    }\r\n    onKeyDown(code) {\r\n    }\r\n    onKeyUp(code) {\r\n    }\r\n    onMouseDown() {\r\n    }\r\n    onMouseMove() {\r\n    }\r\n    onMouseUp() {\r\n    }\r\n    onClick() {\r\n    }\r\n    draw() {\r\n    }\r\n}\r\nvar CurrentTool;","var TransformController = (function() {\r\n    var pressedObj = undefined;\r\n    \r\n    var isDragging = false;\r\n    var isRotating = false;\r\n    \r\n    var dragPos = V(0,0);\r\n    var dragObjects = [];\r\n    \r\n    var startAngle = 0;\r\n    var prevAngle = 0\r\n    var realAngles = [];\r\n    var rotateObjects = [];\r\n    \r\n    var startTransforms = []; // For undoing\r\n    \r\n    var drag = function(pos, shift) {\r\n        var dPos = V(pos).sub(pressedObj.getPos()).sub(dragPos);\r\n        for (var i = 0; i < dragObjects.length; i++) {\r\n            var obj = dragObjects[i];\r\n            var newPos = obj.getPos().add(dPos);\r\n            if (shift) {\r\n                newPos = V(Math.floor(newPos.x/GRID_SIZE+0.5)*GRID_SIZE,\r\n                           Math.floor(newPos.y/GRID_SIZE+0.5)*GRID_SIZE);\r\n            }\r\n            obj.setPos(newPos);\r\n        }\r\n        selectionTool.recalculateMidpoint();\r\n    }\r\n    var rotate = function(pos, shift) {\r\n        var origin = selectionTool.midpoint;\r\n        var dAngle = Math.atan2(pos.y - origin.y, pos.x - origin.x) - prevAngle;\r\n        for (var i = 0; i < rotateObjects.length; i++) {\r\n            var newAngle = realAngles[i] + dAngle;\r\n            realAngles[i] = newAngle;\r\n            if (shift)\r\n                newAngle = Math.floor(newAngle/(Math.PI/4))*Math.PI/4;\r\n            rotateObjects[i].setRotationAbout(newAngle, origin);\r\n        }\r\n        prevAngle = dAngle + prevAngle;\r\n    }\r\n\r\n    return {\r\n        disabled: false,\r\n        startDrag: function(obj, worldMousePos) {\r\n            if (!obj.selected) {\r\n                selectionTool.deselectAll(true);\r\n                selectionTool.select([obj], true);\r\n            }\r\n            dragObjects = selectionTool.selections;\r\n            \r\n            startTransforms = [];\r\n            for (var i = 0; i < dragObjects.length; i++) {\r\n                if (!dragObjects[i].transform)\r\n                    return true;\r\n                startTransforms[i] = dragObjects[i].transform.copy();\r\n            }\r\n            isDragging = true;\r\n            dragPos = worldMousePos.copy().sub(obj.getPos());\r\n            pressedObj = obj;\r\n            popup.hide();\r\n            return true;\r\n        },\r\n        startRotation(objs, pos) {\r\n            rotateObjects = objs;\r\n            realAngles = [];\r\n            startTransforms = [];\r\n            for (var i = 0; i < rotateObjects.length; i++) {\r\n                if (!rotateObjects[i].transform)\r\n                    return true;\r\n                realAngles[i] = rotateObjects[i].getAngle();\r\n                startTransforms[i] = rotateObjects[i].transform.copy();\r\n            }\r\n            isRotating = true;\r\n            startAngle = Math.atan2(pos.y-selectionTool.midpoint.y, pos.x-selectionTool.midpoint.x);\r\n            prevAngle = startAngle;\r\n            popup.hide();\r\n            return true;\r\n        },\r\n        onMouseDown: function() {\r\n            var objects = getCurrentContext().getObjects();\r\n            var worldMousePos = Input.getWorldMousePos();\r\n\r\n            // Check if rotation circle was pressed\r\n            if (!isRotating && selectionTool.selections.length > 0) {\r\n                var d = worldMousePos.sub(selectionTool.midpoint).len2();\r\n                if (d <= ROTATION_CIRCLE_R2 && d >= ROTATION_CIRCLE_R1) {\r\n                    return this.startRotation(selectionTool.selections, worldMousePos);\r\n                }\r\n            }\r\n            \r\n            // Go through objects backwards since objects on top are in the back\r\n            for (var i = objects.length-1; i >= 0; i--) {\r\n                var obj = objects[i];\r\n\r\n                // Check if object's selection box was pressed\r\n                if (obj.contains(worldMousePos) || obj.sContains(worldMousePos)) {\r\n                    pressedObj = obj;\r\n                    return;\r\n                }\r\n            }\r\n        },\r\n        onMouseMove: function() {\r\n            var objects = getCurrentContext().getObjects();\r\n            var worldMousePos = Input.getWorldMousePos();\r\n            \r\n            // Begin dragging\r\n            if (!isDragging && pressedObj != undefined) {\r\n                return this.startDrag(pressedObj, worldMousePos);\r\n            }\r\n            \r\n            // Actually move the object(s)\r\n            if (isDragging) {\r\n                drag(worldMousePos, Input.getShiftKeyDown());\r\n                return true;\r\n            }\r\n            if (isRotating) {\r\n                rotate(worldMousePos, Input.getShiftKeyDown());\r\n                return true;\r\n            }\r\n        },\r\n        onMouseUp: function() {\r\n            pressedObj = undefined;\r\n\r\n            // Stop dragging\r\n            if (isDragging) {\r\n                // Add transform action\r\n                getCurrentContext().addAction(createTransformAction(dragObjects, startTransforms));\r\n                isDragging = false;\r\n                return true;\r\n            }\r\n\r\n            // Stop rotating\r\n            if (isRotating) {\r\n                // Add transform action\r\n                getCurrentContext().addAction(createTransformAction(rotateObjects, startTransforms));\r\n                isRotating = false;\r\n                return true;\r\n            }\r\n        },\r\n        onClick: function() {\r\n        },\r\n        draw: function(renderer) {\r\n            // Draw rotation circle\r\n            var camera = renderer.getCamera();\r\n            var pos = camera.getScreenPos(selectionTool.midpoint);\r\n            var r = ROTATION_CIRCLE_RADIUS / camera.zoom;\r\n            if (isRotating) {\r\n                renderer.save();\r\n                renderer.context.fillStyle = '#fff';\r\n                renderer.context.strokeStyle = '#000'\r\n                renderer.context.lineWidth = 5;\r\n                renderer.context.globalAlpha = 0.4;\r\n                renderer.context.beginPath();\r\n                renderer.context.moveTo(pos.x, pos.y);\r\n                var da = (prevAngle - startAngle) % (2*Math.PI);\r\n                if (da < 0) da += 2*Math.PI;\r\n                renderer.context.arc(pos.x, pos.y, r, startAngle, prevAngle, da > Math.PI);\r\n                renderer.context.fill();\r\n                renderer.context.closePath();\r\n                renderer.restore();\r\n            }\r\n        }\r\n    };\r\n})();\r\n","var WireController = (function() {\r\n    var pressedPort = undefined;\r\n    \r\n    var pressedWire = undefined;\r\n    var wireSplitPoint = -1;\r\n\r\n    return {\r\n        disabled: false,\r\n        onMouseDown: function(somethingHappened) {\r\n            var objects = getCurrentContext().getObjects();\r\n            var wires = getCurrentContext().getWires();\r\n            var worldMousePos = Input.getWorldMousePos();\r\n                        \r\n            // Make sure nothing else has happened\r\n            if (somethingHappened)\r\n                return;\r\n            \r\n            // Check if a IOPort was clicked to start creating new wire\r\n            for (var i = objects.length-1; i >= 0; i--) {\r\n                var obj = objects[i];\r\n\r\n                // Check if port was clicked, then activate wire tool\r\n                var ii;\r\n                if ((ii = obj.oPortContains(worldMousePos)) !== -1) {\r\n                    pressedPort = obj.outputs[ii];\r\n                    return;\r\n                }\r\n                if ((ii = obj.iPortContains(worldMousePos)) !== -1) {\r\n                    pressedPort = obj.inputs[ii];\r\n                    return;\r\n                }\r\n            }\r\n            \r\n            // Check if a wire was pressed\r\n            for (var i = 0; i < wires.length; i++) {\r\n                var wire = wires[i];\r\n                var t;\r\n                if ((t = wire.getNearestT(worldMousePos.x, worldMousePos.y)) !== -1) {\r\n                    pressedWire = wire;\r\n                    wireSplitPoint = t;\r\n                    return true;\r\n                }\r\n            }\r\n        },\r\n        onMouseMove: function(somethingHappened) {\r\n            var worldMousePos = Input.getWorldMousePos();\r\n            \r\n            // Make sure nothing else has happened\r\n            if (somethingHappened)\r\n                return;\r\n                \r\n            // Begin dragging new wire\r\n            if (pressedPort != undefined) {\r\n                wiringTool.activate(pressedPort, getCurrentContext());\r\n                pressedPort = undefined;\r\n                return true;\r\n            }\r\n            \r\n            // Begin splitting wire\r\n            if (pressedWire != undefined) {\r\n                pressedWire.split(wireSplitPoint);\r\n                var action = new SplitWireAction(pressedWire);\r\n                getCurrentContext().addAction(action);\r\n                selectionTool.deselectAll(true);\r\n                selectionTool.select([pressedWire.connection], true);\r\n                TransformController.startDrag(pressedWire.connection, worldMousePos);\r\n                pressedWire = undefined;\r\n                return true;\r\n            }\r\n        },\r\n        onMouseUp: function() {   \r\n        },\r\n        onClick: function(somethingHappened) {\r\n            // Make sure nothing else has happened\r\n            if (somethingHappened) {\r\n                pressedPort = undefined;\r\n                pressedWire = undefined;\r\n                return;\r\n            }\r\n\r\n            // Clicking also begins dragging\r\n            if (pressedPort != undefined) {\r\n                wiringTool.activate(pressedPort, getCurrentContext());\r\n                pressedPort = undefined;\r\n                return true;\r\n            }\r\n\r\n            // Select wire\r\n            if (pressedWire != undefined) {\r\n                if (!Input.getShiftKeyDown())\r\n                    selectionTool.deselectAll(true);\r\n                selectionTool.select([pressedWire], true);\r\n                pressedWire = undefined;\r\n                return true;\r\n            }\r\n        }\r\n    };\r\n})();\r\n","class Camera {\r\n    constructor(designer, startPos, startZoom) {\r\n        this.canvas = designer.renderer.canvas;\r\n        this.pos = (startPos ? startPos : V(0, 0));\r\n        this.zoom = (startZoom ? startZoom : 1);\r\n        this.center = V(0,0);\r\n        this.transform = new Transform(V(0,0), V(0,0), 0, this);\r\n        this.dirty = true;\r\n    }\r\n    resize() {\r\n        this.center = V(this.canvas.width, this.canvas.height).scale(0.5);\r\n    }\r\n    updateMatrix() {\r\n        if (!this.dirty)\r\n            return;\r\n        this.dirty = false;\r\n\r\n        this.mat = new Matrix2x3();\r\n        this.mat.translate(this.pos);\r\n        this.mat.scale(V(this.zoom, this.zoom));\r\n        this.inv = this.mat.inverse();\r\n\r\n        var p1 = this.getWorldPos(V(0, 0));\r\n        var p2 = this.getWorldPos(V(this.canvas.width, this.canvas.height));\r\n        this.transform.setPos(p2.add(p1).scale(0.5));\r\n        this.transform.setSize(p2.sub(p1));\r\n    }\r\n    translate(dx, dy) {\r\n        this.dirty = true;\r\n        this.pos.x += dx;\r\n        this.pos.y += dy;\r\n    }\r\n    zoomBy(s) {\r\n        this.dirty = true;\r\n        this.zoom *= s;\r\n    }\r\n    cull(transform) {\r\n        // getCurrentContext().getRenderer().save();\r\n        // transform.transformCtx(getCurrentContext().getRenderer().context);\r\n        // getCurrentContext().getRenderer().rect(0, 0, transform.size.x, transform.size.y, '#ff00ff');\r\n        // getCurrentContext().getRenderer().restore();\r\n\r\n        return (transformContains(transform, this.getTransform()));\r\n    }\r\n    getTransform() {\r\n        this.updateMatrix();\r\n        return this.transform;\r\n    }\r\n    getMatrix() {\r\n        this.updateMatrix();\r\n        return this.mat;\r\n    }\r\n    getInverseMatrix() {\r\n        this.updateMatrix();\r\n        return this.inv;\r\n    }\r\n    getScreenPos(v) {\r\n        return this.getInverseMatrix().mul(v).add(this.center);\r\n    }\r\n    getWorldPos(v) {\r\n        return this.getMatrix().mul(v.sub(this.center));\r\n    }\r\n}\r\n","class Clipboard {\r\n    constructor() {\r\n        document.addEventListener('copy', e => {this.copy(e)}, false);\r\n        document.addEventListener('cut', e => {this.cut(e)}, false);\r\n        document.addEventListener('paste', e => {this.paste(e)}, false);\r\n    }\r\n    copy(e) {\r\n        var selections = selectionTool.selections;\r\n        var things = getAllThingsBetween(selections);\r\n        var objects = [];\r\n        var wires = [];\r\n        for (var i = 0; i < things.length; i++) {\r\n            if (things[i] instanceof Wire)\r\n                wires.push(things[i]);\r\n            else\r\n                objects.push(things[i]);\r\n        }\r\n        var ctx = {getObjects: function() {return objects;}, getWires: function() {return wires;}};\r\n        var data = Exporter.write(ctx);\r\n        e.clipboardData.setData(\"text/plain\", data);\r\n        e.preventDefault();\r\n    }\r\n    cut(e) {\r\n        this.copy(e);\r\n        RemoveObjects(getCurrentContext(), selectionTool.selections, true);\r\n        e.preventDefault();\r\n    }\r\n    paste(e) {\r\n        console.log(\"ASd\");\r\n        var group = Importer.load(e.clipboardData.getData(\"text/plain\"), getCurrentContext());\r\n        var objects = group.objects;\r\n        var wires = group.wires;\r\n\r\n        var action = new GroupAction();\r\n\r\n        for (var i = 0; i < objects.length; i++) {\r\n            objects[i].setPos(objects[i].getPos().add(V(5, 5)));\r\n            action.add(new PlaceAction(objects[i]));\r\n        }\r\n\r\n        getCurrentContext().addAction(action);\r\n\r\n        selectionTool.deselectAll();\r\n        selectionTool.select(objects);\r\n\r\n        render();\r\n        e.preventDefault();\r\n    }\r\n}\r\nvar clipboard = new Clipboard();","class Context {\r\n    constructor(designer) {\r\n        this.uidmanager = new UIDManager(this);\r\n        this.designer = designer;\r\n    }\r\n    reset() {\r\n        this.designer.reset();\r\n    }\r\n    render() {\r\n        this.designer.render();\r\n    }\r\n    propogate(sender, receiver, signal) {\r\n        this.designer.propogate(sender, receiver, signal);\r\n    }\r\n    add(o) {\r\n        if (o instanceof Wire)\r\n            this.addWire(o);\r\n        else\r\n            this.addObject(o);\r\n    }\r\n    addObject(o) {\r\n        this.designer.addObject(o);\r\n        this.uidmanager.giveUIDTo(o);\r\n    }\r\n    addObjects(arr) {\r\n        for (var i = 0; i < arr.length; i++)\r\n            this.addObject(arr[i]);\r\n    }\r\n    addWire(w) {\r\n        this.designer.addWire(w);\r\n        this.uidmanager.giveUIDTo(w);\r\n    }\r\n    addWires(arr) {\r\n        for (var i = 0; i < arr.length; i++)\r\n            this.addWire(arr[i]);\r\n    }\r\n    addAction(action) {\r\n        this.designer.history.add(action);\r\n    }\r\n    setCursor(cursor) {\r\n        this.designer.renderer.setCursor(cursor);\r\n    }\r\n    remove(o) {\r\n        var index = this.getIndexOf(o);\r\n        if (index === -1)\r\n            return;\r\n        if (o instanceof Wire)\r\n            this.designer.getWires().splice(index, 1);\r\n        else\r\n            this.designer.getObjects().splice(index, 1);\r\n    }\r\n    undo() {\r\n        this.designer.history.undo();\r\n    }\r\n    redo() {\r\n        this.designer.history.redo();\r\n    }\r\n    redistributeUIDs() {\r\n        this.uidmanager.redistribute();\r\n    }\r\n    getDesigner() {\r\n        return this.designer;\r\n    }\r\n    getRenderer() {\r\n        return this.designer.renderer;\r\n    }\r\n    getCamera() {\r\n        return this.designer.camera;\r\n    }\r\n    getHistoryManager() {\r\n        return this.designer.history;\r\n    }\r\n    getObjects() {\r\n        // Copy to avoid confusing bugs when\r\n        // modifying the objects through add/remove\r\n        // and have it edit the returned array\r\n        return CopyArray(this.designer.objects);\r\n    }\r\n    getWires() {\r\n        // Copy to avoid confusing bugs when\r\n        // modifying the objects through add/remove\r\n        // and have it edit the returned array\r\n        return CopyArray(this.designer.wires);\r\n    }\r\n    getIndexOf(o) {\r\n        if (o instanceof Wire)\r\n            return this.designer.getIndexOfWire(o);\r\n        else\r\n            return this.designer.getIndexOfObject(o);\r\n    }\r\n    findByUID(uid) {\r\n        return findObjectByUID(uid) || findWireByUID(uid);\r\n    }\r\n    findObjectByUID(uid) {\r\n        return UIDManager.find(this.getObjects(), uid);\r\n    }\r\n    findWireByUID(uid) {\r\n        return UIDManager.find(this.getWires(), uid);\r\n    }\r\n}\r\n\r\nfunction getCurrentContext() {\r\n    return currentContext;\r\n}\r\n","function copyGroup(objects) {\r\n    if (objects.length === 0)\r\n        return [];\r\n\r\n    var copies = [];\r\n    for (var i = 0; i < objects.length; i++) {\r\n        if (objects[i] instanceof WirePort)\r\n            objects.splice(i--, 1);\r\n        else\r\n            copies[i] = objects[i].copy();\r\n    }\r\n\r\n    // Copy and reconnect all wires\r\n    var wireCopies = [];\r\n    for (var i = 0; i < objects.length; i++) {\r\n        var obj = objects[i];\r\n        for (var j = 0; j < obj.outputs.length; j++) {\r\n            var wires = obj.outputs[j].connections;\r\n            for (var k = 0; k < wires.length; k++) {\r\n                // See if connection was also copied\r\n                var ww = wires[k];\r\n                while (ww instanceof Wire || ww instanceof WirePort)\r\n                    ww = ww.connection;\r\n                if (findIPort(objects, ww, copies) == undefined)\r\n                    break;\r\n\r\n                var wire = wires[k].copy();\r\n                copies[i].outputs[j].connect(wire);\r\n                var w = wires[k];\r\n                // Iterate through all wires connected to other wires\r\n                while(w.connection instanceof WirePort) {\r\n                    var port = new WirePort(obj.context);\r\n                    wire.connect(port);\r\n                    wireCopies.push(wire);\r\n                    w = w.connection.connection;\r\n                    wire = w.copy();\r\n                    port.connect(wire);\r\n                    copies.push(port);\r\n                }\r\n                var lastConnection = findIPort(objects, w.connection, copies);\r\n                wire.connect(lastConnection);\r\n                wireCopies.push(wire);\r\n            }\r\n        }\r\n    }\r\n    for (var i = 0; i < objects.length; i++) {\r\n        copies[i].isOn = objects[i].isOn;\r\n        if (objects[i].inputs.length === 0)\r\n            copies[i].activate(objects[i].isOn);\r\n    }\r\n    for (var i = 0; i < wireCopies.length; i++) {\r\n        if (objects[i].inputs.length === 0)\r\n            copies[i].activate(objects[i].isOn);\r\n    }\r\n\r\n    return {objects:copies, wires:wireCopies};\r\n}\r\n\r\nfunction findIPort(objects, target, copies) {\r\n    for (var i = 0; i < objects.length; i++) {\r\n        var iports = objects[i].inputs;\r\n        for (var j = 0; j < iports.length; j++) {\r\n            if (iports[j] === target)\r\n                return copies[i].inputs[j];\r\n        }\r\n    }\r\n    return undefined;\r\n}\r\n","class HistoryManager {\r\n    constructor() {\r\n        this.undoStack = [];\r\n        this.redoStack = [];\r\n    }\r\n    onKeyDown(code, input) {\r\n        if (Input.getModifierKeyDown()) {\r\n            if (code === Y_KEY || (code === Z_KEY && Input.getShiftKeyDown()))\r\n                this.redo();\r\n            else if (code === Z_KEY)\r\n                this.undo();\r\n        }\r\n    }\r\n    add(action) {\r\n        // Check for empty group action\r\n        if (action instanceof GroupAction &&\r\n            action.actions.length == 0) {\r\n                return;\r\n        }\r\n        \r\n        this.redoStack = [];\r\n        this.undoStack.push(action);\r\n    }\r\n    undo() {\r\n        if (this.undoStack.length > 0) {\r\n            var action = this.undoStack.pop();\r\n            action.undo();\r\n            this.redoStack.push(action);\r\n            // Update popup's values\r\n            popup.update();\r\n            render();\r\n        }\r\n    }\r\n    redo() {\r\n        if (this.redoStack.length > 0) {\r\n            var action = this.redoStack.pop();\r\n            action.redo();\r\n            this.undoStack.push(action);\r\n            // Update popup's values\r\n            popup.update();\r\n            render();\r\n        }\r\n    }\r\n}\r\n","/* Should be const instead of var\r\n   but Safari does not allow it */\r\nvar PROPOGATION_TIME = 1;\r\n\r\nvar updateRequests = 0;\r\n\r\nclass Propogation {\r\n    constructor(sender, receiver, signal, update) {\r\n        this.sender = sender;\r\n        this.receiver = receiver;\r\n        this.signal = signal;\r\n\r\n        if (updateRequests === 0) {\r\n            updateRequests++;\r\n            setTimeout(update, PROPOGATION_TIME);\r\n        }\r\n    }\r\n    send() {\r\n        this.receiver.activate(this.signal);\r\n    }\r\n}\r\n","class UIDManager {\r\n    constructor(context) {\r\n        this.context = context;\r\n        this.counter = 0;\r\n    }\r\n    giveUIDTo(obj) {\r\n        if (!obj.uid)\r\n            obj.uid = (this.counter++);\r\n    }\r\n    redistribute() {\r\n        var things = this.context.getObjects().concat(this.context.getWires());\r\n        this.counter = 0;\r\n        for (var i = 0; i < things.length; i++)\r\n            things[i].uid = (this.counter++);\r\n    }\r\n}\r\n\r\n/**\r\n * Finds and returns the thing in the given\r\n * array that has the given uid (Unique Identification)\r\n *\r\n * @param  {Array} things\r\n *         The group of things to search\r\n *\r\n * @param  {Integer} uid\r\n *         The target unique identification to search for\r\n *\r\n * @return {IOObject}\r\n *         The object with the given uid or undefined if\r\n *         the object is not found\r\n */\r\nUIDManager.find = function(things, target) {\r\n    for (var i = 0; i < things.length; i++) {\r\n        if (things[i].uid === target)\r\n            return things[i];\r\n    }\r\n    return undefined;\r\n}\r\n","\r\n/* Should be const instead of var\r\n   but Safari does not allow it */\r\nvar DEFAULT_SIZE = 50;\r\nvar GRID_SIZE = 50;\r\nvar DEFAULT_FILL_COLOR = \"#ffffff\";\r\nvar DEFAULT_BORDER_COLOR = \"#000000\";\r\nvar DEFAULT_ON_COLOR = \"#3cacf2\";\r\n\r\nvar IO_PORT_LENGTH = 60;\r\nvar IO_PORT_RADIUS = 7;\r\nvar IO_PORT_BORDER_WIDTH = 1;\r\nvar IO_PORT_LINE_WIDTH = 2;\r\n\r\nvar WIRE_DIST_THRESHOLD = 5;\r\nvar WIRE_DIST_THRESHOLD2 = WIRE_DIST_THRESHOLD*WIRE_DIST_THRESHOLD;\r\nvar WIRE_DIST_ITERATIONS = 10;\r\nvar WIRE_NEWTON_ITERATIONS = 5;\r\nvar WIRE_SNAP_THRESHOLD = 10;\r\n\r\nvar ROTATION_CIRCLE_RADIUS = 75;\r\nvar ROTATION_CIRCLE_THICKNESS = 5;\r\nvar ROTATION_CIRCLE_THRESHOLD = 5;\r\nvar ROTATION_CIRCLE_R1 = Math.pow(ROTATION_CIRCLE_RADIUS - ROTATION_CIRCLE_THRESHOLD, 2);\r\nvar ROTATION_CIRCLE_R2 = Math.pow(ROTATION_CIRCLE_RADIUS + ROTATION_CIRCLE_THRESHOLD, 2);\r\n\r\nvar SIDENAV_WIDTH = 200;\r\nvar ITEMNAV_WIDTH = 200;\r\n\r\nvar LEFT_MOUSE_BUTTON = 0;\r\nvar RIGHT_MOUSE_BUTTON = 1;\r\n\r\nvar OPTION_KEY = 18;\r\nvar SHIFT_KEY = 16;\r\nvar BACKSPACE_KEY = 8;\r\nvar DELETE_KEY = 46;\r\nvar ENTER_KEY = 13;\r\nvar ESC_KEY = 27;\r\nvar A_KEY = 65;\r\nvar C_KEY = 67;\r\nvar V_KEY = 86;\r\nvar X_KEY = 88;\r\nvar Y_KEY = 89;\r\nvar Z_KEY = 90;\r\nvar CONTROL_KEY = 17;\r\nvar COMMAND_KEY = 91;\r\n\r\n/**\r\n * Determines whether the given point is\r\n * within the rectangle defined by the\r\n * given transform\r\n *\r\n * @param  {Transform} transform\r\n *         The transform that represents the rectangle\r\n *\r\n * @param  {Vector} pos\r\n *         * Must be in world coordinates *\r\n *         The point to determine whether or not\r\n *         it's within the rectangle\r\n *\r\n * @return {Boolean}\r\n *         True if the point is within the rectangle,\r\n *         false otherwise\r\n */\r\nfunction rectContains(transform, pos) {\r\n    var tr = transform.size.scale(0.5);\r\n    var bl = transform.size.scale(-0.5);\r\n    var p  = transform.toLocalSpace(pos);\r\n\r\n    return (p.x > bl.x &&\r\n            p.y > bl.y &&\r\n            p.x < tr.x &&\r\n            p.y < tr.y);\r\n}\r\n\r\n/**\r\n * Determines whether the given point\r\n * is within the circle defined by the\r\n * given transform\r\n *\r\n * @param  {Transform} transform\r\n *         The transform that represents the circle\r\n *\r\n * @param  {Vector} pos\r\n *         * Must be in world coordinates *\r\n *         The point to determine whether or not\r\n *         it's within the rectangle\r\n *\r\n * @return {Boolean}\r\n *          True if the point is within the rectangle,\r\n *          false otherwise\r\n */\r\nfunction circleContains(transform, pos) {\r\n    var v = transform.toLocalSpace(pos);\r\n    return (v.len2() <= transform.size.x*transform.size.x/4);\r\n}\r\n\r\n/**\r\n * Compares two transforms to see if they overlap.\r\n * First tests it using a quick circle-circle\r\n * intersection using the 'radius' of the transform\r\n *\r\n * Then uses a SAT (Separating Axis Theorem) method\r\n * to determine whether or not the two transforms\r\n * are intersecting\r\n *\r\n * @param  {Transform} a\r\n *         The first transform\r\n *\r\n * @param  {Transform} b\r\n *         The second transform\r\n *\r\n * @return {Boolean}\r\n *         True if the two transforms are overlapping,\r\n *         false otherwise\r\n */\r\nfunction transformContains(A, B) {\r\n    // If both transforms are non-rotated\r\n    if (Math.abs(A.getAngle()) <= 1e-5 && Math.abs(B.getAngle()) <= 1e-5) {\r\n        var aPos = A.getPos(), aSize = A.getSize();\r\n        var bPos = B.getPos(), bSize = B.getSize();\r\n        return (Math.abs(aPos.x - bPos.x) * 2 < (aSize.x + bSize.x)) &&\r\n               (Math.abs(aPos.y - bPos.y) * 2 < (aSize.y + bSize.y));\r\n    }\r\n\r\n    // Quick check circle-circle intersection\r\n    var r1 = A.getRadius();\r\n    var r2 = B.getRadius();\r\n    var sr = r1 + r2;                       // Sum of radius\r\n    var dpos = A.getPos().sub(B.getPos());  // Delta position\r\n    if (dpos.dot(dpos) > sr*sr)\r\n        return false;\r\n\r\n    /* Perform SAT */\r\n\r\n    // Get corners in local space of transform A\r\n    var a = A.getLocalCorners();\r\n\r\n    // Transform B's corners into A local space\r\n    var bworld = B.getCorners();\r\n    var b = [];\r\n    for (var i = 0; i < 4; i++) {\r\n        b[i] = A.toLocalSpace(bworld[i]);\r\n\r\n        // Offsets x and y to fix perfect lines\r\n        // where b[0] = b[1] & b[2] = b[3]\r\n        b[i].x += 0.0001*i;\r\n        b[i].y += 0.0001*i;\r\n    }\r\n\r\n    var corners = a.concat(b);\r\n\r\n    var minA, maxA, minB, maxB;\r\n\r\n    // SAT w/ x-axis\r\n    // Axis is <1, 0>\r\n    // So dot product is just the x-value\r\n    minA = maxA = corners[0].x;\r\n    minB = maxB = corners[4].x;\r\n    for (var j = 1; j < 4; j++) {\r\n        minA = Math.min(corners[j].x, minA);\r\n        maxA = Math.max(corners[j].x, maxA);\r\n        minB = Math.min(corners[j+4].x, minB);\r\n        maxB = Math.max(corners[j+4].x, maxB);\r\n    }\r\n    if (maxA < minB || maxB < minA)\r\n        return false;\r\n\r\n    // SAT w/ y-axis\r\n    // Axis is <1, 0>\r\n    // So dot product is just the y-value\r\n    minA = maxA = corners[0].y;\r\n    minB = maxB = corners[4].y;\r\n    for (var j = 1; j < 4; j++) {\r\n        minA = Math.min(corners[j].y, minA);\r\n        maxA = Math.max(corners[j].y, maxA);\r\n        minB = Math.min(corners[j+4].y, minB);\r\n        maxB = Math.max(corners[j+4].y, maxB);\r\n    }\r\n    if (maxA < minB || maxB < minA)\r\n        return false;\r\n\r\n    // SAT w/ other two axes\r\n    var normals = [b[3].sub(b[0]), b[3].sub(b[2])];\r\n    for (var i = 0; i < normals.length; i++) {\r\n        var normal = normals[i];\r\n        var minA = undefined, maxA = undefined;\r\n        var minB = undefined, maxB = undefined;\r\n        for (var j = 0; j < 4; j++) {\r\n            var s = corners[j].dot(normal);\r\n            minA = Math.min(s, (minA ? minA :  Infinity));\r\n            maxA = Math.max(s, (maxA ? maxA : -Infinity));\r\n            var s2 = corners[j+4].dot(normal);\r\n            minB = Math.min(s2, (minB ? minB :  Infinity));\r\n            maxB = Math.max(s2, (maxB ? maxB : -Infinity));\r\n        }\r\n        if (maxA < minB || maxB < minA)\r\n            return false;\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n/**\r\n * Returns the nearest point on the edge\r\n * of the given rectangle.\r\n *\r\n * @param  {Vector} bl\r\n *         Bottom left corner of the rectangle\r\n *\r\n * @param  {Vector} tr\r\n *         Top right corner of the rectangle\r\n *\r\n * @param  {Vector} pos\r\n *         The position to get the nearest point on\r\n *\r\n * @return {Vector}\r\n *         The closest position on the edge of\r\n *         the rectangle from 'pos'\r\n */\r\nfunction getNearestPointOnRect(bl, tr, pos) {\r\n    if (pos.x < bl.x)\r\n        return V(bl.x, clamp(pos.y, bl.y, tr.y));\r\n    if (pos.x > tr.x)\r\n        return V(tr.x, clamp(pos.y, bl.y, tr.y));\r\n    if (pos.y < bl.y)\r\n        return V(clamp(pos.x, bl.x, tr.x), bl.y);\r\n    if (pos.y > tr.y)\r\n        return V(clamp(pos.x, bl.x, tr.x), tr.y);\r\n    return V(0, 0);\r\n}\r\n\r\n// Okay, I know this is awful but it's like 5:47 am and I'm tired\r\nfunction getAllThingsBetween(things) {\r\n    var objects = [];\r\n    var wiresAndPorts = [];\r\n    for (var i = 0; i < things.length; i++) {\r\n        if (things[i] instanceof Wire || things[i] instanceof WirePort)\r\n            wiresAndPorts.push(things[i]);\r\n        else if (things[i] instanceof IOObject)\r\n            objects.push(things[i]);\r\n    }\r\n    var allTheThings = [];\r\n    for (var i = 0; i < objects.length; i++) {\r\n        allTheThings.push(objects[i]);\r\n        for (var j = 0; j < objects[i].inputs.length; j++) {\r\n            var iport = objects[i].inputs[j];\r\n            obj = iport.input;\r\n            while (obj != undefined && !(obj instanceof OPort)) {\r\n                if (findByUID(allTheThings, obj.uid) == undefined) // If not added yet\r\n                    allTheThings.push(obj);\r\n                obj = obj.input;\r\n            }\r\n        }\r\n        for (var j = 0; j < objects[i].outputs.length; j++) {\r\n            var oport = objects[i].outputs[j];\r\n            for (var k = 0; k < oport.connections.length; k++) {\r\n                obj = oport.connections[k];\r\n                while (obj != undefined && !(obj instanceof IPort)) {\r\n                    if (findByUID(allTheThings, obj.uid) == undefined) // If not added yet\r\n                        allTheThings.push(obj);\r\n                    obj = obj.connection;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    for (var i = 0; i < wiresAndPorts.length; i++) {\r\n        allTheThings.push(wiresAndPorts[i]);\r\n        var obj = wiresAndPorts[i].input;\r\n        while (obj != undefined && !(obj instanceof OPort)) {\r\n            if (findByUID(allTheThings, obj.uid) == undefined) // If not added yet\r\n                allTheThings.push(obj);\r\n            obj = obj.input;\r\n        }\r\n        obj = wiresAndPorts[i].connection;\r\n        while (obj != undefined && !(obj instanceof IPort)) {\r\n            if (findByUID(allTheThings, obj.uid) == undefined) // If not added yet\r\n                allTheThings.push(obj);\r\n            obj = obj.connection;\r\n        }\r\n    }\r\n    return allTheThings;\r\n}\r\n\r\n/**\r\n * Finds and returns all the inter-connected wires\r\n * in a given group of objects\r\n *\r\n * @param  {Array} objects\r\n *         The group of objects to find the wires\r\n *         in between\r\n *\r\n * @return {Array}\r\n *         The resulting wires\r\n */\r\nfunction getAllWires(objects) {\r\n    var wires = [];\r\n    for (var i = 0; i < objects.length; i++) {\r\n        var obj = objects[i];\r\n        for (var j = 0; j < obj.outputs.length; j++) {\r\n            var connections = obj.outputs[j].connections;\r\n            for (var k = 0; k < connections.length; k++) {\r\n                var wire = connections[k];\r\n                while (wire.connection instanceof WirePort) {\r\n                    wires.push(wire);\r\n                    wire = wire.connection.connection;\r\n                }\r\n                wires.push(wire);\r\n            }\r\n        }\r\n    }\r\n    return wires;\r\n}\r\n\r\n/**\r\n * Removes all objects and wires+wireports\r\n * between them\r\n *\r\n * @param  {Context} ctx\r\n *         The context which the objects are apart of\r\n *\r\n * @param  {Array} objects\r\n *         The array of objects in which to remove\r\n *\r\n * @param  {Boolean} doAction\r\n *         True if the action should be re/undoable,\r\n *         False otherwise\r\n */\r\nfunction RemoveObjects(ctx, objects, doAction) {\r\n    if (objects.length === 0)\r\n        return;\r\n\r\n    var action = new GroupAction();\r\n    var things = getAllThingsBetween(objects);\r\n    for (var i = 0; i < things.length; i++) {\r\n        if (things[i].selected)\r\n            selectionTool.deselect([things[i]]);\r\n        if (things[i] instanceof Wire || things[i] instanceof WirePort) {\r\n            var oldinput = things[i].input;\r\n            var oldconnection = things[i].connection;\r\n            things[i].remove();\r\n            if (doAction)\r\n                action.add(new DeleteAction(things[i], oldinput, oldconnection));\r\n        }\r\n    }\r\n    for (var i = 0; i < things.length; i++) {\r\n        if (!(things[i] instanceof Wire || things[i] instanceof WirePort)) {\r\n            things[i].remove();\r\n            if (doAction)\r\n                action.add(new DeleteAction(things[i]));\r\n        }\r\n    }\r\n    if (doAction)\r\n        ctx.addAction(action);\r\n    render();\r\n}\r\n\r\n/**\r\n * Simply copies all elements of an array into\r\n * another array and returns that array\r\n * [DOES NOT COPY EACH OBJECT IN THE ARRAY]\r\n *\r\n * @param  {Array} arr\r\n *         The array to copy\r\n *\r\n * @return {Array}\r\n *         The copied array\r\n */\r\nfunction CopyArray(arr) {\r\n    var copy = [];\r\n    for (var i = 0; i < arr.length; i++)\r\n        copy.push(arr[i]);\r\n    return copy;\r\n}\r\n\r\n/**\r\n * Finds and returns the IC from a given icuid\r\n *\r\n * @param  {Integer} id\r\n *         The icuid of the target IC\r\n *         (Integrated Circuit Unique Identification)\r\n *\r\n * @return {IC}\r\n *         The ic with the given icuid or undefined if\r\n *         the IC is not found\r\n */\r\nfunction findIC(id, ics) {\r\n    for (var i = 0; i < ics.length; i++) {\r\n        if (ics[i].icuid === id)\r\n            return ics[i];\r\n    }\r\n    return undefined;\r\n}\r\n\r\nfunction findByUID(objects, id) {\r\n    for (var i = 0; i < objects.length; i++) {\r\n        if (objects[i].uid === id)\r\n            return objects[i];\r\n    }\r\n    return undefined;\r\n}\r\n\r\n/**\r\n * Creates a group transform action given\r\n * the relevant objects and their original\r\n * transforms\r\n *\r\n * @param  {Array} objects\r\n *         The array of objects who have been transformed\r\n *\r\n * @param  {Array} t0\r\n *         The array of transforms that correspond to\r\n *         the original transform of the object in objects\r\n */\r\nfunction createTransformAction(objects, t0) {\r\n    var action = new GroupAction();\r\n    for (var i = 0; i < objects.length; i++) {\r\n        var origin = t0[i];\r\n        var target = objects[i].transform.copy();\r\n        if (origin.equals(target))\r\n            continue;\r\n        action.add(new TransformAction(objects[i], origin, target));\r\n    }\r\n    return action;\r\n}\r\n\r\n/**\r\n * Finds and returns the closest 't' value\r\n * of the parametric equation for a line.\r\n *\r\n * Parametric function defined by\r\n * X(t) = t(p2.x - p1.x) + p1.x\r\n * Y(t) = t(p2.y - p1.y) + p1.y\r\n *\r\n * Solves for 't' from root of the derivative of\r\n * the distance function between the line and <mx, my>\r\n * D(t) = sqrt((X(t) - mx)^2 + (Y(t) - my)^2)\r\n *\r\n * @param  {Vector} p1\r\n *         The first point of the line\r\n *\r\n * @param  {Vector} p2\r\n *         The second point of the line\r\n *\r\n * @param  {Number} mx\r\n *         The x-value of the point\r\n *         to determine the 't' value\r\n *\r\n * @param  {Number} my\r\n *         The y-value of the point\r\n *         to determine the 't' value\r\n *\r\n * @return {Number}\r\n *         The nearest 't' value of <mx, my>\r\n *         on the line p1->p2 or -1 if the\r\n *         dist < WIRE_DIST_THRESHOLD\r\n */\r\nfunction getNearestT(p1, p2, mx, my) {\r\n    var dx = p2.x - p1.x;\r\n    var dy = p2.y - p1.y;\r\n    var t = (dx*(mx - p1.x) + dy*(my - p1.y))/(dx*dx + dy*dy);\r\n    t = clamp(t, 0, 1);\r\n    var pos = V(dx * t + p1.x, dy * t + p1.y);\r\n    if (pos.sub(V(mx, my)).len2() < WIRE_DIST_THRESHOLD2)\r\n        return t;\r\n    else\r\n        return -1;\r\n}\r\n\r\n/**\r\n * Uses Newton's method to find the roots of\r\n * the function 'f' given a derivative 'df'\r\n *\r\n * @param  {Number} iterations\r\n *         The number of iterations to perform\r\n *         Newton's method with; the smaller\r\n *         the better but less accurate\r\n *\r\n * @param  {Number} t0\r\n *         The starting root value parameter\r\n *\r\n * @param  {Number} x\r\n *         Parameter 1 for the function\r\n *\r\n * @param  {Number} y\r\n *         Parameter 2 for the function\r\n *\r\n * @param  {Function} f\r\n *         The function to find the roots of\r\n *         In the form f(t, x, y) = ...\r\n *\r\n * @param  {Function} df\r\n *         The derivative of the function\r\n *         In the form of df(t, x, y)\r\n *\r\n * @return {Number}\r\n *         The parameter 't' that results in\r\n *         f(t, x, y) = 0\r\n */\r\nfunction findRoots(iterations, t0, x, y, f, df) {\r\n    var t = t0;\r\n    do {\r\n        var v = f(t, x, y);\r\n        var dv = df(t, x, y);\r\n        if (dv === 0)\r\n            break;\r\n        t = t - v / dv;\r\n        t = clamp(t, 0.01, 0.99);\r\n    } while((iterations--) > 0);\r\n    return t;\r\n}\r\n\r\n// Separates an array of objects into three sub-groups\r\n// of input-type objects (switch and buttons),\r\n// output-type objects (LEDs),\r\n// and other components.\r\nfunction separateGroup(group) {\r\n    var inputs = [];\r\n    var components = [];\r\n    var outputs = [];\r\n    for (var i = 0; i < group.length; i++) {\r\n        var object = group[i];\r\n        if (object instanceof Switch || object instanceof Button || object instanceof Clock)\r\n            inputs.push(object);\r\n        else if (object instanceof LED)\r\n            outputs.push(object);\r\n        else\r\n            components.push(object);\r\n    }\r\n    return {inputs:inputs, components:components, outputs:outputs};\r\n}\r\n\r\n/**\r\n * Clamps a number between a given min and max\r\n *\r\n * @param  {Number} x\r\n *         The number to clamp\r\n *\r\n * @param  {Number} min\r\n *         The minimum\r\n *\r\n * @param  {Number} max\r\n *         The maximum\r\n *\r\n * @return {Number}\r\n *         The clamped number\r\n */\r\nfunction clamp(x, min, max) {\r\n    return Math.min(Math.max(x, min), max);\r\n}\r\n\r\n// Code from https://stackoverflow.com/questions/5916900/how-can-you-detect-the-version-of-a-browser\r\nfunction getBrowser() {\r\n    if (navigator == undefined)\r\n        return;\r\n    var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\\/))\\/?\\s*(\\d+)/i) || [];\r\n    if(/trident/i.test(M[1])) {\r\n        tem=/\\brv[ :]+(\\d+)/g.exec(ua) || [];\r\n        return {name:'IE',version:(tem[1]||'')};\r\n    }\r\n    if(M[1]==='Chrome') {\r\n        tem=ua.match(/\\bOPR|Edge\\/(\\d+)/)\r\n        if(tem!=null)   {return {name:'Opera', version:tem[1]};}\r\n    }\r\n    M=M[2]? [M[1], M[2]]: [navigator.appName, navigator.appVersion, '-?'];\r\n    if((tem=ua.match(/version\\/(\\d+)/i))!=null) {M.splice(1,1,tem[1]);}\r\n    return {\r\n      name: M[0],\r\n      version: M[1]\r\n    };\r\n }\r\n","class CircuitDesigner {\r\n    constructor(canvas, vw, vh) {\r\n        this.renderer = new Renderer(this, canvas, vw, vh);\r\n        this.camera = new Camera(this);\r\n        this.history = new HistoryManager();\r\n\r\n        this.wires = [];\r\n        this.objects = [];\r\n\r\n        this.propogationQueue = [];\r\n\r\n        window.addEventListener('resize', e => this.resize(), false);\r\n\r\n        this.resize();\r\n    }\r\n    reset() {\r\n        for (var i = 0; i < this.objects.length; i++)\r\n            this.objects[i].remove();\r\n        for (var i = 0; i < this.wires.length; i++)\r\n            this.wires[i].remove();\r\n        this.objects = [];\r\n        this.wires = [];\r\n        this.propogationQueue = [];\r\n    }\r\n    propogate(sender, receiver, signal) {\r\n        this.propogationQueue.push(new Propogation(sender, receiver, signal, () => this.update(sender, receiver)));//() => this.update()));\r\n    }\r\n    update(sender, receiver) {\r\n        var tempQueue = [];\r\n        while (this.propogationQueue.length > 0)\r\n            tempQueue.push(this.propogationQueue.pop());\r\n\r\n        while (tempQueue.length > 0)\r\n            tempQueue.pop().send();\r\n\r\n        if (this.propogationQueue.length > 0)\r\n            updateRequests++;\r\n\r\n        updateRequests--;\r\n\r\n        console.log(\"update\");\r\n\r\n        // See if the sender/receiver is a wire in the scene (not in an IC) to render\r\n        var inScene = false;\r\n        if (sender instanceof Wire || receiver instanceof Wire) {\r\n            for (var i = 0; i < this.wires.length; i++) {\r\n                if (this.wires[i] === sender || this.wires[i] === receiver) {\r\n                    inScene = true;\r\n                    break;\r\n                }\r\n            }\r\n        } else {\r\n            render();\r\n        }\r\n\r\n        if (inScene)\r\n            render();\r\n\r\n        if (updateRequests > 0) {\r\n            setTimeout(() => this.update(sender, receiver), PROPOGATION_TIME);\r\n        }\r\n    }\r\n    render() {\r\n        // console.log(\"RENDER\");\r\n\r\n        this.renderer.clear();\r\n\r\n        var step = GRID_SIZE/this.camera.zoom;\r\n\r\n        var cpos = V(this.camera.pos.x/this.camera.zoom - this.renderer.canvas.width/2, this.camera.pos.y/this.camera.zoom - this.renderer.canvas.height/2);\r\n\r\n        var cpx = cpos.x - Math.floor(cpos.x / step) * step;\r\n        if (cpx < 0) cpx += step;\r\n        var cpy = cpos.y - Math.floor(cpos.y / step) * step;\r\n        if (cpy < 0) cpy += step;\r\n\r\n        // Batch-render the lines = uglier code + way better performance\r\n        this.renderer.save();\r\n        this.renderer.setStyles(undefined, '#999', 1 / this.camera.zoom);\r\n        this.renderer.context.beginPath();\r\n        for (var x = -cpx; x <= this.renderer.canvas.width-cpx+step; x += step) {\r\n            this.renderer._line(x, 0, x, this.renderer.canvas.height);\r\n        }\r\n        for (var y = -cpy; y <= this.renderer.canvas.height-cpy+step; y += step) {\r\n            this.renderer._line(0, y, this.renderer.canvas.width, y);\r\n        }\r\n        this.renderer.context.closePath();\r\n        this.renderer.context.stroke();\r\n        this.renderer.restore();\r\n\r\n        // Cull objects/wires if they aren't on the screen\r\n        for (var i = 0; i < this.wires.length; i++) {\r\n            if (this.camera.cull(this.wires[i].getCullBox()))\r\n                this.wires[i].draw();\r\n        }\r\n        for (var i = 0; i < this.objects.length; i++) {\r\n            if (this.camera.cull(this.objects[i].getCullBox()))\r\n                this.objects[i].draw();\r\n        }\r\n\r\n        CurrentTool.draw(this.renderer);\r\n    }\r\n    resize() {\r\n        this.renderer.resize();\r\n        this.camera.resize();\r\n\r\n        render();\r\n    }\r\n    addObject(o) {\r\n        if (this.getIndexOfObject(o) === -1)\r\n            this.objects.push(o);\r\n        else\r\n            console.error(\"Attempted to add an object that already existed!\");\r\n    }\r\n    addWire(w) {\r\n        if (this.getIndexOfWire(w) === -1)\r\n            this.wires.push(w);\r\n        else\r\n            console.error(\"Attempted to add a wire that already existed!\");\r\n    }\r\n    getRenderer() {\r\n        return this.renderer;\r\n    }\r\n    getObjects() {\r\n        return this.objects;\r\n    }\r\n    getWires() {\r\n        return this.wires;\r\n    }\r\n    getIndexOfObject(obj) {\r\n        for (var i = 0; i < this.objects.length; i++) {\r\n            if (obj === this.objects[i])\r\n                return i;\r\n        }\r\n        return -1;\r\n    }\r\n    getIndexOfWire(wire) {\r\n        for (var i = 0; i < this.wires.length; i++) {\r\n            if (wire === this.wires[i])\r\n                return i;\r\n        }\r\n        return -1;\r\n    }\r\n}\r\n","class ICDesigner {\r\n    constructor() {\r\n        this.canvas = document.getElementById(\"designer-canvas\");\r\n\r\n        this.designer = new CircuitDesigner(this.canvas, 0.84, 0.76);\r\n        this.context = new Context(this.designer);\r\n\r\n        this.ic = undefined;\r\n        this.data = undefined;\r\n\r\n        this.drag = false;\r\n        this.dragObj = undefined;\r\n\r\n        this.dragEdge = undefined;\r\n        \r\n        this.disabled = true;\r\n\r\n        this.confirmButton = document.getElementById(\"ic-confirmbutton\");\r\n        this.cancelButton = document.getElementById(\"ic-cancelbutton\");\r\n\r\n        this.hide();\r\n    }\r\n    confirm() {\r\n        if (this.ic != undefined) {\r\n            ICData.add(this.data);\r\n            var out = this.ic.copy();\r\n            out.setContext(context);\r\n            context.getDesigner().addObject(out);\r\n            this.hide();\r\n        }\r\n    }\r\n    cancel() {\r\n        if (this.ic != undefined) {\r\n            this.hide();\r\n        }\r\n    }\r\n    show(selections) {\r\n        currentContext = this.context;\r\n        this.disabled = false;\r\n        TransformController.disabled = true;\r\n        WireController.disabled = true;\r\n        SelectionBox.disabled = true;\r\n        \r\n        this.hidden = false;\r\n        this.canvas.style.visibility = \"visible\";\r\n        this.confirmButton.style.visibility = \"visible\";\r\n        this.cancelButton.style.visibility = \"visible\";\r\n        if (ItemNavController.isOpen)\r\n            ItemNavController.toggle();\r\n        popup.hide();\r\n\r\n        this.data = ICData.create(selections);\r\n        this.ic = new IC(this.context, this.data, 0, 0);\r\n\r\n        this.designer.addObject(this.ic);\r\n        selectionTool.deselectAll();\r\n        this.context.getCamera().zoom = 0.5 + 0.1*(this.ic.transform.size.x-50)/20;\r\n        render();\r\n    }\r\n    hide() {\r\n        currentContext = context;\r\n        this.disabled = true;\r\n        TransformController.disabled = false;\r\n        WireController.disabled = false;\r\n        SelectionBox.disabled = false;\r\n        \r\n        this.hidden = true;\r\n        this.canvas.style.visibility = \"hidden\";\r\n        this.confirmButton.style.visibility = \"hidden\";\r\n        this.cancelButton.style.visibility = \"hidden\";\r\n        if (this.ic != undefined) {\r\n            this.ic.remove();\r\n            this.ic = undefined;\r\n            this.data = undefined;\r\n        }\r\n        render();\r\n    }\r\n    onMouseDown() {\r\n        if (this.ic == undefined)\r\n            return false;\r\n\r\n        var worldMousePos = Input.getWorldMousePos();\r\n\r\n        var inputs = this.ic.inputs;\r\n        for (var i = 0; i < inputs.length; i++) {\r\n            var inp = inputs[i];\r\n            if (inp.sContains(worldMousePos)) {\r\n                this.drag = true;\r\n                this.dragObj = this.data.iports[i];\r\n                return true;\r\n            }\r\n        }\r\n        var outputs = this.ic.outputs;\r\n        for (var i = 0; i < outputs.length; i++) {\r\n            var out = outputs[i];\r\n            if (out.sContains(worldMousePos)) {\r\n                this.drag = true;\r\n                this.dragObj = this.data.oports[i];\r\n                return true;\r\n            }\r\n        }\r\n\r\n        var pos = this.ic.getPos();\r\n        var size = this.ic.getSize();\r\n        var transform1 = new Transform(pos, size.scale(1.2), 0, this.context.getCamera());\r\n        var transform2 = new Transform(pos, size.scale(0.8), 0, this.context.getCamera());\r\n        if (rectContains(transform1, worldMousePos) && !rectContains(transform2, worldMousePos)) {\r\n            if (worldMousePos.y < pos.y+size.y/2-4 && worldMousePos.y > pos.y-size.y/2+4) {\r\n                this.dragEdge = \"horizontal\";\r\n            } else {\r\n                this.dragEdge = \"vertical\";\r\n            }\r\n            return true;\r\n        }\r\n    }\r\n    onMouseUp() {\r\n        if (this.ic == undefined)\r\n            return false;\r\n\r\n        this.drag = false;\r\n        this.dragObj = undefined;\r\n        this.dragEdge = undefined;\r\n    }\r\n    onMouseMove() {\r\n        if (this.ic == undefined)\r\n            return false;\r\n\r\n        var worldMousePos = Input.getWorldMousePos();\r\n\r\n        if (this.drag) {\r\n            var size = this.ic.getSize();\r\n            var p = getNearestPointOnRect(V(-size.x/2, -size.y/2), V(size.x/2, size.y/2), worldMousePos);\r\n            var v1 = p.sub(worldMousePos).normalize().scale(size.scale(0.5)).add(p);\r\n            var v2 = p.sub(worldMousePos).normalize().scale(size.scale(0.5).sub(V(IO_PORT_LENGTH+size.x/2-25, IO_PORT_LENGTH+size.y/2-25))).add(p);\r\n            this.dragObj.setOrigin(v1);\r\n            this.dragObj.setTarget(v2);\r\n\r\n            this.ic.update();\r\n\r\n            return true;\r\n        }\r\n        if (this.dragEdge != undefined) {\r\n            if (this.dragEdge === \"horizontal\") {\r\n                this.data.transform.setWidth(Math.abs(2*worldMousePos.x));\r\n            } else {\r\n                this.data.transform.setHeight(Math.abs(2*worldMousePos.y));\r\n            }\r\n            this.data.recalculatePorts();\r\n\r\n            this.ic.update();\r\n\r\n            return true;\r\n        }\r\n    }\r\n    onClick() {\r\n    }\r\n}\r\n","\r\nvar images = [];\r\n\r\nvar popup;\r\nvar contextmenu;\r\nvar icdesigner;\r\n\r\nvar context;\r\n\r\nvar currentContext;\r\n\r\nvar browser = getBrowser();\r\n\r\nvar saved = true;\r\n\r\n// Prompt for exit\r\nwindow.onbeforeunload = function(e) {\r\n    if (!saved) {\r\n        var dialogText = \"You have unsaved changes.\";\r\n        e.returnValue = dialogText;\r\n        return dialogText;\r\n    }\r\n};\r\n\r\nfunction start() {\r\n    var designer = new CircuitDesigner(document.getElementById(\"canvas\"));\r\n    context = new Context(designer);\r\n    currentContext = context;\r\n\r\n    popup = new SelectionPopup();\r\n    icdesigner = new ICDesigner();\r\n    contextmenu = new ContextMenu();\r\n\r\n    Input.registerContext(context);\r\n    Input.registerContext(icdesigner.context);\r\n    Input.addMouseListener(icdesigner);\r\n    Input.addMouseListener(TransformController);\r\n    Input.addMouseListener(WireController);\r\n    Input.addMouseListener(SelectionBox);\r\n\r\n    selectionTool.activate();\r\n\r\n    loadImage(images,\r\n        [\"constLow.svg\", \"constHigh.svg\",\r\n         \"buttonUp.svg\", \"buttonDown.svg\",\r\n         \"switchUp.svg\", \"switchDown.svg\",\r\n         \"led.svg\", \"ledLight.svg\",\r\n         \"buffer.svg\", \"and.svg\",\r\n         \"or.svg\", \"xor.svg\",\r\n         \"segment1.svg\", \"segment2.svg\",\r\n         \"segment3.svg\", \"segment4.svg\",\r\n         \"clock.svg\", \"clockOn.svg\",\r\n         \"keyboard.svg\", \"base.svg\"], 0, onFinishLoading);\r\n}\r\n\r\nfunction wire(source, target) {\r\n    var wire = new Wire(getCurrentContext(), source);\r\n    source.connect(wire);\r\n    wire.connect(target);\r\n}\r\n\r\nfunction reset() {\r\n    ICData.ICs = [];\r\n    currentContext = context;\r\n    context.reset();\r\n}\r\n\r\nfunction onFinishLoading() {\r\n    render();\r\n}\r\n\r\nvar renderQueue = 0;\r\n\r\nfunction render() {\r\n    if (renderQueue === 0)\r\n        requestAnimationFrame(actualRender);\r\n    renderQueue++;\r\n}\r\n\r\nfunction actualRender() {\r\n    // console.log(\"Saved : \" + (renderQueue - 1) + \" render calls!\");\r\n    renderQueue = 0;\r\n    getCurrentContext().render();\r\n}\r\n\r\nfunction loadImage(imgs, imageNames, index, onFinish) {\r\n    var img = new Image();\r\n    img.onload = function() {\r\n        imgs[imageNames[index]] = img;\r\n        img.dx = 0;\r\n        img.dy = 0;\r\n        img.ratio = img.width / img.height;\r\n        if (index === imageNames.length-1)\r\n            onFinish(imgs);\r\n        else\r\n            loadImage(imgs, imageNames, index+1, onFinish);\r\n    };\r\n    img.src = \"img/items/\" + imageNames[index];\r\n}\r\n","class Renderer {\r\n    constructor(parent, canvas, vw, vh) {\r\n        this.parent = parent;\r\n        this.canvas = canvas;\r\n        this.tintCanvas = document.createElement(\"canvas\");\r\n        this.vw = (vw == undefined ? 1 : vw);\r\n        this.vh = (vh == undefined ? 1 : vh);\r\n\r\n        this.context = this.canvas.getContext(\"2d\");\r\n\r\n        this.tintCanvas.width = 100;\r\n        this.tintCanvas.height = 100;\r\n        this.tintContext = this.tintCanvas.getContext(\"2d\");\r\n    }\r\n    getCamera() {\r\n        return this.parent.camera;\r\n    }\r\n    setCursor(cursor) {\r\n        this.canvas.style.cursor = cursor;\r\n    }\r\n    resize() {\r\n        this.canvas.width = window.innerWidth * this.vw;\r\n        this.canvas.height = window.innerHeight * this.vh;\r\n    }\r\n    clear() {\r\n        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n    save() {\r\n        this.context.save();\r\n    }\r\n    restore() {\r\n        this.context.restore();\r\n    }\r\n    translate(v) {\r\n        this.context.translate(v.x, v.y);\r\n    }\r\n    scale(s) {\r\n        this.context.scale(s.x, s.y);\r\n    }\r\n    rotate(a) {\r\n        this.context.rotate(a);\r\n    }\r\n    rect(x, y, w, h, fillStyle, borderStyle, borderSize, alpha) {\r\n        this.save();\r\n        this.setStyles(fillStyle, borderStyle, borderSize, alpha);\r\n        this.context.beginPath();\r\n        this.context.rect(x - w/2, y - h/2, w, h);\r\n        this.context.fill();\r\n        if (borderSize > 0 || borderSize == undefined)\r\n            this.context.stroke();\r\n        this.context.closePath();\r\n        this.restore();\r\n    }\r\n    circle(x, y, r, fillStyle, borderStyle, borderSize, alpha) {\r\n        this.save();\r\n        this.setStyles(fillStyle, borderStyle, borderSize, alpha);\r\n        this.context.beginPath();\r\n        this.context.arc(x, y, r, 0, 2*Math.PI);\r\n        if (fillStyle != undefined)\r\n            this.context.fill();\r\n        if (borderSize > 0 || borderSize == undefined)\r\n            this.context.stroke();\r\n        this.context.closePath();\r\n        this.restore();\r\n    }\r\n    image(img, x, y, w, h, tint) {\r\n        this.context.drawImage(img, x - w/2, y - h/2, w, h);\r\n        if (tint != undefined)\r\n            this.tintImage(img, x, y, w, h, tint);\r\n    }\r\n    tintImage(img, x, y, w, h, tint) {\r\n        this.tintContext.clearRect(0, 0, this.tintCanvas.width, this.tintCanvas.height);\r\n        this.tintContext.fillStyle = tint;\r\n        this.tintContext.fillRect(0, 0, this.tintCanvas.width, this.tintCanvas.height);\r\n        if (browser.name !== \"Firefox\")\r\n            this.tintContext.globalCompositeOperation = \"destination-atop\";\r\n        else\r\n            this.tintContext.globalCompositeOperation = \"source-atop\";\r\n        this.tintContext.drawImage(img, 0, 0, this.tintCanvas.width, this.tintCanvas.height);\r\n\r\n        this.context.globalAlpha = 0.5;\r\n        this.context.drawImage(this.tintCanvas, x - w/2, y - h/2, w, h);\r\n        this.context.globalAlpha = 1.0;\r\n    }\r\n    text(txt, x, y, w, h, textAlign) {\r\n        this.save();\r\n        this.context.font = \"lighter 15px arial\";\r\n        this.context.fillStyle = '#000';\r\n        this.context.textAlign = textAlign;\r\n        this.context.textBaseline = \"middle\";\r\n        this.context.fillText(txt, x, y);\r\n        this.restore();\r\n    }\r\n    getTextWidth(txt) {\r\n        var width = 0;\r\n        this.save();\r\n        this.context.font = \"lighter 15px arial\";\r\n        this.context.fillStyle = '#000';\r\n        this.context.textBaseline = \"middle\";\r\n        width = this.context.measureText(txt).width;\r\n        this.restore();\r\n        return width;\r\n    }\r\n    line(x1, y1, x2, y2, style, size) {\r\n        this.save();\r\n        this.setStyles(undefined, style, size);\r\n        this.context.beginPath();\r\n        this.context.moveTo(x1, y1);\r\n        this.context.lineTo(x2, y2);\r\n        this.context.stroke();\r\n        this.context.closePath();\r\n        this.restore();\r\n    }\r\n    _line(x1, y1, x2, y2) {\r\n        this.context.moveTo(x1, y1);\r\n        this.context.lineTo(x2, y2);\r\n    }\r\n    curve(x1, y1, x2, y2, cx1, cy1, cx2, cy2, style, size) {\r\n        this.save();\r\n        this.setStyles(undefined, style, size);\r\n        this.context.beginPath();\r\n        this.context.moveTo(x1, y1);\r\n        this.context.bezierCurveTo(cx1, cy1, cx2, cy2, x2, y2);\r\n        this.context.stroke();\r\n        this.context.closePath();\r\n        this.restore();\r\n    }\r\n    quadCurve(x1, y1, x2, y2, cx, cy, style, size) {\r\n        this.save();\r\n        this.setStyles(undefined, style, size);\r\n        this.context.beginPath();\r\n        this.context.moveTo(x1, y1);\r\n        this.context.quadraticCurveTo(cx, cy, x2, y2);\r\n        this.context.stroke();\r\n        this.context.closePath();\r\n        this.restore();\r\n    }\r\n    shape(points, fillStyle, borderStyle, borderSize) {\r\n        this.save();\r\n        this.setStyles(fillStyle, borderStyle, borderSize);\r\n        this.context.beginPath();\r\n        this.context.moveTo(points[0].x, points[0].y);\r\n        for (var i = 1; i < points.length; i++)\r\n            this.context.lineTo(points[i].x, points[i].y);\r\n        this.context.lineTo(points[0].x, points[0].y);\r\n        this.context.fill();\r\n        this.context.closePath();\r\n        if (borderSize > 0)\r\n            this.context.stroke();\r\n        this.restore();\r\n    }\r\n    setStyles(fillStyle, borderStyle, borderSize, alpha) {\r\n        if (alpha != undefined && alpha !== this.context.globalAlpha)\r\n            this.context.globalAlpha = alpha;\r\n\r\n        fillStyle = (fillStyle == undefined) ? ('#ffffff') : (fillStyle);\r\n        if (fillStyle != undefined && fillStyle !== this.context.fillStyle)\r\n            this.context.fillStyle = fillStyle;\r\n\r\n        borderStyle = (borderStyle == undefined) ? ('#000000') : (borderStyle);\r\n        if (borderStyle != undefined && borderStyle !== this.context.strokeStyle)\r\n            this.context.strokeStyle = borderStyle;\r\n\r\n        borderSize = (borderSize == undefined) ? (2) : (borderSize);\r\n        if (borderSize != undefined && borderSize !== this.context.lineWidth)\r\n            this.context.lineWidth = borderSize;\r\n    }\r\n}\r\n","class IOObject {\r\n    constructor(context, x, y, w, h, img, isPressable, maxInputs, maxOutputs, selectionBoxWidth, selectionBoxHeight) {\r\n        if (context == undefined)\r\n            context = getCurrentContext();\r\n        this.context = context;\r\n        x = (x == undefined ? 0 : x);\r\n        y = (y == undefined ? 0 : y)\r\n        this.transform = new Transform(V(x, y), V(w, h), 0, context.getCamera());\r\n        this.cullTransform = new Transform(this.transform.getPos(), V(0,0), 0, this.context.getCamera());\r\n\r\n        this.name = this.getDisplayName();\r\n        this.img = img;\r\n        this.isOn = false;\r\n        this.isPressable = isPressable;\r\n        this.maxInputs = maxInputs;\r\n        this.maxOutputs = maxOutputs;\r\n        this.selected = false;\r\n\r\n        if (this.isPressable)\r\n            this.selectionBoxTransform = new Transform(V(x, y), V(selectionBoxWidth, selectionBoxHeight), 0, context.getCamera());\r\n\r\n        this.outputs = [];\r\n        this.inputs = [];\r\n\r\n        if (maxOutputs > 0)\r\n            this.setOutputAmount(1);\r\n    }\r\n    setInputAmount(target) {\r\n        target = clamp(target, 0, this.maxInputs);\r\n        while (this.inputs.length > target)\r\n            this.inputs.splice(this.inputs.length-1, 1);\r\n        while (this.inputs.length < target)\r\n            this.inputs.push(new IPort(this));\r\n\r\n        for (var i = 0; i < this.inputs.length; i++)\r\n            this.inputs[i].updatePosition();\r\n        this.onTransformChange();\r\n    }\r\n    setOutputAmount(target) {\r\n        target = clamp(target, 0, this.maxOutputs);\r\n        while (this.outputs.length > target)\r\n            this.outputs.splice(this.outputs.length-1, 1);\r\n        while (this.outputs.length < target)\r\n            this.outputs.push(new OPort(this));\r\n\r\n        for (var i = 0; i < this.outputs.length; i++)\r\n            this.outputs[i].updatePosition();\r\n        this.onTransformChange();\r\n    }\r\n    onTransformChange() {\r\n        if (this.isPressable && this.selectionBoxTransform != undefined) {\r\n            this.selectionBoxTransform.setPos(this.transform.getPos());\r\n            this.selectionBoxTransform.setAngle(this.transform.getAngle());\r\n            this.selectionBoxTransform.setScale(this.transform.getScale());\r\n        }\r\n        this.updateCullTransform();\r\n        for (var i = 0; i < this.inputs.length; i++)\r\n            this.inputs[i].onTransformChange();\r\n        for (var i = 0; i < this.outputs.length; i++)\r\n            this.outputs[i].onTransformChange();\r\n    }\r\n    updateCullTransform() {\r\n        // Find min/max points on the object\r\n        var min = V(-this.transform.size.x/2, -this.transform.size.y/2);\r\n        var max = V(this.transform.size.x/2, this.transform.size.y/2);\r\n        if (this.selectionBoxTransform != undefined) {\r\n            min.x = Math.min(-this.selectionBoxTransform.size.x/2, min.x);\r\n            min.y = Math.min(-this.selectionBoxTransform.size.y/2, min.y);\r\n            max.x = Math.max(this.selectionBoxTransform.size.x/2, max.x);\r\n            max.y = Math.max(this.selectionBoxTransform.size.y/2, max.y);\r\n        }\r\n        for (var i = 0; i < this.inputs.length; i++) {\r\n            var iport = this.inputs[i];\r\n            min.x = Math.min(iport.target.x, min.x);\r\n            min.y = Math.min(iport.target.y, min.y);\r\n            max.x = Math.max(iport.target.x, max.x);\r\n            max.y = Math.max(iport.target.y, max.y);\r\n        }\r\n        for (var i = 0; i < this.outputs.length; i++) {\r\n            var oport = this.outputs[i];\r\n            min.x = Math.min(oport.target.x, min.x);\r\n            min.y = Math.min(oport.target.y, min.y);\r\n            max.x = Math.max(oport.target.x, max.x);\r\n            max.y = Math.max(oport.target.y, max.y);\r\n        }\r\n        this.cullTransform.setSize(V(max.x - min.x, max.y - min.y));\r\n        var c = Math.cos(this.transform.getAngle());\r\n        var s = Math.sin(this.transform.getAngle());\r\n        var x = (min.x - (-this.cullTransform.size.x/2)) * c + (min.y - (-this.cullTransform.size.y/2)) * s;\r\n        var y = (min.y - (-this.cullTransform.size.y/2)) * c + (min.x - (-this.cullTransform.size.x/2)) * s;\r\n        this.cullTransform.setPos(this.transform.getPos().add(V(x, y)));\r\n        this.cullTransform.setAngle(this.transform.getAngle());\r\n        this.cullTransform.setScale(this.transform.getScale());\r\n        this.cullTransform.setSize(this.cullTransform.size.add(V(2*IO_PORT_RADIUS, 2*IO_PORT_RADIUS)));\r\n    }\r\n    click() {\r\n        // console.log(this);\r\n    }\r\n    press() {\r\n    }\r\n    release() {\r\n    }\r\n    activate(on, i) {\r\n        if (i == undefined)\r\n            i = 0;\r\n\r\n        this.isOn = on;\r\n        if (this.outputs[i] != undefined)\r\n            this.outputs[i].activate(on);\r\n    }\r\n    localSpace() {\r\n        var renderer = this.context.getRenderer();\r\n        renderer.save();\r\n        this.transform.transformCtx(renderer.context);\r\n    }\r\n    draw() {\r\n        this.localSpace();\r\n        for (var i = 0; i < this.inputs.length; i++)\r\n            this.inputs[i].draw();\r\n\r\n        for (var i = 0; i < this.outputs.length; i++)\r\n            this.outputs[i].draw(i);\r\n\r\n        var renderer = this.context.getRenderer();\r\n        if (this.isPressable && this.selectionBoxTransform != undefined)\r\n            renderer.rect(0, 0, this.selectionBoxTransform.size.x, this.selectionBoxTransform.size.y, this.getCol(), this.getBorderColor());\r\n\r\n        if (this.img != undefined)\r\n            renderer.image(this.img, 0, 0, this.transform.size.x, this.transform.size.y, this.getImageTint());\r\n        renderer.restore();\r\n    }\r\n    remove() {\r\n        this.context.remove(this);\r\n        for (var i = 0; i < this.outputs.length; i++)\r\n            this.outputs[i].remove();\r\n        for (var i = 0; i < this.inputs.length; i++)\r\n            this.inputs[i].remove();\r\n    }\r\n    contains(pos) {\r\n        return rectContains(this.transform, pos);\r\n    }\r\n    sContains(pos) {\r\n        return (!this.isPressable &&  this.contains(pos)) ||\r\n                (this.isPressable && !this.contains(pos) && rectContains(this.selectionBoxTransform, pos));\r\n    }\r\n    iPortContains(pos) {\r\n        for (var i = 0; i < this.inputs.length; i++) {\r\n            if (this.inputs[i].contains(pos))\r\n                return i;\r\n        }\r\n        return -1;\r\n    }\r\n    oPortContains(pos) {\r\n        for (var i = 0; i < this.outputs.length; i++) {\r\n            if (this.outputs[i].contains(pos))\r\n                return i;\r\n        }\r\n        return -1;\r\n    }\r\n    setContext(context) {\r\n        this.context = context;\r\n        this.transform.setCamera(this.context.getCamera());\r\n        if (this.selectionBoxTransform != undefined)\r\n            this.selectionBoxTransform.setCamera(this.context.getCamera());\r\n    }\r\n    setTransform(t) {\r\n        this.transform = t;\r\n        this.onTransformChange();\r\n    }\r\n    setPos(v) {\r\n        this.transform.setPos(v);\r\n        this.onTransformChange();\r\n    }\r\n    setAngle(a) {\r\n        this.transform.setAngle(a);\r\n        this.onTransformChange();\r\n    }\r\n    // setRotationAbout(a, c) {\r\n    //     this.transform.rotateAbout(a-this.getAngle(), c);\r\n    //     this.onTransformChange();\r\n    // }\r\n    setRotationAbout(a, c) {\r\n        this.transform.rotateAbout(-this.getAngle(), c);\r\n        this.transform.rotateAbout(a, c);\r\n        this.onTransformChange();\r\n    }\r\n    setName(name) {\r\n        this.name = name;\r\n    }\r\n    getCullBox() {\r\n        return this.cullTransform;\r\n    }\r\n    getInputAmount() {\r\n        return this.inputs.length;\r\n    }\r\n    getImageTint() {\r\n        return this.getCol();\r\n    }\r\n    getCol() {\r\n        return (this.selected ? '#1cff3e' : undefined);\r\n    }\r\n    getBorderColor() {\r\n        return (this.selected ? '#0d7f1f' : undefined);\r\n    }\r\n    getPos() {\r\n        return this.transform.pos.copy();\r\n    }\r\n    getAngle() {\r\n        return this.transform.angle;\r\n    }\r\n    getSize() {\r\n        return this.transform.size;\r\n    }\r\n    getMaxInputFieldCount() {\r\n        return 8;\r\n    }\r\n    getMinInputFieldCount() {\r\n        return 2;\r\n    }\r\n    getName() {\r\n        return this.name;\r\n    }\r\n    getDisplayName() {\r\n        return \"IOObject\";\r\n    }\r\n    getRenderer() {\r\n        return this.context.getRenderer();\r\n    }\r\n    copy() {\r\n        var copy = new this.constructor(this.context);\r\n        copy.transform = this.transform.copy();\r\n        copy.name = this.name;\r\n        if (this.selectionBoxTransform != undefined)\r\n            copy.selectionBoxTransform = this.selectionBoxTransform.copy();\r\n        for (var i = 0; i < this.inputs.length; i++) {\r\n            copy.inputs[i] = this.inputs[i].copy();\r\n            copy.inputs[i].parent = copy;\r\n        }\r\n        for (var i = 0; i < this.outputs.length; i++) {\r\n            copy.outputs[i] = this.outputs[i].copy();\r\n            copy.outputs[i].parent = copy;\r\n        }\r\n        return copy;\r\n    }\r\n    writeTo(node) {\r\n        var objNode = createChildNode(node, this.constructor.getXMLName());\r\n        createTextElement(objNode, \"uid\", this.uid);\r\n        createTextElement(objNode, \"name\", this.getName());\r\n        createTextElement(objNode, \"x\", this.getPos().x);\r\n        createTextElement(objNode, \"y\", this.getPos().y);\r\n        createTextElement(objNode, \"angle\", this.getAngle());\r\n        return objNode;\r\n    }\r\n    load(node) {\r\n        var uid = getIntValue(getChildNode(node, \"uid\"));\r\n        var name = getStringValue(getChildNode(node, \"name\"));\r\n        var x = getFloatValue(getChildNode(node, \"x\"));\r\n        var y = getFloatValue(getChildNode(node, \"y\"));\r\n        var angle = getFloatValue(getChildNode(node, \"angle\"));\r\n        var isOn = getBooleanValue(getChildNode(node, \"isOn\"), false);\r\n        this.uid = uid;\r\n        this.setName(name);\r\n        if (isOn)\r\n            this.click(isOn);\r\n        this.setPos(V(x, y));\r\n        this.setAngle(angle);\r\n        return this;\r\n    }\r\n}\r\n","class IOPort {\r\n    constructor(parent, dir) {\r\n        this.isOn = false;\r\n        this.parent = parent;\r\n        this.connections = [];\r\n\r\n        this.lineColor = DEFAULT_BORDER_COLOR;\r\n\r\n        this.origin = V(0, 0);\r\n        this.target = dir.scale(IO_PORT_LENGTH);\r\n        this.dir = dir;\r\n\r\n        this.set = false;\r\n\r\n        if (parent != undefined)\r\n            this.updatePosition();\r\n    }\r\n    getArray() {\r\n    }\r\n    getIndex() {\r\n        for (var i = 0; (i < this.getArray().length) && (this.getArray()[i] !== this); i++);\r\n        return i;\r\n    }\r\n    getCol() {\r\n        return (this.parent.selected || this.selected ? '#1cff3e' : undefined);\r\n    }\r\n    getBorderColor() {\r\n        return (this.parent.selected || this.selected ? '#0d7f1f' : undefined);\r\n    }\r\n    updatePosition() {\r\n        var i = this.getIndex();\r\n\r\n        var l = -this.parent.transform.size.y/2*(i - this.getArray().length/2 + 0.5);\r\n        if (i === 0) l -= 1;\r\n        if (i === this.getArray().length-1) l += 1;\r\n\r\n        this.origin.y = l;\r\n        this.target.y = l;\r\n        this.prevParentLength = this.getArray().length;\r\n    }\r\n    onTransformChange() {\r\n        if (!this.set)\r\n            this.updatePosition();\r\n\r\n        for (var i = 0; i < this.connections.length; i++) {\r\n            if (this.connections[i] != undefined)\r\n                this.connections[i].onTransformChange();\r\n        }\r\n    }\r\n    activate(on) {\r\n    }\r\n    contains(pos) {\r\n        var transform = new Transform(this.target, V(IO_PORT_RADIUS, IO_PORT_RADIUS).scale(2), 0, this.parent.context.getCamera());\r\n        transform.setParent(this.parent.transform);\r\n        return circleContains(transform, pos);\r\n    }\r\n    sContains(pos) {\r\n        var angle = Math.atan2(this.target.y - this.origin.y, this.target.x - this.origin.x);\r\n        var len = this.origin.distanceTo(this.target);\r\n        var pos0 = this.target.add(this.origin).scale(0.5);\r\n        var transform = new Transform(pos0, V(len, IO_PORT_LINE_WIDTH*2), angle, this.parent.context.getCamera());\r\n        transform.setParent(this.parent.transform);\r\n        return rectContains(transform, pos);\r\n    }\r\n    draw() {\r\n        if (!this.set && this.getArray().length !== this.prevParentLength)\r\n            this.updatePosition();\r\n\r\n        var o = this.origin;\r\n        var v = this.target;\r\n        var renderer = this.parent.getRenderer();\r\n\r\n        var lineCol = (this.parent.getBorderColor() ? this.parent.getBorderColor() : this.lineColor);\r\n        renderer.line(o.x, o.y, v.x, v.y, lineCol, IO_PORT_LINE_WIDTH);\r\n\r\n        var circleFillCol = (this.getCol() ? this.getCol() : DEFAULT_FILL_COLOR);\r\n        var circleBorderCol = (this.getBorderColor() ? this.getBorderColor() : DEFAULT_BORDER_COLOR);\r\n        renderer.circle(v.x, v.y, IO_PORT_RADIUS, circleFillCol, circleBorderCol, IO_PORT_BORDER_WIDTH);\r\n    }\r\n    remove() {\r\n    }\r\n    setOrigin(v) {\r\n        this.origin.x = v.x;\r\n        this.origin.y = v.y;\r\n        this.set = true;\r\n        if (this.parent != undefined)\r\n            this.parent.onTransformChange();\r\n    }\r\n    setTarget(v) {\r\n        this.target.x = v.x;\r\n        this.target.y = v.y;\r\n        this.set = true;\r\n        if (this.parent != undefined)\r\n            this.parent.onTransformChange();\r\n    }\r\n    getPos() {\r\n        return this.parent.transform.getMatrix().mul(this.target);\r\n    }\r\n    getOPos() {\r\n        return this.parent.transform.getMatrix().mul(this.origin);\r\n    }\r\n    getDir() {\r\n        return this.parent.transform.getMatrix().mul(this.dir).sub(this.parent.getPos()).normalize();\r\n    }\r\n    get uid() {\r\n        return this.parent.uid;\r\n    }\r\n    setName(n) {\r\n    }\r\n    setPos() {\r\n    }\r\n    getInputAmount() {\r\n        return 1;\r\n    }\r\n    getMaxInputFieldCount() {\r\n        return 1;\r\n    }\r\n    getMinInputFieldCount() {\r\n        return 1;\r\n    }\r\n    getName() {\r\n        return this.getDisplayName();\r\n    }\r\n    getDisplayName() {\r\n        return \"ioport\";\r\n    }\r\n    getXMLName() {\r\n        return this.getDisplayName().toLowerCase().replace(/\\s+/g, '');\r\n    }\r\n    copy() {\r\n        var port = new this.constructor();\r\n        port.origin = this.origin.copy();\r\n        port.target = this.target.copy();\r\n        port.set = this.set;\r\n        port.lineColor = this.lineColor;\r\n        return port;\r\n    }\r\n    writeTo(node) {\r\n        var ioPortNode = createChildNode(node, this.getXMLName());\r\n        createTextElement(ioPortNode, \"originx\", this.origin.x);\r\n        createTextElement(ioPortNode, \"originy\", this.origin.y);\r\n        createTextElement(ioPortNode, \"targetx\", this.target.x);\r\n        createTextElement(ioPortNode, \"targety\", this.target.y);\r\n    }\r\n    load(node) {\r\n        var originx = getFloatValue(getChildNode(node, \"originx\"));\r\n        var originy = getFloatValue(getChildNode(node, \"originy\"));\r\n        var targetx = getFloatValue(getChildNode(node, \"targetx\"));\r\n        var targety = getFloatValue(getChildNode(node, \"targety\"));\r\n        this.setOrigin(V(originx, originy));\r\n        this.setTarget(V(targetx, targety));\r\n        return this;\r\n    }\r\n}\r\n","class IPort extends IOPort {\r\n    constructor(parent) {\r\n        super(parent, V(-1, 0))\r\n    }\r\n    getArray() {\r\n        return this.parent.inputs;\r\n    }\r\n    set input(obj) {\r\n        if (obj == undefined)\r\n            this.connections = [];\r\n        else\r\n            this.connections[0] = obj;\r\n    }\r\n    get input() {\r\n        if (this.connections.length > 0)\r\n            return this.connections[0];\r\n        else\r\n            return undefined;\r\n    }\r\n    activate(on) {\r\n        if (this.isOn === on)\r\n            return;\r\n\r\n        this.isOn = on;\r\n        this.parent.context.propogate(this, this.parent, this.isOn);\r\n    }\r\n    remove() {\r\n        if (this.input != undefined)\r\n            this.input.disconnect(this);\r\n    }\r\n    getDisplayName() {\r\n        return \"iport\";\r\n    }\r\n}\r\n","class OPort extends IOPort {\r\n    constructor(parent) {\r\n        super(parent, V(1, 0));\r\n    }\r\n    getArray() {\r\n        return this.parent.outputs;\r\n    }\r\n    activate(on) {\r\n        if (this.isOn === on)\r\n            return;\r\n\r\n        this.isOn = on;\r\n        for (var i = 0; i < this.connections.length; i++)\r\n            this.parent.context.propogate(this, this.connections[i], this.isOn);\r\n    }\r\n    remove() {\r\n        for (var i = 0; i < this.connections.length; i++)\r\n            this.disconnect(this.connections[i]);\r\n    }\r\n    connect(wire) {\r\n        this.connections.push(wire);\r\n        wire.input = this;\r\n        wire.onTransformChange();\r\n        wire.activate(this.isOn);\r\n        return true;\r\n    }\r\n    disconnect(obj) {\r\n        for (var i = 0; (i < this.connections.length) && (this.connections[i] !== obj); i++);\r\n        this.connections[i].input = undefined;\r\n        this.connections.splice(i, 1);\r\n    }\r\n    getDisplayName() {\r\n        return \"oport\";\r\n    }\r\n}\r\n","class Wire {\r\n    constructor(context) {\r\n        this.context = context;\r\n\r\n        this.input = undefined;\r\n        this.connection = undefined;\r\n\r\n        this.curve = new BezierCurve(V(0,0),V(0,0),V(0,0),V(0,0));\r\n        this.isOn = false;\r\n        this.set = false; // Manually set bezier control points\r\n\r\n        this.straight = false;\r\n        this.dirty = true;\r\n        this.boundingBox = new Transform(0,0,0,context.getCamera());\r\n    }\r\n    activate(on) {\r\n        if (this.isOn === on)\r\n            return;\r\n\r\n        this.isOn = on;\r\n        if (this.connection != undefined)\r\n            this.connection.activate(on);\r\n    }\r\n    split(t) {\r\n        var pos = this.curve.getPos(t);\r\n\r\n        var wire = new Wire(this.context);\r\n\r\n        var prevConnection = this.connection;\r\n        this.disconnect();\r\n\r\n        var port = new WirePort(this.context);\r\n        this.connect(port);\r\n        wire.connect(prevConnection);\r\n        port.connect(wire);\r\n\r\n        this.connection.setPos(pos);\r\n\r\n        getCurrentContext().addObject(port);\r\n        getCurrentContext().addWire(wire);\r\n    }\r\n    updateBoundingBox() {\r\n        if (!this.dirty)\r\n            return;\r\n        this.dirty = false;\r\n\r\n        var end1 = this.getPos(0);\r\n        var end2 = this.getPos(1);\r\n        var min = V(Math.min(end1.x, end2.x), Math.min(end1.y, end2.y));\r\n        var max = V(Math.max(end1.x, end2.x), Math.max(end1.y, end2.y));\r\n        this.boundingBox.setSize(V(max.x - min.x + 2, max.y - min.y + 2));\r\n        this.boundingBox.setPos(V((max.x - min.x)/2 + min.x, (max.y - min.y)/2 + min.y));\r\n    }\r\n    onTransformChange() {\r\n        if (this.input != undefined) {\r\n            var pos = this.input.getPos();\r\n            if (this.set) {\r\n                this.curve.c1.x += pos.x - this.curve.p1.x;\r\n                this.curve.c1.y += pos.y - this.curve.p1.y;\r\n            } else {\r\n                var dir = (this.input instanceof WirePort ? this.input.getODir() : this.input.getDir());\r\n                var c = dir.scale(DEFAULT_SIZE).add(pos);\r\n                this.curve.c1.x = c.x;\r\n                this.curve.c1.y = c.y;\r\n            }\r\n            this.curve.p1.x = pos.x;\r\n            this.curve.p1.y = pos.y;\r\n            this.curve.dirty = true;\r\n            this.dirty = true;\r\n        }\r\n        if (this.connection != undefined) {\r\n            var pos = this.connection.getPos();\r\n            if (this.set) {\r\n                this.curve.c2.x += pos.x - this.curve.p2.x;\r\n                this.curve.c2.y += pos.y - this.curve.p2.y;\r\n            } else {\r\n                var dir = this.connection.getDir();\r\n                var c = dir.scale(DEFAULT_SIZE).add(pos);\r\n                this.curve.c2.x = c.x;\r\n                this.curve.c2.y = c.y;\r\n            }\r\n            this.curve.p2.x = pos.x;\r\n            this.curve.p2.y = pos.y;\r\n            this.curve.dirty = true;\r\n            this.dirty = true;\r\n        }\r\n    }\r\n    connect(obj) {\r\n        if (this.connection != undefined || obj.input != undefined)\r\n            return false;\r\n\r\n        this.connection = obj;\r\n        obj.input = this;\r\n        this.onTransformChange();\r\n        obj.activate(this.isOn);\r\n\r\n        return true;\r\n    }\r\n    disconnect() {\r\n        if (this.connection == undefined)\r\n            return false;\r\n\r\n        this.connection.input = undefined;\r\n        this.connection.activate(false);\r\n        this.connection = undefined;\r\n    }\r\n    draw() {\r\n        var renderer = this.context.getRenderer();\r\n        var camera = this.context.getCamera();\r\n\r\n        var color = (this.isOn ? '#3cacf2' : (this.selected ? '#1cff3e' : DEFAULT_FILL_COLOR));\r\n        if (this.straight) {\r\n            var p1 = camera.getScreenPos(this.curve.p1);\r\n            var p2 = camera.getScreenPos(this.curve.p2);\r\n            renderer.line(p1.x, p1.y, p2.x, p2.y, color, 7 / camera.zoom);\r\n        } else {\r\n            this.curve.draw(color, 7 / camera.zoom, renderer);\r\n        }\r\n    }\r\n    remove() {\r\n        this.context.remove(this);\r\n        if (this.input != undefined)\r\n            this.input.disconnect(this);\r\n        if (this.connection != undefined)\r\n            this.disconnect(this.connection);\r\n    }\r\n    contains(pos) {\r\n        return this.curve.getNearestT(pos.x, pos.y) !== -1;\r\n    }\r\n    setName(n) {\r\n    }\r\n    setPos() {\r\n    }\r\n    getPos(t) {\r\n        if (t == undefined)\r\n            t = 0.5;\r\n        return this.curve.getPos(t);\r\n    }\r\n    getNearestT(mx, my) {\r\n        return (this.straight) ? (getNearestT(this.curve.p1, this.curve.p2, mx, my)) : (this.curve.getNearestT(mx, my));\r\n    }\r\n    getCullBox() {\r\n        return (this.straight) ? (this.getBoundingBox()) : (this.curve.getBoundingBox());\r\n    }\r\n    getBoundingBox() {\r\n        if (!this.straight)\r\n            return undefined;\r\n\r\n        this.updateBoundingBox();\r\n        return this.boundingBox;\r\n    }\r\n    getInputAmount() {\r\n        return 1;\r\n    }\r\n    getMaxInputFieldCount() {\r\n        return 1;\r\n    }\r\n    getMinInputFieldCount() {\r\n        return 1;\r\n    }\r\n    getName() {\r\n        return this.getDisplayName();\r\n    }\r\n    getDisplayName() {\r\n        return \"Wire\";\r\n    }\r\n    copy() {\r\n        var copy = new Wire(this.context);\r\n        copy.curve = this.curve.copy();\r\n        copy.straight = this.straight;\r\n        return copy;\r\n    }\r\n    writeTo(node, objects, wires) {\r\n        var wireNode = createChildNode(node, \"wire\");\r\n\r\n        createTextElement(wireNode, \"uid\", this.uid);\r\n\r\n        var inputNode = createChildNode(wireNode, \"input\");\r\n        createTextElement(inputNode, \"uid\", this.input.uid);\r\n        createTextElement(inputNode, \"index\", this.input.getIndex());\r\n\r\n        var connectionNode = createChildNode(wireNode, \"connection\");\r\n        createTextElement(connectionNode, \"uid\", this.connection.uid);\r\n        createTextElement(connectionNode, \"index\", this.connection.getIndex());\r\n\r\n        this.curve.writeTo(wireNode);\r\n\r\n        createTextElement(wireNode, \"straight\", this.straight);\r\n    }\r\n    load(node) {\r\n        var objects = this.context.getObjects();\r\n        var wires = this.context.getWires();\r\n\r\n        var uid = getIntValue(getChildNode(node, \"uid\"));\r\n        this.uid = uid;\r\n\r\n        var bezier = getChildNode(node, \"bezier\");\r\n        this.curve.load(bezier);\r\n\r\n        var straight = getBooleanValue(getChildNode(node, \"straight\"));\r\n        this.straight = straight;\r\n\r\n        return this;\r\n    }\r\n    loadConnections(node, objects) {\r\n        var inputNode = getChildNode(node, \"input\");\r\n        var sourceUID = getIntValue(getChildNode(inputNode, \"uid\"));\r\n        var sourceIndx = getIntValue(getChildNode(inputNode, \"index\"));\r\n        var source = findByUID(objects, sourceUID);\r\n        source = (source instanceof WirePort ? source : source.outputs[sourceIndx]);\r\n\r\n        var connectionNode = getChildNode(node, \"connection\");\r\n        var targetUID = getIntValue(getChildNode(connectionNode, \"uid\"));\r\n        var targetIndx = getIntValue(getChildNode(connectionNode, \"index\"));\r\n        var target = findByUID(objects, targetUID);\r\n        console.log(targetUID);\r\n        console.log(targetIndx);\r\n        console.log(target);\r\n        target = (target instanceof WirePort ? target : target.inputs[targetIndx]);\r\n\r\n        source.connect(this);\r\n        this.connect(target);\r\n    }\r\n}\r\n","class WirePort extends IOObject {\r\n    constructor(context) {\r\n        super(context, 0, 0, 2*IO_PORT_RADIUS, 2*IO_PORT_RADIUS);\r\n        this._input = undefined;\r\n        this.connection = undefined;\r\n        this.isOn = false;\r\n        this.selected = false;\r\n        this.hasSetTransform = false;\r\n    }\r\n    set input(input) {\r\n        this._input = input;\r\n        if (!this.hasSetTransform) {\r\n            this.hasSetTransform = true;\r\n            this.transform = new Transform(input.curve.p2.copy(), V(15,15), 0, this.context.getCamera());\r\n        }\r\n    }\r\n    get input() {\r\n        return this._input;\r\n    }\r\n    activate(on) {\r\n        if (this.isOn === on)\r\n            return;\r\n\r\n        this.isOn = on;\r\n        if (this.connection != undefined)\r\n            this.connection.activate(on);\r\n    }\r\n    remove() {\r\n        this.context.remove(this);\r\n        if (this.input != undefined)\r\n            this.input.disconnect(this);\r\n        if (this.connection != undefined)\r\n            this.disconnect(this.connection);\r\n    }\r\n    setTransform(t) {\r\n        this.transform = t;\r\n        this.setPos(t.pos);\r\n    }\r\n    onTransformChange() {\r\n        if (this.input != undefined)\r\n            this.input.onTransformChange();\r\n        if (this.connection != undefined)\r\n            this.connection.onTransformChange();\r\n    }\r\n    connect(wire) {\r\n        if (this.connection != undefined)\r\n            return false;\r\n\r\n        this.connection = wire;\r\n        wire.input = this;\r\n        wire.onTransformChange();\r\n        wire.activate(this.isOn);\r\n\r\n        return true;\r\n    }\r\n    disconnect() {\r\n        if (this.connection == undefined)\r\n            return;\r\n\r\n        this.connection.input = undefined;\r\n        this.connection = undefined;\r\n    }\r\n    draw() {\r\n        var renderer = this.context.getRenderer();\r\n        var camera = this.context.getCamera();\r\n\r\n        var v = camera.getScreenPos(this.getPos());\r\n        renderer.circle(v.x, v.y, 7 / camera.zoom, (this.selected ? '#1cff3e' : '#ffffff'), (this.selected ? '#0d7f1f' : '#000000'), 1 / camera.zoom);\r\n    }\r\n    contains(pos) {\r\n        return circleContains(this.transform, pos);\r\n    }\r\n    sContains(pos) {\r\n        return this.contains(pos);\r\n    }\r\n    setPos(v) {\r\n        if (this.input != undefined && this.connection != undefined) {\r\n            // Snap to end points of wires\r\n            this.input.straight = false;\r\n            this.connection.straight = false;\r\n            v.x = snap(this.input, v.x, this.input.curve.p1.x);\r\n            v.y = snap(this.input, v.y, this.input.curve.p1.y);\r\n            v.x = snap(this.connection, v.x, this.connection.curve.p2.x);\r\n            v.y = snap(this.connection, v.y, this.connection.curve.p2.y);\r\n        }\r\n\r\n        super.setPos(v);\r\n    }\r\n    getIndex() {\r\n        return 0;\r\n    }\r\n    getDir() {\r\n        return this.transform.getMatrix().mul(V(-1, 0)).sub(this.transform.pos).normalize();\r\n    }\r\n    getODir() {\r\n        return this.transform.getMatrix().mul(V(1, 0)).sub(this.transform.pos).normalize();\r\n    }\r\n    getCullBox() {\r\n        return this.transform;\r\n    }\r\n    getInputAmount() {\r\n        return 1;\r\n    }\r\n    getName() {\r\n        return this.getDisplayName();\r\n    }\r\n    getDisplayName() {\r\n        return \"Port\";\r\n    }\r\n}\r\nWirePort.getXMLName = function() { return \"port\"; }\r\n// Importer.types.push(WirePort);\r\n\r\nfunction snap(wire, x, c) {\r\n    if (Math.abs(x - c) <= WIRE_SNAP_THRESHOLD) {\r\n        wire.straight = true;\r\n        return c;\r\n    }\r\n    return x;\r\n}\r\n","class BusButtonModule extends Module {\r\n    constructor(parent, divName) {\r\n        super(parent, divName);\r\n    }\r\n    onShow() {\r\n        var iports = 0, oports = 0;\r\n        var selections = selectionTool.selections;\r\n        for (var i = 0; i < selections.length; i++) {\r\n            if (selections[i] instanceof IPort) {\r\n                iports++;\r\n            } else if (selections[i] instanceof OPort) {\r\n                oports++;\r\n            } else {\r\n                this.setVisibility(\"none\");\r\n                return;\r\n            }\r\n        }\r\n        this.setVisibility(iports === oports ? \"inherit\" : \"none\");\r\n    }\r\n    onClick() {\r\n        this.createBus();\r\n    }\r\n    createBus() {\r\n        var selections = selectionTool.selections;\r\n        \r\n        var iports = [], oports = [];\r\n        for (var i = 0; i < selections.length; i++) {\r\n            if (selections[i] instanceof IPort)\r\n                iports.push(selections[i]);\r\n            else\r\n                oports.push(selections[i]);\r\n        }\r\n\r\n        while (oports.length > 0) {\r\n            var maxDist = -Infinity, maxDistIndex = -1, maxMinDistIndex = -1;\r\n            for (var i = 0; i < oports.length; i++) {\r\n                var oport = oports[i];\r\n                var opos = oport.getPos();\r\n                var minDist = Infinity, minDistIndex = -1;\r\n                for (var j = 0; j < iports.length; j++) {\r\n                    var iport = iports[j];\r\n                    var dist = opos.sub(iport.getPos()).len2();\r\n                    if (dist < minDist) {\r\n                        minDist = dist;\r\n                        minDistIndex = j;\r\n                    }\r\n                }\r\n                if (minDist > maxDist) {\r\n                    maxDist = minDist;\r\n                    maxDistIndex = i;\r\n                    maxMinDistIndex = minDistIndex;\r\n                }\r\n            }\r\n            var wire = new Wire(context);\r\n            getCurrentContext().add(wire);\r\n            oports[maxDistIndex].connect(wire);\r\n            wire.connect(iports[maxMinDistIndex]);\r\n            wire.set = true;\r\n            wire.straight = true;\r\n            oports.splice(maxDistIndex, 1);\r\n            iports.splice(maxMinDistIndex, 1);\r\n        }\r\n        render();\r\n    }\r\n}\r\n","class ColorPickerModule extends Module {\r\n    constructor(parent, divName, divTextName) {\r\n        super(parent, divName, divTextName);\r\n    }\r\n    onShow() {\r\n        var allLEDs = true, allSame = true;\r\n        var selections = selectionTool.selections;\r\n        for (var i = 0; i < selections.length; i++) {\r\n            allLEDs = allLEDs && selections[i] instanceof LED;\r\n            if (allLEDs)\r\n                allSame = allSame && selections[i].color === selections[0].color;\r\n        }\r\n        this.setVisibility(allLEDs ? \"inherit\" : \"none\");\r\n        this.setValue(allLEDs && allSame ? selections[0].color : '#ffffff');\r\n    }\r\n    onChange() {\r\n        var selections = selectionTool.selections;\r\n        for (var i = 0; i < selections.length; i++)\r\n            selections[i].color = this.getValue();\r\n    }\r\n    onFocus() {\r\n        this.parent.focused = true;\r\n    }\r\n    onBlur() {\r\n        this.parent.focused = false;\r\n        this.onChange();\r\n    }\r\n}\r\n","class ICButtonModule extends Module {\r\n    constructor(parent, divName) {\r\n        super(parent, divName);\r\n    }\r\n    onShow() {\r\n        var count = 0;\r\n        var selections = selectionTool.selections;\r\n        for (var i = 0; i < selections.length; i++) {\r\n            if (selections[i] instanceof IOObject && !(selections[i] instanceof WirePort))\r\n                count++;\r\n        }\r\n        this.setVisibility(count >= 2 ? \"inherit\" : \"none\");\r\n    }\r\n    onClick() {\r\n        icdesigner.show(selectionTool.selections);\r\n    }\r\n}\r\n","class InputCountModule extends Module {\r\n    constructor(parent, divName, divTextName) {\r\n        super(parent, divName, divTextName);\r\n    }\r\n    onShow() {\r\n        var allSame = true, display = true;\r\n        var maxMinValue = 0;\r\n        var minMaxValue = 999;\r\n        var selections = selectionTool.selections;\r\n        for (var i = 0; i < selections.length; i++) {\r\n            display = display && (selections[i].maxInputs > 1 && selections[i].noChange !== true);\r\n            allSame = allSame && selections[i].getInputAmount() === selections[0].getInputAmount();\r\n            maxMinValue = Math.max(selections[i].getMinInputFieldCount(), maxMinValue);\r\n            minMaxValue = Math.min(selections[i].getMaxInputFieldCount(), minMaxValue);\r\n        }\r\n        this.setValue(allSame ? selections[0].getInputAmount() : \"\");\r\n        this.setPlaceholder(allSame ? \"\" : \"-\");\r\n        this.setVisibility(display ? \"inherit\" : \"none\");\r\n        this.div.min = maxMinValue;\r\n        this.div.max = minMaxValue;\r\n    }\r\n    onChange() {\r\n        var selections = selectionTool.selections;\r\n        for (var i = 0; i < selections.length; i++)\r\n            selections[i].setInputAmount(Number(this.getValue()));\r\n    }\r\n}\r\n","class PositionXModule extends Module {\r\n    constructor(parent, divName) {\r\n        super(parent, divName);\r\n    }\r\n    onShow() {\r\n        var allSame = true;\r\n        var selections = selectionTool.selections;\r\n        for (var i = 0; i < selections.length; i++)\r\n            allSame = allSame && selections[i].getPos().x === selections[0].getPos().x;\r\n        this.setValue(allSame ? +(selections[0].getPos().x/GRID_SIZE - 0.5).toFixed(3) : \"\");\r\n        this.setPlaceholder(allSame ? \"\" : \"-\");\r\n    }\r\n    onChange() {\r\n        var action = new GroupAction();\r\n        var selections = selectionTool.selections;\r\n        for (var i = 0; i < selections.length; i++) {\r\n            if (!selections[i].transform) {\r\n                this.onShow(); // Update value before exiting\r\n                return;\r\n            }\r\n            var origin = selections[i].transform.copy();\r\n            selections[i].setPos(V(GRID_SIZE*(Number(this.getValue())+0.5), selections[i].transform.getPos().y));\r\n            var target = selections[i].transform.copy();\r\n            action.add(new TransformAction(selections[i], origin, target));\r\n        }\r\n        getCurrentContext().addAction(action);\r\n    }\r\n}\r\n","class PositionYModule extends Module {\r\n    constructor(parent, divName) {\r\n        super(parent, divName);\r\n    }\r\n    onShow() {\r\n        var allSame = true;\r\n        var selections = selectionTool.selections;\r\n        for (var i = 0; i < selections.length; i++)\r\n            allSame = allSame && selections[i].getPos().y === selections[0].getPos().y;\r\n        this.setValue(allSame ? +(selections[0].getPos().y/GRID_SIZE - 0.5).toFixed(3) : \"\");\r\n        this.setPlaceholder(allSame ? \"\" : \"-\");\r\n    }\r\n    onChange() {\r\n        var action = new GroupAction();\r\n        var selections = selectionTool.selections;\r\n        for (var i = 0; i < selections.length; i++) {\r\n            if (!selections[i].transform) {\r\n                this.onShow(); // Update value before exiting\r\n                return;\r\n            }\r\n            var origin = selections[i].transform.copy();\r\n            selections[i].setPos(V(selections[i].transform.getPos().x, GRID_SIZE*(Number(this.getValue())+0.5)));\r\n            var target = selections[i].transform.copy();\r\n            action.add(new TransformAction(selections[i], origin, target));\r\n        }\r\n        getCurrentContext().addAction(action);\r\n    }\r\n}\r\n","class SelectionPopup extends Popup {\r\n    constructor() {\r\n        super(\"popup\");\r\n\r\n        this.add(new TitleModule(this, \"popup-name\"));\r\n\r\n        this.add(new PositionXModule(this, \"popup-position-x\"));\r\n        this.add(new PositionYModule(this, \"popup-position-y\"));\r\n\r\n        this.add(new InputCountModule(this, \"popup-input-count\", \"popup-input-count-text\"));\r\n\r\n        this.add(new ColorPickerModule(this, \"popup-color-picker\", \"popup-color-text\"));\r\n\r\n        this.add(new ICButtonModule(this, \"popup-ic-button\"));\r\n        this.add(new BusButtonModule(this, \"popup-bus-button\"));\r\n    }\r\n    onKeyDown(code) {\r\n        if ((code === DELETE_KEY || code === BACKSPACE_KEY) && !this.focused) {\r\n            RemoveObjects(getCurrentContext(), selectionTool.selections, true);\r\n            return;\r\n        }\r\n        if (code === ESC_KEY && !this.hidden) {\r\n            selectionTool.deselectAll();\r\n            render();\r\n            return;\r\n        }\r\n    }\r\n    onEnter() {\r\n        this.blur();\r\n    }\r\n    update() {\r\n        var selections = selectionTool.selections;\r\n        if (selections.length > 0) {\r\n            this.show();\r\n            this.onMove();\r\n        } else {\r\n            this.hide();\r\n        }\r\n    }\r\n    onMove() {\r\n        var camera = getCurrentContext().getCamera();\r\n        if (selectionTool.selections.length > 0) {\r\n            selectionTool.recalculateMidpoint();\r\n            var pos = camera.getScreenPos(selectionTool.midpoint);\r\n            pos.y -= this.div.clientHeight/2;\r\n            this.setPos(pos);\r\n        }\r\n    }\r\n    onWheel() {\r\n        this.onMove();\r\n    }\r\n}\r\n","class TitleModule extends Module {\r\n    constructor(parent, divName) {\r\n        super(parent, divName);\r\n    }\r\n    onShow() {\r\n        var allSame = true;\r\n        var selections = selectionTool.selections;\r\n        for (var i = 0; i < selections.length; i++)\r\n            allSame = allSame && selections[i].getName() === selections[0].getName();\r\n        this.setValue(allSame ? selections[0].getName() : \"<Multiple>\");\r\n    }\r\n    onChange() {\r\n        var selections = selectionTool.selections;\r\n        for (var i = 0; i < selections.length; i++)\r\n            selections[i].setName(this.getValue());\r\n    }\r\n    onFocus() {\r\n        this.parent.focused = true;\r\n    }\r\n    onBlur() {\r\n        this.parent.focused = false;\r\n        this.onChange();\r\n    }\r\n}\r\n","class ContextMenu extends Popup {\r\n    constructor() {\r\n        super(\"context-menu\");\r\n\r\n        this.add(new CutModule(this, \"context-menu-cut\"));\r\n        this.add(new CopyModule(this, \"context-menu-copy\"));\r\n        this.add(new PasteModule(this, \"context-menu-paste\"));\r\n        this.add(new SelectAllModule(this, \"context-menu-select-all\"))\r\n\r\n        this.add(new UndoModule(this, \"context-menu-undo\"));\r\n        this.add(new RedoModule(this, \"context-menu-redo\"))\r\n    }\r\n    onKeyDown(code) {\r\n        if (code === ESC_KEY && !this.hidden) {\r\n            this.hide();\r\n            return;\r\n        }\r\n    }\r\n    onShow() {\r\n        super.onShow();\r\n\r\n        var pos = Input.getRawMousePos();\r\n        this.setPos(V(pos.x, pos.y));\r\n    }\r\n}\r\n","class CopyModule extends Module {\r\n    constructor(parent, divName) {\r\n        super(parent, divName);\r\n    }\r\n    onShow() {\r\n        this.setDisabled(selectionTool.selections.length == 0);\r\n    }\r\n    onClick() {\r\n        this.parent.hide();\r\n        document.execCommand(\"copy\");\r\n    }\r\n}\r\n","class CutModule extends Module {\r\n    constructor(parent, divName) {\r\n        super(parent, divName);\r\n    }\r\n    onShow() {\r\n        this.setDisabled(selectionTool.selections.length == 0);\r\n    }\r\n    onClick() {\r\n        this.parent.hide();\r\n        document.execCommand(\"cut\");\r\n    }\r\n}\r\n","class PasteModule extends Module {\r\n    constructor(parent, divName) {\r\n        super(parent, divName);\r\n    }\r\n    onShow() {\r\n        this.setDisabled(false);\r\n    }\r\n    onClick() {\r\n        this.parent.hide();\r\n        document.execCommand(\"copy\");\r\n    }\r\n}\r\n","class RedoModule extends Module {\r\n    constructor(parent, divName) {\r\n        super(parent, divName);\r\n    }\r\n    onShow() {\r\n        this.setDisabled(getCurrentContext().designer.history.redoStack.length == 0);\r\n    }\r\n    onClick() {\r\n        this.parent.hide();\r\n        getCurrentContext().designer.history.redo();\r\n    }\r\n}\r\n","class SelectAllModule extends Module {\r\n    constructor(parent, divName) {\r\n        super(parent, divName);\r\n    }\r\n    onShow() {\r\n        this.setDisabled(false);\r\n    }\r\n    onClick() {\r\n        this.parent.hide();\r\n        selectionTool.selectAll();\r\n        render();\r\n    }\r\n}\r\n","class UndoModule extends Module {\r\n    constructor(parent, divName) {\r\n        super(parent, divName);\r\n    }\r\n    onShow() {\r\n        this.setDisabled(getCurrentContext().designer.history.undoStack.length == 0);\r\n    }\r\n    onClick() {\r\n        this.parent.hide();\r\n        getCurrentContext().designer.history.undo();\r\n    }\r\n}\r\n","class ItemTool extends Tool {\r\n    constructor() {\r\n        super();\r\n        this.item = undefined;\r\n    }\r\n    activate(object, context) {\r\n        // If already active, remove current item\r\n        if (this.item != undefined)\r\n            context.remove(this.item);\r\n\r\n        super.activate();\r\n        this.item = object;\r\n        context.addObject(this.item);\r\n        this.onMouseMove();\r\n    }\r\n    deactivate() {\r\n        super.deactivate();\r\n        this.item = undefined;\r\n    }\r\n    onMouseMove() {\r\n        this.item.setPos(Input.getWorldMousePos());\r\n        return true;\r\n    }\r\n    onClick() {\r\n        this.item.setPos(Input.getWorldMousePos());\r\n        var action = new PlaceAction(this.item);\r\n        getCurrentContext().addAction(action);\r\n        selectionTool.activate();\r\n        return true;\r\n    }\r\n}\r\nvar itemTool = new ItemTool();\r\n","class SelectionTool extends Tool {\r\n    constructor() {\r\n        super();\r\n        this.selections = [];\r\n        this.midpoint = V(0, 0);\r\n    }\r\n    onKeyDown(code, input) {\r\n        console.log(code);\r\n        if (!icdesigner.hidden)\r\n            return false;\r\n\r\n        if (code === A_KEY && Input.getModifierKeyDown()) {\r\n            this.selectAll();\r\n            return true;\r\n        }\r\n    }\r\n    onMouseDown() {\r\n        var objects = getCurrentContext().getObjects();\r\n        var wires = getCurrentContext().getWires();\r\n        var worldMousePos = Input.getWorldMousePos();\r\n\r\n        if (!icdesigner.hidden)\r\n            return false;\r\n\r\n        // Go through objects backwards since objects on top are in the back\r\n        for (var i = objects.length-1; i >= 0; i--) {\r\n            var obj = objects[i];\r\n\r\n            // Check if object was pressed\r\n            if (obj.contains(worldMousePos)) {\r\n                if (obj.isPressable)\r\n                    obj.press();\r\n                return true;\r\n            }\r\n\r\n            // Ignore if object's selection box was pressed\r\n            if (obj.sContains(worldMousePos))\r\n                return;\r\n\r\n            // Ignore if a port was pressed\r\n            if (obj.oPortContains(worldMousePos) !== -1 ||\r\n                    obj.iPortContains(worldMousePos) !== -1) {\r\n                return;\r\n            }\r\n        }\r\n    }\r\n    onMouseMove() {}\r\n    onMouseUp() {\r\n        var objects = getCurrentContext().getObjects();\r\n        var wires = getCurrentContext().getWires();\r\n        var worldMousePos = Input.getWorldMousePos();\r\n\r\n        if (!icdesigner.hidden)\r\n            return false;\r\n\r\n        popup.update();\r\n\r\n        for (var i = 0; i < objects.length; i++) {\r\n            var obj = objects[i];\r\n\r\n            // Release pressed object\r\n            if (obj.isPressable && obj.isOn && !Input.isDragging) {\r\n                obj.release();\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    onClick() {\r\n        var objects = getCurrentContext().getObjects();\r\n        var wires = getCurrentContext().getWires();\r\n        var worldMousePos = Input.getWorldMousePos();\r\n\r\n        if (!icdesigner.hidden || Input.getIsDragging())\r\n            return false;\r\n\r\n        // Go through objects backwards since objects on top are in the back\r\n        for (var i = objects.length-1; i >= 0; i--) {\r\n            var obj = objects[i];\r\n\r\n            // Check if object's selection box was clicked\r\n            if (obj.sContains(worldMousePos)) {\r\n                if (obj.selected)\r\n                    return false;\r\n\r\n                if (!Input.getShiftKeyDown() && this.selections.length > 0) {\r\n                    this.deselectAll(true);\r\n\r\n                    // Combine deselect and select actions\r\n                    var deselectAction = getCurrentContext().designer.history.undoStack.pop();\r\n                    this.select([obj], true);\r\n                    var selectAction = getCurrentContext().designer.history.undoStack.pop();\r\n                    var combined = new GroupAction();\r\n                    if (deselectAction != undefined)\r\n                        combined.add(deselectAction);\r\n                    combined.add(selectAction);\r\n                    getCurrentContext().addAction(combined);\r\n                } else {\r\n                    this.select([obj], true);\r\n                }\r\n\r\n                return true;\r\n            }\r\n\r\n            // Check if object was clicked\r\n            if (obj.contains(worldMousePos)) {\r\n                obj.click();\r\n                return true;\r\n            }\r\n        }\r\n\r\n        // Didn't click on anything so deselect everything\r\n        // And add a deselect action\r\n        if (!Input.getShiftKeyDown() && this.selections.length > 0) {\r\n            this.deselectAll(true);\r\n            return true;\r\n        }\r\n    }\r\n    select(objects, doAction) {\r\n        if (objects.length === 0)\r\n            return;\r\n\r\n        var action = new GroupAction();\r\n        for (var i = 0; i < objects.length; i++) {\r\n            var obj = objects[i];\r\n            if (obj.selected)\r\n                continue;\r\n            obj.selected = true;\r\n            this.selections.push(obj);\r\n            this.sendToFront(obj);\r\n            if (doAction)\r\n                action.add(new SelectAction(obj));\r\n        }\r\n        if (doAction)\r\n            getCurrentContext().addAction(action);\r\n        popup.update();\r\n        this.recalculateMidpoint();\r\n    }\r\n    deselect(objects, doAction) {\r\n        if (objects.length === 0)\r\n            return;\r\n\r\n        var action = new GroupAction();\r\n        for (var i = 0; i < objects.length; i++) {\r\n            var obj = objects[i];\r\n            if (!obj.selected) {\r\n                console.error(\"Can't deselect an unselected object! \" + obj);\r\n                continue;\r\n            }\r\n            obj.selected = false;\r\n            this.selections.splice(this.selections.indexOf(obj), 1);\r\n            if (doAction)\r\n                action.add(new SelectAction(obj, true));\r\n        }\r\n        if (doAction)\r\n            getCurrentContext().addAction(action);\r\n        popup.update();\r\n        this.recalculateMidpoint();\r\n    }\r\n    selectAll() {\r\n        this.deselectAll(true);\r\n        this.select(getCurrentContext().getObjects(), true);\r\n    }\r\n    deselectAll(doAction) {\r\n        // Copy selections array because just passing selections\r\n        // causes it to get mutated mid-loop at causes weirdness\r\n        var objects = [];\r\n        for (var i = 0; i < this.selections.length; i++)\r\n            objects.push(this.selections[i]);\r\n        this.deselect(objects, doAction);\r\n    }\r\n    sendToFront(obj) {\r\n        if (obj instanceof IOObject || obj instanceof Wire) {\r\n            getCurrentContext().remove(obj);\r\n            getCurrentContext().add(obj);\r\n        }\r\n    }\r\n    recalculateMidpoint() {\r\n        this.midpoint = V(0, 0);\r\n        for (var i = 0; i < this.selections.length; i++)\r\n            this.midpoint.translate(this.selections[i].getPos());\r\n        this.midpoint = this.midpoint.scale(1. / this.selections.length);\r\n    }\r\n    draw(renderer) {\r\n        var camera = renderer.getCamera();\r\n        if (this.selections.length > 0 && !this.drag) {\r\n            var pos = camera.getScreenPos(this.midpoint);\r\n            var r = ROTATION_CIRCLE_RADIUS / camera.zoom;\r\n            var br = ROTATION_CIRCLE_THICKNESS / camera.zoom;\r\n            TransformController.draw(renderer);\r\n            renderer.circle(pos.x, pos.y, r, undefined, '#ff0000', br, 0.5);\r\n        }\r\n        SelectionBox.draw(renderer);\r\n    }\r\n}\r\nvar selectionTool = new SelectionTool();\r\n","class WiringTool extends Tool {\r\n    constructor() {\r\n        super();\r\n\r\n        this.clickOPort = false;\r\n        this.wire = undefined;\r\n    }\r\n    onKeyUp(code, input) {\r\n        if (code === ESC_KEY)  {\r\n            this.removeWire();\r\n            selectionTool.activate();\r\n            render();\r\n        }\r\n    }\r\n    activate(object, context) {\r\n        super.activate();\r\n        \r\n        console.log(object);\r\n\r\n        this.wire = new Wire(context);\r\n        this.clickOPort = (object instanceof OPort);\r\n        var success;\r\n        if (this.clickOPort)\r\n            success = object.connect(this.wire);\r\n        else\r\n            success = this.wire.connect(object);\r\n        if (success) {\r\n            this.onMouseMove();\r\n            context.addWire(this.wire);\r\n        } else { // Illegal connection (ex. two inputs to IPort)\r\n            selectionTool.activate();\r\n        }\r\n    }\r\n    deactivate() {\r\n        super.deactivate();\r\n\r\n        this.wire = undefined;\r\n    }\r\n    removeWire() {\r\n        getCurrentContext().remove(this.wire);\r\n        if (this.clickOPort)\r\n            this.wire.input.disconnect(this.wire);\r\n        else\r\n            this.wire.disconnect();\r\n    }\r\n    onMouseMove() {\r\n        if (this.clickOPort)\r\n            this.wire.curve.update(this.wire.curve.p1, Input.getWorldMousePos(), this.wire.curve.c1, Input.getWorldMousePos());\r\n        else\r\n            this.wire.curve.update(Input.getWorldMousePos(), this.wire.curve.p2, Input.getWorldMousePos(), this.wire.curve.c2);\r\n        return true;\r\n    }\r\n    onClick() {\r\n        var objects = getCurrentContext().getObjects();\r\n        var worldMousePos = Input.getWorldMousePos();\r\n\r\n        for (var i = 0; i < objects.length; i++) {\r\n            var ii = -1;\r\n            if (this.clickOPort && (ii = objects[i].iPortContains(worldMousePos)) !== -1) {\r\n                if (!this.wire.connect(objects[i].inputs[ii]))\r\n                    this.removeWire();\r\n            }\r\n            if (!this.clickOPort && (ii = objects[i].oPortContains(worldMousePos)) !== -1) {\r\n                if (!objects[i].outputs[ii].connect(this.wire))\r\n                    this.removeWire();\r\n            }\r\n            if (ii !== -1) {\r\n                var action = new PlaceWireAction(this.wire);\r\n                getCurrentContext().addAction(action);\r\n\r\n                selectionTool.activate();\r\n                return true;\r\n            }\r\n         }\r\n\r\n        this.removeWire();\r\n        selectionTool.activate();\r\n        return true;\r\n    }\r\n}\r\nvar wiringTool = new WiringTool();","class Action {\r\n    constructor() {\r\n        this.context = getCurrentContext();\r\n        // Anytime an action is performed, user should need to save\r\n        saved = false;\r\n    }\r\n    undo() {\r\n    }\r\n    redo() {\r\n    }\r\n}\r\n","class DeleteAction extends Action {\r\n    constructor(obj, oldinput, oldconnection) {\r\n        super();\r\n        this.obj = obj;\r\n        this.oldinput = oldinput;\r\n        this.oldconnection = oldconnection;\r\n    }\r\n    undo() {\r\n        this.context.add(this.obj);\r\n        if (this.oldinput != undefined)\r\n            this.oldinput.connect(this.obj);\r\n        if (this.oldconnection != undefined)\r\n            this.obj.connect(this.oldconnection);\r\n    }\r\n    redo() {\r\n        this.obj.remove();\r\n    }\r\n}\r\n","class GroupAction extends Action {\r\n    constructor() {\r\n        super();\r\n        this.actions = [];\r\n    }\r\n    add(action) {\r\n        this.actions.push(action);\r\n    }\r\n    undo() {\r\n        for (var i = this.actions.length-1; i >= 0; i--)\r\n            this.actions[i].undo();\r\n    }\r\n    redo() {\r\n        for (var i = 0; i < this.actions.length; i++)\r\n            this.actions[i].redo();\r\n    }\r\n}\r\n","class PlaceAction extends Action {\r\n    constructor(obj) {\r\n        super();\r\n        this.obj = obj;\r\n    }\r\n    undo() {\r\n        this.context.remove(this.obj);\r\n    }\r\n    redo() {\r\n        this.context.addObject(this.obj);\r\n    }\r\n}\r\n","class PlaceWireAction extends Action {\r\n    constructor(wire) {\r\n        super();\r\n        this.wire = wire;\r\n        this.input = this.wire.input;\r\n        this.connection = this.wire.connection;\r\n    }\r\n    undo() {\r\n        this.context.remove(this.wire);\r\n        this.wire.disconnect();\r\n        this.wire.input.disconnect(this.wire);\r\n    }\r\n    redo() {\r\n        this.context.add(this.wire);\r\n        this.wire.connect(this.connection);\r\n        this.input.connect(this.wire);\r\n    }\r\n}\r\n","class SelectAction extends Action {\r\n    constructor(obj, flip) {\r\n        super();\r\n        this.obj = obj;\r\n        this.flip = flip;\r\n    }\r\n    undo() {\r\n        if (this.flip)\r\n            this.reselect();\r\n        else\r\n            this.deselect();\r\n    }\r\n    redo() {\r\n        if (this.flip)\r\n            this.deselect();\r\n        else\r\n            this.reselect();\r\n    }\r\n    reselect() {\r\n        selectionTool.select([this.obj]);\r\n    }\r\n    deselect() {\r\n        selectionTool.deselect([this.obj]);\r\n    }\r\n}\r\n","class SplitWireAction extends Action {\r\n    constructor(wire) {\r\n        super();\r\n        this.wireport = wire.connection;\r\n        this.wire = wire;\r\n        this.newwire = this.wireport.connection;\r\n        this.connection = this.newwire.connection;\r\n    }\r\n    undo() {\r\n        this.context.remove(this.wireport);\r\n        this.context.remove(this.newwire);\r\n        \r\n        this.wire.disconnect();\r\n        this.newwire.disconnect();\r\n        \r\n        this.wire.connect(this.connection);\r\n    }\r\n    redo() {\r\n        this.context.add(this.wireport);\r\n        this.context.add(this.newwire);\r\n        \r\n        this.wire.disconnect();\r\n        \r\n        this.wire.connect(this.wireport);\r\n        this.newwire.connect(this.connection);\r\n    }\r\n}\r\n","class TransformAction extends Action {\r\n    constructor(obj, t0, t1) {\r\n        super();\r\n        this.obj = obj;\r\n        this.t0 = t0;\r\n        this.t1 = t1;\r\n    }\r\n    undo() {\r\n        this.obj.setTransform(this.t0);\r\n        this.updatePopup();\r\n    }\r\n    redo() {\r\n        this.obj.setTransform(this.t1);\r\n        this.updatePopup();\r\n    }\r\n    updatePopup() {\r\n        if (this.obj.selected) {\r\n            selectionTool.recalculateMidpoint();\r\n            popup.onMove();\r\n        }\r\n    }\r\n}\r\n","class BezierCurve {\r\n    constructor(p1, p2, c1, c2) {\r\n        this.p1 = V(p1.x,p1.y);\r\n        this.p2 = V(p2.x,p2.y);\r\n        this.c1 = V(c1.x,c1.y);\r\n        this.c2 = V(c2.x,c2.y);\r\n        this.dirty = true;\r\n        this.boundingBox = new Transform(0,0,0,getCurrentContext().getCamera());\r\n    }\r\n    update(p1, p2, c1, c2) {\r\n        this.p1.x = p1.x;\r\n        this.p1.y = p1.y;\r\n        this.p2.x = p2.x;\r\n        this.p2.y = p2.y;\r\n        this.c1.x = c1.x;\r\n        this.c1.y = c1.y;\r\n        this.c2.x = c2.x;\r\n        this.c2.y = c2.y;\r\n    }\r\n    updateBoundingBox() {\r\n        if (!this.dirty)\r\n            return;\r\n        this.dirty = false;\r\n\r\n        var min = V(0, 0);\r\n        var max = V(0, 0);\r\n        var end1 = this.getPos(0);\r\n        var end2 = this.getPos(1);\r\n        var a = this.c1.sub(this.c2).scale(3).add(this.p2.sub(this.p1));\r\n        var b = this.p1.sub(this.c1.scale(2).add(this.c2)).scale(2);\r\n        var c = this.c1.sub(this.p1);\r\n\r\n        var discriminant1 = b.y*b.y - 4*a.y*c.y;\r\n        discriminant1 = (discriminant1 >= 0 ? Math.sqrt(discriminant1) : -1);\r\n        var t1 = (discriminant1 !== -1 ? clamp((-b.y + discriminant1)/(2*a.y),0,1) : 0);\r\n        var t2 = (discriminant1 !== -1 ? clamp((-b.y - discriminant1)/(2*a.y),0,1) : 0);\r\n        max.y = Math.max(this.getY(t1), this.getY(t2), end1.y, end2.y);\r\n        min.y = Math.min(this.getY(t1), this.getY(t2), end1.y, end2.y);\r\n\r\n        var discriminant2 = b.x*b.x - 4*a.x*c.x;\r\n        discriminant2 = (discriminant2 >= 0 ? Math.sqrt(discriminant2) : -1);\r\n        var t3 = (discriminant2 !== -1 ? clamp((-b.x + discriminant2)/(2*a.x),0,1) : 0);\r\n        var t4 = (discriminant2 !== -1 ? clamp((-b.x - discriminant2)/(2*a.x),0,1) : 0);\r\n        max.x = Math.max(this.getX(t1), this.getX(t2), end1.x, end2.x);\r\n        min.x = Math.min(this.getX(t1), this.getX(t2), end1.x, end2.x);\r\n\r\n        this.boundingBox.setSize(V(max.x - min.x, max.y - min.y));\r\n        this.boundingBox.setPos(V((max.x - min.x)/2 + min.x, (max.y - min.y)/2 + min.y));\r\n    }\r\n    draw(style, size, renderer) {\r\n        var camera = renderer.parent.camera;\r\n\r\n        var p1 = camera.getScreenPos(this.p1);\r\n        var p2 = camera.getScreenPos(this.p2);\r\n        var c1 = camera.getScreenPos(this.c1);\r\n        var c2 = camera.getScreenPos(this.c2);\r\n\r\n        renderer.curve(p1.x, p1.y, p2.x, p2.y, c1.x, c1.y, c2.x, c2.y, style, size);\r\n    }\r\n    getX(t) {\r\n        var it = 1 - t;\r\n        return this.p1.x*it*it*it + 3*this.c1.x*t*it*it + 3*this.c2.x*t*t*it + this.p2.x*t*t*t;\r\n    }\r\n    getY(t) {\r\n        var it = 1 - t;\r\n        return this.p1.y*it*it*it + 3*this.c1.y*t*it*it + 3*this.c2.y*t*t*it + this.p2.y*t*t*t;\r\n    }\r\n    getPos(t) {\r\n        return V(this.getX(t), this.getY(t));\r\n    }\r\n    getDX(t) {\r\n        var it = 1 - t;\r\n        return -3*this.p1.x*it*it + 3*this.c1.x*it*(1-3*t) + 3*this.c2.x*t*(2-3*t) + 3*this.p2.x*t*t;\r\n    }\r\n    getDY(t) {\r\n        var it = 1 - t;\r\n        return -3*this.p1.y*it*it + 3*this.c1.y*it*(1-3*t) + 3*this.c2.y*t*(2-3*t) + 3*this.p2.y*t*t;\r\n    }\r\n    getVel(t) {\r\n        return V(this.getDX(t), this.getDY(t));\r\n    }\r\n    getDDX(t) {\r\n        var m = -this.p1.x + 3*this.c1.x - 3*this.c2.x + this.p2.x;\r\n        var b = this.p1.x - 2*this.c1.x + this.c2.x;\r\n        return 6*(m * t + b);\r\n    }\r\n    getDDY(t) {\r\n        var m = -this.p1.y + 3*this.c1.y - 3*this.c2.y + this.p2.y;\r\n        var b = this.p1.y - 2*this.c1.y + this.c2.y;\r\n        return 6*(m * t + b);\r\n    }\r\n    getDist(t, mx, my) {\r\n        var dx = this.getX(t) - mx;\r\n        var dy = this.getY(t) - my;\r\n        return Math.sqrt(dx*dx + dy*dy);\r\n    }\r\n    getDist2(t, mx, my) {\r\n        var dx = this.getX(t) - mx;\r\n        var dy = this.getY(t) - my;\r\n        return dx*dx + dy*dy;\r\n    }\r\n    getDistDenominator(t, mx, my) {\r\n        var dx = this.getX(t) - mx;\r\n        var dy = this.getY(t) - my;\r\n        return dx*dx + dy*dy;\r\n    }\r\n    getDistDenominatorDerivative(t, mx, my) {\r\n        return  2*(this.getX(t) - mx) * this.getDX(t) +\r\n                2*(this.getY(t) - my) * this.getDY(t);\r\n    }\r\n    getDistNumerator(t, mx, my) {\r\n        var dx = this.getX(t) - mx;\r\n        var dy = this.getY(t) - my;\r\n        return  this.getDX(t)*dx +\r\n                this.getDY(t)*dy;\r\n    }\r\n    getDistNumeratorDerivative(t, mx, my) {\r\n        var dx = this.getX(t) - mx;\r\n        var dy = this.getY(t) - my;\r\n        var dbx = this.getDX(t);\r\n        var dby = this.getDY(t);\r\n        return  dbx*dbx + dx*this.getDDX(t) +\r\n                dby*dby + dy*this.getDDY(t);\r\n    }\r\n    getNearestT(mx, my) {\r\n        var minDist = 1e20;\r\n        var t0 = -1;\r\n        for (var tt = 0; tt <= 1.0; tt += 1.0 / WIRE_DIST_ITERATIONS) {\r\n            var dist = this.getDist(tt, mx, my);\r\n            if (dist < minDist) {\r\n                t0 = tt;\r\n                minDist = dist;\r\n            }\r\n        }\r\n\r\n        // Newton's method to find parameter for when slope is undefined AKA denominator function = 0\r\n        var t1 = findRoots(WIRE_NEWTON_ITERATIONS, t0, mx, my, (t,x,y)=>this.getDistDenominator(t,x,y), (t,x,y)=>this.getDistDenominatorDerivative(t,x,y));\r\n        if (this.getDist2(t1, mx, my) < WIRE_DIST_THRESHOLD2)\r\n            return t1;\r\n\r\n        // Newton's method to find parameter for when slope is 0 AKA numerator function = 0\r\n        var t2 = findRoots(WIRE_NEWTON_ITERATIONS, t0, mx, my, (t,x,y)=>this.getDistNumerator(t,x,y), (t,x,y)=>this.getDistNumeratorDerivative(t,x,y));\r\n        if (this.getDist2(t2, mx, my) < WIRE_DIST_THRESHOLD2)\r\n            return t2;\r\n\r\n        return -1;\r\n    }\r\n    getBoundingBox() {\r\n        this.updateBoundingBox();\r\n        return this.boundingBox;\r\n    }\r\n    copy() {\r\n        return new BezierCurve(this.p1.copy(), this.p2.copy(), this.c1.copy(), this.c2.copy());\r\n    }\r\n    writeTo(node) {\r\n        var bezierNode = createChildNode(node, \"bezier\");\r\n        createTextElement(bezierNode, \"p1x\", this.p1.x);\r\n        createTextElement(bezierNode, \"p1y\", this.p1.y);\r\n        createTextElement(bezierNode, \"p2x\", this.p2.x);\r\n        createTextElement(bezierNode, \"p2y\", this.p2.y);\r\n        createTextElement(bezierNode, \"c1x\", this.c1.x);\r\n        createTextElement(bezierNode, \"c1y\", this.c1.y);\r\n        createTextElement(bezierNode, \"c2x\", this.c2.x);\r\n        createTextElement(bezierNode, \"c2y\", this.c2.y);\r\n    }\r\n    load(node) {\r\n        var p1 = V(getFloatValue(getChildNode(node, \"p1x\")), getFloatValue(getChildNode(node, \"p1y\")));\r\n        var p2 = V(getFloatValue(getChildNode(node, \"p2x\")), getFloatValue(getChildNode(node, \"p2y\")));\r\n        var c1 = V(getFloatValue(getChildNode(node, \"c1x\")), getFloatValue(getChildNode(node, \"c1y\")));\r\n        var c2 = V(getFloatValue(getChildNode(node, \"c2x\")), getFloatValue(getChildNode(node, \"c2y\")));\r\n        this.update(p1, p2, c1, c2);\r\n    }\r\n}\r\n","class Matrix2x3 {\r\n    constructor(other) {\r\n        this.mat = [];\r\n        this.identity();\r\n        if (other instanceof Matrix2x3) {\r\n            for (var i = 0; i < 2*3; i++)\r\n                this.mat[i] = other.mat[i];\r\n        }\r\n    }\r\n    zero() {\r\n        for (var i = 0; i < 2*3; i++)\r\n            this.mat[i] = 0;\r\n        return this;\r\n    }\r\n    identity() {\r\n        this.zero();\r\n\r\n        this.mat[0] = 1.0;\r\n        this.mat[3] = 1.0;\r\n\r\n        return this;\r\n    }\r\n    mul(v) {\r\n        var result = V(0,0);\r\n        result.x = this.mat[0] * v.x + this.mat[2] * v.y + this.mat[4];\r\n        result.y = this.mat[1] * v.x + this.mat[3] * v.y + this.mat[5];\r\n        return result;\r\n    }\r\n    mult(m) {\r\n        var result = new Matrix2x3();\r\n        result.mat[0] = this.mat[0]*m.mat[0] + this.mat[2]*m.mat[1];\r\n        result.mat[1] = this.mat[1]*m.mat[0] + this.mat[3]*m.mat[1];\r\n        result.mat[2] = this.mat[0]*m.mat[2] + this.mat[2]*m.mat[3];\r\n        result.mat[3] = this.mat[1]*m.mat[2] + this.mat[3]*m.mat[3];\r\n        result.mat[4] = this.mat[0]*m.mat[4] + this.mat[2]*m.mat[5] + this.mat[4];\r\n        result.mat[5] = this.mat[1]*m.mat[4] + this.mat[3]*m.mat[5] + this.mat[5];\r\n        return result;\r\n    }\r\n    translate(v) {\r\n        this.mat[4] += this.mat[0] * v.x + this.mat[2] * v.y;\r\n        this.mat[5] += this.mat[1] * v.x + this.mat[3] * v.y;\r\n    }\r\n    rotate(theta) {\r\n        var c = Math.cos(theta);\r\n        var s = Math.sin(theta);\r\n        var m11 = this.mat[0] * c + this.mat[2] * s;\r\n        var m12 = this.mat[1] * c + this.mat[3] * s;\r\n        var m21 = this.mat[0] * -s + this.mat[2] * c;\r\n        var m22 = this.mat[1] * -s + this.mat[3] * c;\r\n        this.mat[0] = m11;\r\n        this.mat[1] = m12;\r\n        this.mat[2] = m21;\r\n        this.mat[3] = m22;\r\n    }\r\n    scale(s) {\r\n        this.mat[0] *= s.x;\r\n        this.mat[1] *= s.x;\r\n        this.mat[2] *= s.y;\r\n        this.mat[3] *= s.y;\r\n    }\r\n    inverse() {\r\n        var inv = new Array(3*2);\r\n        var det;\r\n\r\n        inv[0] = this.mat[3];\r\n        inv[1] = -this.mat[1];\r\n        inv[2] = -this.mat[2];\r\n        inv[3] = this.mat[0];\r\n        inv[4] = this.mat[2] * this.mat[5] -\r\n                 this.mat[4] * this.mat[3];\r\n        inv[5] = this.mat[4] * this.mat[1] -\r\n                 this.mat[0] * this.mat[5];\r\n\r\n        det = this.mat[0]*this.mat[3] - this.mat[1]*this.mat[2];\r\n\r\n        if (det == 0)\r\n            return undefined;\r\n\r\n        det = 1.0 / det;\r\n\r\n        var m = new Matrix2x3();\r\n        for (var i = 0; i < 2*3; i++)\r\n            m.mat[i] = inv[i] * det;\r\n\r\n        return m;\r\n    }\r\n    print() {\r\n        console.log(\"[\" + this.mat[0].toFixed(3) + \", \" + this.mat[2].toFixed(3) + \", \" + this.mat[4].toFixed(3) + \"]\\n\" +\r\n                    \"[\" + this.mat[1].toFixed(3) + \", \" + this.mat[3].toFixed(3) + \", \" + this.mat[5].toFixed(3) + \"]\");\r\n    }\r\n}\r\n","class Transform {\r\n    constructor(pos, size, angle, camera) {\r\n        this.parent = undefined;\r\n        this.pos = V(pos.x, pos.y);\r\n        this.size = V(size.x, size.y);\r\n        this.angle = angle;\r\n        this.scale = V(1, 1);\r\n        this.corners = [];\r\n        this.localCorners = [];\r\n        this.camera = camera;\r\n        this.dirty = true;\r\n        this.dirtySize = true;\r\n        this.dirtyCorners = true;\r\n        this.updateMatrix();\r\n    }\r\n    updateMatrix(c) {\r\n        if (!this.dirty)\r\n            return;\r\n        this.dirty = false;\r\n\r\n        this.matrix = new Matrix2x3();\r\n        this.matrix.translate(this.pos);\r\n        this.matrix.rotate(this.angle);\r\n        this.matrix.scale(this.scale);\r\n\r\n        if (this.parent != undefined)\r\n            this.matrix = this.parent.getMatrix().mult(this.matrix);\r\n\r\n        this.inverse = this.matrix.inverse();\r\n    }\r\n    updateSize() {\r\n        if (!this.dirtySize)\r\n            return;\r\n        this.dirtySize = false;\r\n\r\n        this.localCorners = [this.size.scale(V(-0.5, 0.5)), this.size.scale(V(0.5, 0.5)),\r\n                             this.size.scale(V(0.5, -0.5)), this.size.scale(V(-0.5, -0.5))];\r\n\r\n        this.radius = Math.sqrt(this.size.x*this.size.x + this.size.y*this.size.y)/2;\r\n    }\r\n    updateCorners() {\r\n        if (!this.dirtyCorners)\r\n            return;\r\n        this.dirtyCorners = false;\r\n\r\n        var corners = this.getLocalCorners();\r\n        for (var i = 0; i < 4; i++)\r\n            this.corners[i] = this.toWorldSpace(corners[i]);\r\n    }\r\n    transformCtx(ctx) {\r\n        this.updateMatrix();\r\n        var m = new Matrix2x3(this.matrix);\r\n        var v = this.camera.getScreenPos(V(m.mat[4], m.mat[5]));\r\n        m.mat[4] = v.x, m.mat[5] = v.y;\r\n        m.scale(V(1/this.camera.zoom, 1/this.camera.zoom));\r\n        ctx.setTransform(m.mat[0], m.mat[1], m.mat[2], m.mat[3], m.mat[4], m.mat[5]);\r\n    }\r\n    rotateAbout(a, c) {\r\n        this.setAngle(a);\r\n        this.setPos(this.pos.sub(c));\r\n        var cos = Math.cos(a), sin = Math.sin(a);\r\n        var xx = this.pos.x * cos - this.pos.y * sin;\r\n        var yy = this.pos.y * cos + this.pos.x * sin;\r\n        this.setPos(V(xx, yy).add(c));\r\n        this.dirty = true;\r\n        this.dirtyCorners = true;\r\n    }\r\n    setParent(t) {\r\n        this.parent = t;\r\n        this.dirty = true;\r\n        this.dirtyCorners = true;\r\n    }\r\n    setCamera(c) {\r\n        this.camera = c;\r\n    }\r\n    setPos(p) {\r\n        this.pos.x = p.x;\r\n        this.pos.y = p.y;\r\n        this.dirty = true;\r\n        this.dirtyCorners = true;\r\n    }\r\n    setAngle(a) {\r\n        this.angle = a;\r\n        this.dirty = true;\r\n        this.dirtyCorners = true;\r\n    }\r\n    setScale(s) {\r\n        this.scale.x = s.x;\r\n        this.scale.y = s.y;\r\n        this.dirty = true;\r\n    }\r\n    setSize(s) {\r\n        this.size.x = s.x;\r\n        this.size.y = s.y;\r\n        this.dirtySize = true;\r\n        this.dirtyCorners = true;\r\n    }\r\n    setWidth(w) {\r\n        this.size.x = w;\r\n        this.dirtySize = true;\r\n        this.dirtyCorners = true;\r\n    }\r\n    setHeight(h) {\r\n        this.size.y = h;\r\n        this.dirtySize = true;\r\n        this.dirtyCorners = true;\r\n    }\r\n    toLocalSpace(v) { // v must be in world coords\r\n        return this.getInverseMatrix().mul(v);\r\n    }\r\n    toWorldSpace(v) { // v must be in local coords\r\n        return this.getMatrix().mul(v);\r\n    }\r\n    getPos() {\r\n        return V(this.pos.x, this.pos.y);\r\n    }\r\n    getAngle() {\r\n        return this.angle;\r\n    }\r\n    getScale() {\r\n        return V(this.scale.x, this.scale.y);\r\n    }\r\n    getSize() {\r\n        return this.size;\r\n    }\r\n    getRadius() {\r\n        this.updateSize();\r\n        return this.radius;\r\n    }\r\n    getMatrix() {\r\n        this.updateMatrix();\r\n        return this.matrix;\r\n    }\r\n    getInverseMatrix() {\r\n        this.updateMatrix();\r\n        return this.inverse;\r\n    }\r\n    getBottomLeft() {\r\n        this.updateCorners();\r\n        return this.corners[0];\r\n    }\r\n    getBottomRight() {\r\n        this.updateCorners();\r\n        return this.corners[1];\r\n    }\r\n    getTopRight() {\r\n        this.updateCorners();\r\n        return this.corners[2];\r\n    }\r\n    getTopLeft() {\r\n        this.updateCorners();\r\n        return this.corners[3];\r\n    }\r\n    getCorners() {\r\n        this.updateCorners();\r\n        return this.corners;\r\n    }\r\n    getLocalCorners() {\r\n        this.updateSize();\r\n        return this.localCorners;\r\n    }\r\n    equals(other) {\r\n        if (!(other instanceof Transform))\r\n            return false;\r\n\r\n        var m1 = this.getMatrix().mat;\r\n        var m2 = other.getMatrix().mat;\r\n        for (var i = 0; i < m1.length; i++) {\r\n            if (m1[i] !== m2[i])\r\n                return false;\r\n        }\r\n        return true;\r\n    }\r\n    print() {\r\n        this.updateMatrix();\r\n        this.matrix.print();\r\n    }\r\n    copy() {\r\n        var trans = new Transform(this.pos.copy(), this.size.copy(), this.angle, this.camera);\r\n        trans.scale = this.scale.copy();\r\n        trans.dirty = true;\r\n        return trans;\r\n    }\r\n}\r\n","class Vector {\r\n    constructor(x, y) {\r\n        this.set(x, y);\r\n    }\r\n    set(x, y) {\r\n        if (x instanceof Vector) {\r\n            this.x = (x.x ? x.x : 0);\r\n            this.y = (x.y ? x.y : 0);\r\n        } else {\r\n            this.x = (x ? x : 0);\r\n            this.y = (y ? y : 0);\r\n        }\r\n    }\r\n    translate(dx, dy) {\r\n        if (dx instanceof Vector)\r\n            this.set(this.add(dx));\r\n        else\r\n            this.set(this.x + dx, this.y + dy);\r\n    }\r\n    add(x, y) {\r\n        if (x instanceof Vector)\r\n            return new Vector(this.x + x.x, this.y + x.y);\r\n        else\r\n            return new Vector(this.x + x, this.y + y);\r\n    }\r\n    sub(x, y) {\r\n        if (x instanceof Vector)\r\n            return new Vector(this.x - x.x, this.y - x.y);\r\n        else\r\n            return new Vector(this.x - x, this.y - y);\r\n    }\r\n    scale(a) {\r\n        if (a instanceof Vector)\r\n            return new Vector(a.x * this.x, a.y * this.y);\r\n        else\r\n            return new Vector(a * this.x, a * this.y);\r\n    }\r\n    normalize() {\r\n        var len = this.len();\r\n        if (len === 0) {\r\n            return new Vector(0, 0);\r\n        } else {\r\n            var invLen = 1 / len;\r\n            return new Vector(this.x * invLen, this.y * invLen);\r\n        }\r\n    }\r\n    len() {\r\n        return Math.sqrt(this.x*this.x + this.y*this.y);\r\n    }\r\n    len2() {\r\n        return this.x*this.x + this.y*this.y;\r\n    }\r\n    distanceTo(v) {\r\n        return this.sub(v).len();\r\n    }\r\n    dot(v) {\r\n        return this.x * v.x + this.y * v.y;\r\n    }\r\n    project(v) {\r\n        return this.scale(v.dot(this) / this.len2());\r\n    }\r\n    copy() {\r\n        return new Vector(this.x, this.y);\r\n    }\r\n}\r\n\r\n// Utility method for a new Vector\r\nfunction V(x, y) {\r\n    return new Vector(x, y);\r\n}\r\n","class Module {\r\n    constructor(parent, divName, divTextName) {\r\n        this.parent = parent;\r\n        this.div = document.getElementById(divName);\r\n        this.divtext = (divTextName ? document.getElementById(divTextName) : undefined);\r\n        this.div.oninput = () => { render(); this.onChange(); };\r\n        this.div.onclick = () => this.onClick();\r\n        this.div.onfocus = () => this.onFocus();\r\n        this.div.onblur =  () => this.onBlur();\r\n    }\r\n    blur() {\r\n        this.div.blur();\r\n    }\r\n    onShow() {}\r\n    setValue(val) {\r\n        this.div.value = val;\r\n    }\r\n    setPlaceholder(val) {\r\n        this.div.placeholder = val;\r\n    }\r\n    setVisibility(val) {\r\n        this.div.style.display = val;\r\n        if (this.divtext != undefined)\r\n            this.divtext.style.display = val;\r\n    }\r\n    setDisabled(val) {\r\n        this.div.disabled = val;\r\n    }\r\n    getValue() {\r\n        return this.div.value;\r\n    }\r\n    onChange() {}\r\n    onClick() {}\r\n    onFocus() {\r\n        this.parent.focused = true;\r\n    }\r\n    onBlur() {\r\n        this.parent.focused = false;\r\n    }\r\n}\r\n","class Popup {\r\n    constructor(divName) {\r\n        this.div = document.getElementById(divName);\r\n        this.div.addEventListener('keydown', e => {this.onKeyDown(e.keyCode);}, false);\r\n        this.div.addEventListener('keyup', e => {this.onKeyUp(e.keyCode);}, false);\r\n        this.div.style.position = \"absolute\";\r\n        this.focused = false;\r\n\r\n        this.modules = [];\r\n\r\n        this.setPos(V(0,0));\r\n        this.hide();\r\n    }\r\n    onKeyDown(code) {\r\n    }\r\n    onKeyUp(code) {\r\n    }\r\n    add(m) {\r\n        this.modules.push(m);\r\n    }\r\n    update() {\r\n        this.onShow();\r\n    }\r\n    onShow() {\r\n        for (var i = 0; i < this.modules.length; i++)\r\n            this.modules[i].onShow();\r\n    }\r\n    blur() {\r\n        for (var i = 0; i < this.modules.length; i++)\r\n            this.modules[i].blur();\r\n    }\r\n    show() {\r\n        this.hidden = false;\r\n        this.div.style.visibility = \"visible\";\r\n        this.div.focus();\r\n        this.onShow();\r\n    }\r\n    hide() {\r\n        this.hidden = true;\r\n        this.div.style.visibility = \"hidden\";\r\n        this.div.blur();\r\n    }\r\n    setPos(v) {\r\n        this.pos = V(v.x, v.y);\r\n        this.clamp();\r\n\r\n        this.div.style.left = this.pos.x + \"px\";\r\n        this.div.style.top = this.pos.y + \"px\";\r\n    }\r\n    clamp() {\r\n        this.pos.x = Math.max(Math.min(this.pos.x, window.innerWidth -this.div.clientWidth -1), ItemNavController.isOpen ? ITEMNAV_WIDTH+5 : 5);\r\n        this.pos.y = Math.max(Math.min(this.pos.y, window.innerHeight-this.div.clientHeight-1), (header ? header.clientHeight : 0)+5);\r\n    }\r\n}\r\n","class Gate extends IOObject {\r\n    constructor(context, not, x, y, img) {\r\n        super(context, x, y, DEFAULT_SIZE*(img != undefined ? img.ratio : 1), DEFAULT_SIZE, img, false, 512, 512);\r\n        this._not = (not ? true : false);\r\n        this.name = this.getDisplayName();\r\n\r\n        this.setInputAmount(2);\r\n    }\r\n    set not(value) {\r\n        this._not = value;\r\n        if (value)\r\n            this.outputs[0].isOn = !this.isOn;\r\n    }\r\n    get not() {\r\n        return this._not;\r\n    }\r\n    activate(on, i) {\r\n        super.activate((this.not ? !on : on), i);\r\n    }\r\n    draw() {\r\n        super.draw();\r\n\r\n        var renderer = this.context.getRenderer();\r\n\r\n        this.localSpace();\r\n        if (this.not) {\r\n            var l = this.transform.size.x/2+5;\r\n            renderer.circle(l, 0, 5, (this.getCol() == undefined ? '#fff' : this.getCol()), this.getBorderColor(), 2);\r\n        }\r\n        renderer.restore();\r\n    }\r\n    getDisplayName() {\r\n        return \"Gate\";\r\n    }\r\n    copy() {\r\n        var copy = super.copy();\r\n        copy.not = this.not;\r\n        return copy;\r\n    }\r\n    writeTo(node) {\r\n        var gateNode = super.writeTo(node);\r\n        createTextElement(gateNode, \"not\", this.not);\r\n        createTextElement(gateNode, \"inputcount\", this.getInputAmount());\r\n        return gateNode;\r\n    }\r\n    load(node) {\r\n        super.load(node);\r\n        var not = getBooleanValue(getChildNode(node, \"not\"));\r\n        var inputCount = getIntValue(getChildNode(node, \"inputcount\"), 1);\r\n        this.not = not;\r\n        this.setInputAmount(inputCount);\r\n        return this;\r\n    }\r\n}\r\n","class ANDGate extends Gate {\r\n    constructor(context, not, x, y) {\r\n        super(context, not, x, y, images[\"and.svg\"]);\r\n    }\r\n    setInputAmount(target) {\r\n        super.setInputAmount(target);\r\n\r\n        for (var i = 0; i < this.inputs.length; i++) {\r\n            var input = this.inputs[i];\r\n            input.origin = V(-(this.transform.size.x-2)/2, input.origin.y);\r\n        }\r\n    }\r\n    activate(x) {\r\n        var on = true;\r\n        for (var i = 0; i < this.inputs.length; i++)\r\n            on = (on && this.inputs[i].isOn);\r\n        super.activate(on);\r\n    }\r\n    draw() {\r\n        var renderer = this.context.getRenderer();\r\n\r\n        this.localSpace();\r\n        var l1 = -(this.transform.size.y/2)*(0.5-this.inputs.length/2);\r\n        var l2 = -(this.transform.size.y/2)*(this.inputs.length/2-0.5);\r\n\r\n        var s = (this.transform.size.x-2)/2;\r\n        var p1 = V(-s, l1);\r\n        var p2 = V(-s, l2);\r\n\r\n        renderer.line(p1.x, p1.y, p2.x, p2.y, this.getBorderColor(), 2);\r\n        renderer.restore();\r\n\r\n        super.draw();\r\n\r\n    }\r\n    getDisplayName() {\r\n        return this.not ? \"NAND Gate\" : \"AND Gate\";\r\n    }\r\n}\r\nANDGate.getXMLName = function() { return \"andgate\"; }\r\nImporter.types.push(ANDGate);\r\n","class BUFGate extends Gate {\r\n    constructor(context, not, x, y) {\r\n        super(context, not, x, y, images[\"buffer.svg\"]);\r\n        this.maxInputs = 1;\r\n\r\n        this.setInputAmount(1);\r\n        this.activate(false);\r\n    }\r\n    activate(x) {\r\n        var on = false;\r\n        for (var i = 0; i < this.inputs.length; i++)\r\n            on = this.inputs[i].isOn;\r\n        super.activate(on);\r\n    }\r\n    getDisplayName() {\r\n        return this.not ? \"NOT Gate\" : \"Buffer Gate\";\r\n    }\r\n}\r\nBUFGate.getXMLName = function() { return \"bufgate\"; }\r\nImporter.types.push(BUFGate);\r\n","class ORGate extends Gate {\r\n    constructor(context, not, x, y) {\r\n        super(context, not, x, y, images[\"or.svg\"]);\r\n    }\r\n    quadCurveXAt(t) {\r\n        var s = this.transform.size.x/2 - 2;\r\n        var l = this.transform.size.x/5 - 2;\r\n        var t2 = 1 - t;\r\n        return (t2*t2)*(-s) + 2*t*(t2)*(-l) + (t*t)*(-s);\r\n    }\r\n    setInputAmount(target) {\r\n        super.setInputAmount(target);\r\n\r\n        for (var i = 0; i < this.inputs.length; i++) {\r\n            var input = this.inputs[i];\r\n            var t = ((input.origin.y) / this.transform.size.y + 0.5) % 1.0;\r\n            if (t < 0)\r\n                t += 1.0;\r\n            var x = this.quadCurveXAt(t);\r\n            input.origin = V(x, input.origin.y);\r\n        }\r\n    }\r\n    activate(x) {\r\n        var on = false;\r\n        for (var i = 0; i < this.inputs.length; i++)\r\n            on = (on || this.inputs[i].isOn);\r\n        super.activate(on);\r\n    }\r\n    draw() {\r\n        var renderer = this.context.getRenderer();\r\n\r\n        this.localSpace();\r\n        var amt = 2 * Math.floor(this.inputs.length / 4) + 1;\r\n        for (var i = 0; i < amt; i++) {\r\n            var d = (i - Math.floor(amt/2)) * this.transform.size.y;\r\n            var h = 2;\r\n            var l1 = -this.transform.size.y/2;\r\n            var l2 = +this.transform.size.y/2;\r\n\r\n            var s = this.transform.size.x/2 - h;\r\n            var l = this.transform.size.x/5 - h;\r\n\r\n            var p1 = V(-s, l1 + d);\r\n            var p2 = V(-s, l2 + d);\r\n            var c  = V(-l, d);\r\n\r\n            renderer.quadCurve(p1.x, p1.y, p2.x, p2.y, c.x, c.y, this.getBorderColor(), 2);\r\n        }\r\n        renderer.restore();\r\n\r\n        super.draw();\r\n    }\r\n    getDisplayName() {\r\n        return this.not ? \"NOR Gate\" : \"OR Gate\";\r\n    }\r\n}\r\nORGate.getXMLName = function() { return \"orgate\"; }\r\nImporter.types.push(ORGate);\r\n","class XORGate extends Gate {\r\n    constructor(context, not, x, y) {\r\n        super(context, not, x, y, images[\"or.svg\"]);\r\n    }\r\n    quadCurveXAt(t) {\r\n        var s = this.transform.size.x/2 - 2;\r\n        var l = this.transform.size.x/5 - 2;\r\n        var t2 = 1 - t;\r\n        return (t2*t2)*(-s) + 2*t*(t2)*(-l) + (t*t)*(-s);\r\n    }\r\n    setInputAmount(target) {\r\n        super.setInputAmount(target);\r\n\r\n        for (var i = 0; i < this.inputs.length; i++) {\r\n            var input = this.inputs[i];\r\n            var t = ((input.origin.y) / this.transform.size.y + 0.5) % 1.0;\r\n            if (t < 0)\r\n                t += 1.0;\r\n            var x = this.quadCurveXAt(t);\r\n            input.origin = V(x, input.origin.y);\r\n        }\r\n    }\r\n    activate(x) {\r\n        var on = false;\r\n        for (var i = 0; i < this.inputs.length; i++)\r\n            on = (on !== this.inputs[i].isOn);\r\n        super.activate(on);\r\n    }\r\n    draw() {\r\n        super.draw();\r\n\r\n        var renderer = this.context.getRenderer();\r\n\r\n        this.localSpace();\r\n        var amt = 2 * Math.floor(this.inputs.length / 4) + 1;\r\n        for (var i = 0; i < amt; i++) {\r\n            var d = (i - Math.floor(amt/2)) * this.transform.size.y;\r\n            var h = 2;\r\n            var x = 12;\r\n            var l1 = -this.transform.size.y/2;\r\n            var l2 = +this.transform.size.y/2;\r\n\r\n            var s = this.transform.size.x/2 - h;\r\n            var l = this.transform.size.x/5 - h;\r\n\r\n            var p1 = V(-s, l1 + d);\r\n            var p2 = V(-s, l2 + d);\r\n            var c  = V(-l, d);\r\n\r\n            renderer.quadCurve(p1.x, p1.y, p2.x, p2.y, c.x, c.y, this.getBorderColor(), 2);\r\n            renderer.quadCurve(p1.x - x, p1.y, p2.x - x, p2.y, c.x - x, c.y, this.getBorderColor(), 2);\r\n        }\r\n\r\n        renderer.restore();\r\n    }\r\n    getDisplayName() {\r\n        return this.not ? \"XNOR Gate\" : \"XOR Gate\";\r\n    }\r\n    getXMLName() {\r\n        return \"xorgate\";\r\n    }\r\n}\r\nXORGate.getXMLName = function() { return \"xorgate\"; }\r\nImporter.types.push(XORGate);\r\n","class SRFlipFlop extends Gate {\r\n    constructor(context, x, y) {\r\n        super(context, false, x, y, undefined);\r\n        this.noChange = true;\r\n        this.setInputAmount(3);\r\n        this.setOutputAmount(2);\r\n        this.transform.setSize(this.transform.size.scale(1.5));\r\n    }\r\n    onTransformChange() {\r\n        this.transform.setSize(V(DEFAULT_SIZE, DEFAULT_SIZE));\r\n        super.onTransformChange();\r\n        this.transform.setSize(V(DEFAULT_SIZE*1.5, DEFAULT_SIZE*1.5));\r\n    }\r\n    activate(x) {\r\n        var on = this.outputs[0].isOn;\r\n\r\n        var set = this.inputs[0].isOn;\r\n        var clock = this.inputs[1].isOn;\r\n        var reset = this.inputs[2].isOn;\r\n        if (clock) {\r\n            if (set && reset) {\r\n                // undefined behavior\r\n            } else if (set) {\r\n                on = true;\r\n            } else if (reset) {\r\n                on = false;\r\n            }\r\n        }\r\n\r\n        super.activate(on, 0);\r\n        super.activate(!on, 1);\r\n    }\r\n    draw() {\r\n        super.draw();\r\n\r\n        var renderer = this.context.getRenderer();\r\n        this.localSpace();\r\n        renderer.rect(0, 0, this.transform.size.x, this.transform.size.y, this.getCol(), this.getBorderColor());\r\n        renderer.restore();\r\n    }\r\n    getDisplayName() {\r\n        return \"SR Flip Flop\";\r\n    }\r\n}\r\nSRFlipFlop.getXMLName = function() { return \"srff\"; }\r\nImporter.types.push(SRFlipFlop);\r\n","// key board input inputs\r\n\r\nclass Button extends IOObject {\r\n    constructor(context, x, y) {\r\n        super(context, x, y, DEFAULT_SIZE, DEFAULT_SIZE, images[\"buttonUp.svg\"], true, 0, 1, 60, 60);\r\n    }\r\n    press() {\r\n        super.activate(true);\r\n        this.img = images[\"buttonDown.svg\"];\r\n    }\r\n    release() {\r\n        super.activate(false);\r\n        this.img = images[\"buttonUp.svg\"];\r\n    }\r\n    contains(pos) {\r\n        return circleContains(this.transform, pos);\r\n    }\r\n    getDisplayName() {\r\n        return \"Button\";\r\n    }\r\n}\r\nButton.getXMLName = function() { return \"button\"; }\r\nImporter.types.push(Button);\r\n","class Clock extends IOObject {\r\n    constructor(context, x, y) {\r\n        super(context, x, y, 60, 60/images[\"clock.svg\"].ratio, images[\"clock.svg\"], false, 0, 1);\r\n        this.frequency = 1000;\r\n        setTimeout(() => this.tick(), this.frequency);\r\n    }\r\n    tick() {\r\n        this.activate(!this.isOn);\r\n        setTimeout(() => this.tick(), this.frequency);\r\n    }\r\n    activate(on) {\r\n        super.activate(on);\r\n        this.img = (on ? images[\"clockOn.svg\"] : images[\"clock.svg\"]);\r\n        render();\r\n    }\r\n    getDisplayName() {\r\n        return \"Clock\";\r\n    }\r\n}\r\nClock.getXMLName = function() { return \"clock\"; }\r\nImporter.types.push(Clock);\r\n","class ConstantHigh extends IOObject {\r\n    constructor(context, x, y) {\r\n        super(context, x, y, DEFAULT_SIZE, DEFAULT_SIZE, images[\"constHigh.svg\"], false, 0, 1);\r\n        super.activate(true);\r\n    }\r\n    getDisplayName() {\r\n        return \"Constant High\";\r\n    }\r\n}\r\nConstantHigh.getXMLName = function() { return \"consthigh\"; }\r\nImporter.types.push(ConstantHigh);\r\n","class ConstantLow extends IOObject {\r\n    constructor(context, x, y) {\r\n        super(context, x, y, DEFAULT_SIZE, DEFAULT_SIZE, images[\"constLow.svg\"], false, 0, 1);\r\n        super.activate(false);\r\n    }\r\n    getDisplayName() {\r\n        return \"Constant Low\";\r\n    }\r\n}\r\nConstantLow.getXMLName = function() { return \"constlow\"; }\r\nImporter.types.push(ConstantLow);\r\n","class Keyboard extends IOObject {\r\n    constructor(context, x, y) {\r\n        super(context, x, y, 3.5*DEFAULT_SIZE, 3.5*DEFAULT_SIZE/images[\"keyboard.svg\"].ratio, images[\"keyboard.svg\"], false, 0, 7);\r\n\r\n        this.setOutputAmount(7);\r\n        for (var i = 0; i < 7; i++) {\r\n            var output = this.outputs[i];\r\n\r\n            var l = -DEFAULT_SIZE/2*(i - 7/2 + 0.5);\r\n            if (i === 0) l -= 1;\r\n            if (i === 7-1) l += 1;\r\n\r\n            output.setOrigin(V(l, 0));\r\n            output.setTarget(V(l, -IO_PORT_LENGTH-(this.transform.size.y-DEFAULT_SIZE)/2));\r\n            output.dir = V(0, -1);\r\n        }\r\n    }\r\n    onKeyDown(code) {\r\n        var code = Keyboard.codeMap[code];\r\n        if (code == undefined)\r\n            return;\r\n\r\n        // Down bit\r\n        this.activate(true, this.outputs.length-1);\r\n\r\n        for (var i = this.outputs.length-2; i >= 0; i--) {\r\n            var num = 1 << i;\r\n            if (num > code) {\r\n                this.outputs[i].activate(false);\r\n            } else {\r\n                this.outputs[i].activate(true);\r\n                code -= num;\r\n            }\r\n        }\r\n    }\r\n    onKeyUp(code) {\r\n        var code = Keyboard.codeMap[code];\r\n        if (code == undefined)\r\n            return;\r\n\r\n        // Up bit\r\n        this.activate(false, this.outputs.length-1);\r\n\r\n        for (var i = this.outputs.length-2; i >= 0; i--) {\r\n            this.outputs[i].activate(false);\r\n            // var num = 1 << i;\r\n            // if (num > code) {\r\n            //     this.outputs[i].activate(false);\r\n            // } else {\r\n            //     this.outputs[i].activate(true);\r\n            //     code -= num;\r\n            // }\r\n        }\r\n    }\r\n    getDisplayName() {\r\n        return \"Keyboard\";\r\n    }\r\n}\r\nKeyboard.getXMLName = function() { return \"keyboard\"; }\r\nImporter.types.push(Keyboard);\r\n\r\nKeyboard.codeMap = [];\r\nKeyboard.codeCount = 0;\r\n\r\nKeyboard.addKey = function(code) {\r\n    Keyboard.codeMap[code] = (++Keyboard.codeCount);\r\n}\r\n\r\n// Add numbers 0-9\r\nfor (var code = 48; code <= 57; code++)\r\n    Keyboard.addKey(code);\r\n\r\n// Add letters a-z\r\nfor (var code = 65; code <= 90; code++)\r\n    Keyboard.addKey(code);\r\n\r\nKeyboard.addKey(32); // Space\r\nKeyboard.addKey(13); // Enter\r\nKeyboard.addKey(8); // Delete\r\nKeyboard.addKey(9); // Tab\r\nKeyboard.addKey(16); // LShift\r\nKeyboard.addKey(17); // LCtrl\r\nKeyboard.addKey(18); // LOption\r\nKeyboard.addKey(91); // LCommand\r\nKeyboard.addKey(20); // Caps lock\r\nKeyboard.addKey(27); // Escape\r\nKeyboard.addKey(192); // Tilda\r\nKeyboard.addKey(189); // Minus\r\nKeyboard.addKey(187); // Plus\r\nKeyboard.addKey(219); // LBracket\r\nKeyboard.addKey(221); // RBracket\r\nKeyboard.addKey(220); // Backslash\r\nKeyboard.addKey(186); // Semicolon\r\nKeyboard.addKey(222); // Quote\r\nKeyboard.addKey(188); // Comma\r\nKeyboard.addKey(190); // Period\r\nKeyboard.addKey(191); // Forwardslash\r\nKeyboard.addKey(37); // Left\r\nKeyboard.addKey(38); // Up\r\nKeyboard.addKey(39); // Right\r\nKeyboard.addKey(40); // Down\r\nKeyboard.addKey(112); // F1\r\nKeyboard.addKey(112); // F2\r\n\r\nconsole.log(Keyboard.codeCount);\r\n","class Switch extends IOObject {\r\n    constructor(context, x, y) {\r\n        super(context, x, y, 60*images[\"switchUp.svg\"].ratio, 60, images[\"switchUp.svg\"], true, 0, 1, 77*images[\"switchUp.svg\"].ratio, 77);\r\n    }\r\n    activate(on) {\r\n        super.activate(on);\r\n        this.img = images[this.isOn ? \"switchDown.svg\" : \"switchUp.svg\"];\r\n    }\r\n    click() {\r\n        super.click();\r\n        this.activate(!this.isOn);\r\n    }\r\n    getDisplayName() {\r\n        return \"Switch\";\r\n    }\r\n    writeTo(node) {\r\n        var switchNode = super.writeTo(node);\r\n        createTextElement(switchNode, \"isOn\", this.outputs[0].isOn);\r\n        return switchNode;\r\n    }\r\n}\r\nSwitch.getXMLName = function() { return \"switch\"; }\r\nImporter.types.push(Switch);\r\n","class Decoder extends Gate {\r\n    constructor(context, x, y) {\r\n        super(context, false, x, y, undefined);\r\n        this.activate(0);\r\n    }\r\n    onTransformChange() {\r\n        this.transform.setSize(V(DEFAULT_SIZE, DEFAULT_SIZE));\r\n        super.onTransformChange();\r\n        this.transform.setSize(V(DEFAULT_SIZE, DEFAULT_SIZE/2*(2 << (this.inputs.length-1))));\r\n    }\r\n    setInputAmount(target) {\r\n        target = clamp(target, 0, 8);\r\n        super.setInputAmount(target);\r\n        super.setOutputAmount(2 << (target-1));\r\n    }\r\n    getInputAmount() {\r\n        return this.inputs.length;\r\n    }\r\n    activate(x) {\r\n        var num = 0;\r\n        for (var i = 0; i < this.inputs.length; i++)\r\n            num = num | ((this.inputs[i].isOn ? 1 : 0) << i);\r\n        for (var i = 0; i < this.outputs.length; i++)\r\n            this.outputs[i].activate(i === num, i);\r\n    }\r\n    draw() {\r\n        super.draw();\r\n\r\n        var renderer = this.context.getRenderer();\r\n        this.localSpace();\r\n        renderer.rect(0, 0, this.transform.size.x, this.transform.size.y, this.getCol(), this.getBorderColor());\r\n        renderer.restore();\r\n    }\r\n    getMinInputFieldCount() {\r\n        return 1;\r\n    }\r\n    getDisplayName() {\r\n        return \"Decoder\";\r\n    }\r\n}\r\nDecoder.getXMLName = function() { return \"decoder\"; }\r\nImporter.types.push(Decoder);\r\n","class Demultiplexer extends Gate {\r\n    constructor(context, x, y) {\r\n        super(context, false, x, y, undefined);\r\n    }\r\n    setInputAmount(target) {\r\n        super.setInputAmount(target + 1);\r\n        super.setOutputAmount(2 << (target-1));\r\n\r\n        var width = Math.max(DEFAULT_SIZE/2*(target-1), DEFAULT_SIZE);\r\n        var height = DEFAULT_SIZE/2*(2 << (target-1));\r\n        this.transform.setSize(V(width+10, height));\r\n\r\n        this.selectLines = [];\r\n        for (var i = 0; i < target; i++) {\r\n            var input = this.inputs[i];\r\n            this.selectLines.push(input);\r\n\r\n            var l = -DEFAULT_SIZE/2*(i - target/2 + 0.5);\r\n            if (i === 0) l -= 1;\r\n            if (i === target-1) l += 1;\r\n\r\n            input.setOrigin(V(l, 0));\r\n            input.setTarget(V(l, IO_PORT_LENGTH+height/2-DEFAULT_SIZE/2));\r\n        }\r\n        for (var i = 0; i < this.outputs.length; i++) {\r\n            var output = this.outputs[i];\r\n\r\n            var l = -DEFAULT_SIZE/2*(i - (this.outputs.length)/2 + 0.5);\r\n            if (i === 0) l -= 1;\r\n            if (i === this.outputs.length-1) l += 1;\r\n\r\n            output.setOrigin(V(0, l));\r\n            output.setTarget(V(IO_PORT_LENGTH+(width/2-DEFAULT_SIZE/2), l));\r\n        }\r\n        var input = this.inputs[this.inputs.length-1];\r\n        input.setOrigin(V(0, 0));\r\n        input.setTarget(V(-IO_PORT_LENGTH-(width/2-DEFAULT_SIZE/2), 0));\r\n    }\r\n    getInputAmount() {\r\n        return this.selectLines.length;\r\n    }\r\n    activate(x) {\r\n        var num = 0;\r\n        for (var i = 0; i < this.selectLines.length; i++) {\r\n            num = num | ((this.selectLines[i].isOn ? 1 : 0) << i);\r\n        }\r\n        super.activate(this.inputs[this.inputs.length-1].isOn, num);\r\n        // var num = 0;\r\n        // for (var i = 0; i < this.selectLines.length; i++)\r\n        //     num = num | ((this.selectLines[i].isOn ? 1 : 0) << i);\r\n        // super.activate(this.inputs[num + this.selectLines.length].isOn);\r\n    }\r\n    draw() {\r\n        super.draw();\r\n\r\n        var renderer = this.context.getRenderer();\r\n        this.localSpace();\r\n\r\n        var p1 = V(this.transform.size.x/2, this.transform.size.y/2);\r\n        var p2 = V(this.transform.size.x/2, -this.transform.size.y/2);\r\n        var p3 = V(-this.transform.size.x/2, -this.transform.size.y/2+20);\r\n        var p4 = V(-this.transform.size.x/2, this.transform.size.y/2-20);\r\n\r\n        renderer.shape([p1, p2, p3, p4], this.getCol(), this.getBorderColor(), 2);\r\n\r\n        renderer.restore();\r\n    }\r\n    getMinInputFieldCount() {\r\n        return 1;\r\n    }\r\n    getDisplayName() {\r\n        return \"Demultiplexer\";\r\n    }\r\n}\r\nDemultiplexer.getXMLName = function() { return \"demux\"; }\r\nImporter.types.push(Demultiplexer);\r\n","class Encoder extends Gate {\r\n    constructor(context, x, y) {\r\n        super(context, false, x, y, undefined);\r\n    }\r\n    onTransformChange() {\r\n        this.transform.setSize(V(DEFAULT_SIZE, DEFAULT_SIZE));\r\n        super.onTransformChange();\r\n        this.transform.setSize(V(DEFAULT_SIZE, DEFAULT_SIZE/2*(2 << (this.outputs.length-1))));\r\n    }\r\n    setInputAmount(target) {\r\n        target = clamp(target, 0, 8);\r\n        super.setInputAmount(2 << (target-1));\r\n        super.setOutputAmount(target);\r\n    }\r\n    getInputAmount() {\r\n        return this.outputs.length;\r\n    }\r\n    activate(x) {\r\n        var indx = -1;\r\n        for (var i = 0; i < this.inputs.length; i++) {\r\n            if (this.inputs[i].isOn) {\r\n                if (indx !== -1)\r\n                    return; // undefined behavior\r\n                indx = i;\r\n            }\r\n        }\r\n        if (indx === -1)\r\n            return; // undefined behavior\r\n        for (var i = this.outputs.length-1; i >= 0; i--) {\r\n            var num = 1 << i;\r\n            if (num > indx) {\r\n                this.outputs[i].activate(false);\r\n            } else {\r\n                this.outputs[i].activate(true);\r\n                indx -= num;\r\n            }\r\n        }\r\n    }\r\n    draw() {\r\n        super.draw();\r\n\r\n        var renderer = this.context.getRenderer();\r\n        this.localSpace();\r\n        renderer.rect(0, 0, this.transform.size.x, this.transform.size.y, this.getCol(), this.getBorderColor());\r\n        renderer.restore();\r\n    }\r\n    getMinInputFieldCount() {\r\n        return 1;\r\n    }\r\n    getDisplayName() {\r\n        return \"Encoder\";\r\n    }\r\n}\r\nEncoder.getXMLName = function() { return \"encoder\"; }\r\nImporter.types.push(Encoder);\r\n","class IC extends IOObject {\r\n    constructor(context, data, x, y) {\r\n        super(context, x, y, 50, 50, undefined, false, 999, 999);\r\n        this.data = data;\r\n        this.setup();\r\n    }\r\n    setup() {\r\n        if (this.data == undefined)\r\n            return;\r\n\r\n        // Setup input and outputs\r\n        this.setInputAmount(this.data.getInputAmount());\r\n        this.setOutputAmount(this.data.getOutputAmount());\r\n\r\n        // Copy object references\r\n        var copy = this.data.copy();\r\n        this.inputObjects = copy.inputs;\r\n        this.outputObjects = copy.outputs;\r\n        this.components = copy.components;\r\n        for (var i = 0; i < this.outputObjects.length; i++) {\r\n            var ii = i;\r\n            var port = this.outputs[i];\r\n            this.outputObjects[i].activate = function(on) {\r\n                port.activate(on);\r\n            }\r\n        }\r\n        this.noChange = true;\r\n\r\n        this.update();\r\n    }\r\n    update() {\r\n        if (this.data == undefined)\r\n            return;\r\n\r\n        // Update size\r\n        this.transform.setWidth(this.data.getWidth());\r\n        this.transform.setHeight(this.data.getHeight());\r\n\r\n        // Update port positions\r\n        for (var i = 0; i < this.inputs.length; i++) {\r\n            this.inputs[i].setOrigin(this.data.iports[i].origin);\r\n            this.inputs[i].setTarget(this.data.iports[i].target);\r\n        }\r\n        for (var i = 0; i < this.outputs.length; i++) {\r\n            this.outputs[i].setOrigin(this.data.oports[i].origin);\r\n            this.outputs[i].setTarget(this.data.oports[i].target);\r\n        }\r\n\r\n        this.activate();\r\n    }\r\n    activate() {\r\n        for (var i = 0; i < this.inputs.length; i++) {\r\n            this.inputObjects[i].activate(this.inputs[i].isOn);\r\n        }\r\n    }\r\n    draw() {\r\n        var renderer = this.context.getRenderer();\r\n\r\n        super.draw();\r\n\r\n        this.localSpace();\r\n\r\n        var size = this.transform.size;\r\n        renderer.rect(0, 0, size.x, size.y, this.getCol(), '#000000', 1);\r\n\r\n        for (var i = 0; i < this.inputs.length; i++) {\r\n            var name = this.inputObjects[i].getName();\r\n            var pos1 = this.transform.toLocalSpace(this.inputs[i].getPos());\r\n            var align = \"center\";\r\n            var padding = 8;\r\n            var ww = renderer.getTextWidth(name)/2;\r\n            var pos = getNearestPointOnRect(V(-size.x/2, -size.y/2), V(size.x/2, size.y/2), pos1);\r\n            pos = pos.sub(pos1).normalize().scale(padding).add(pos);\r\n            pos.x = clamp(pos.x, -size.x/2+padding+ww, size.x/2-padding-ww);\r\n            pos.y = clamp(pos.y, -size.y/2+14, size.y/2-14);\r\n            renderer.text(name, pos.x, pos.y, 0, 0, align);\r\n        }\r\n        for (var i = 0; i < this.outputs.length; i++) {\r\n            var name = this.outputObjects[i].getName();\r\n            var pos1 = this.transform.toLocalSpace(this.outputs[i].getPos());\r\n            var align = \"center\";\r\n            var padding = 8;\r\n            var ww = renderer.getTextWidth(name)/2;\r\n            var pos = getNearestPointOnRect(V(-size.x/2, -size.y/2), V(size.x/2, size.y/2), pos1);\r\n            pos = pos.sub(pos1).normalize().scale(padding).add(pos);\r\n            pos.x = clamp(pos.x, -size.x/2+padding+ww, size.x/2-padding-ww);\r\n            pos.y = clamp(pos.y, -size.y/2+14, size.y/2-14);\r\n            renderer.text(name, pos.x, pos.y, 0, 0, align);\r\n        }\r\n\r\n        renderer.restore();\r\n    }\r\n    getDisplayName() {\r\n        return \"IC\";\r\n    }\r\n    copy() {\r\n        return new IC(this.context, this.data, this.transform.pos.x, this.transform.pos.y);\r\n    }\r\n    writeTo(node) {\r\n        var ICNode = super.writeTo(node);\r\n        createTextElement(ICNode, \"icuid\", this.data.getUID());\r\n        return ICNode;\r\n    }\r\n    load(node, ics) {\r\n        super.load(node);\r\n        var icuid = getIntValue(getChildNode(node, \"icuid\"));\r\n        var data = findIC(icuid, ics);\r\n        this.data = data;\r\n        this.setup();\r\n        return this;\r\n    }\r\n}\r\nIC.getXMLName = function() { return \"ic\"; }\r\nImporter.types.push(IC);\r\n","class ICData {\r\n    constructor(inputs, outputs, components) {\r\n        this.transform = new Transform(V(0,0),V(0,0),0);\r\n        this.inputs = inputs;\r\n        this.outputs = outputs;\r\n        this.components = components;\r\n        this.wires = getAllWires(this.getObjects());\r\n\r\n        this.uidmanager = new UIDManager(this);\r\n\r\n        // Give everything a uid\r\n        var objects = this.getObjects();\r\n        for (var i = 0; i < objects.length; i++)\r\n            this.uidmanager.giveUIDTo(objects[i]);\r\n        for (var i = 0; i < this.wires.length; i++)\r\n            this.uidmanager.giveUIDTo(this.wires[i]);\r\n\r\n        // Set start size based on length of names and amount of ports\r\n        var longestName = 0;\r\n        for (var i = 0; i < this.inputs.length; i++)\r\n            longestName = Math.max(this.inputs[i].getName().length, longestName);\r\n        for (var i = 0; i < this.outputs.length; i++)\r\n            longestName = Math.max(this.outputs[i].getName().length, longestName);\r\n        var w = DEFAULT_SIZE + 20*longestName;\r\n        var h = DEFAULT_SIZE/2*(Math.max(this.inputs.length, this.outputs.length));\r\n        this.transform.setSize(V(w, h));\r\n\r\n        // Create and position ioports\r\n        this.iports = [];\r\n        this.oports = [];\r\n        for (var i = 0; i < this.inputs.length; i++) {\r\n            this.iports[i] = new IPort();\r\n\r\n            var l = -DEFAULT_SIZE/2*(i - (this.inputs.length)/2 + 0.5);\r\n            if (i === 0) l -= 1;\r\n            if (i === this.inputs.length-1) l += 1;\r\n\r\n            this.iports[i].setOrigin(V(0, l));\r\n            this.iports[i].setTarget(V(-IO_PORT_LENGTH-(w/2-DEFAULT_SIZE/2), l));\r\n        }\r\n        for (var i = 0; i < this.outputs.length; i++) {\r\n            this.oports[i] = new OPort();\r\n\r\n            var l = -DEFAULT_SIZE/2*(i - (this.outputs.length)/2 + 0.5);\r\n            if (i === 0) l -= 1;\r\n            if (i === this.outputs.length-1) l += 1;\r\n\r\n            this.oports[i].setOrigin(V(0, l));\r\n            this.oports[i].setTarget(V(IO_PORT_LENGTH+(w/2-DEFAULT_SIZE/2), l));\r\n        }\r\n\r\n        this.recalculatePorts();\r\n    }\r\n    recalculatePorts() {\r\n        var size = this.transform.size;\r\n\r\n        var inputs = this.iports;\r\n        for (var i = 0; i < inputs.length; i++) {\r\n            var inp = inputs[i];\r\n            // Scale by large number to make sure that the target pos is not in the IC\r\n            var targ = this.transform.getMatrix().mul(inp.target);\r\n            var orig = this.transform.getMatrix().mul(inp.origin);\r\n            var pos = targ.add(targ.sub(orig).normalize().scale(10000));\r\n            var p = getNearestPointOnRect(V(-size.x/2, -size.y/2), V(size.x/2, size.y/2), pos);\r\n            var v1 = p.sub(pos).normalize().scale(size.scale(0.5)).add(p);\r\n            var v2 = p.sub(pos).normalize().scale(size.scale(0.5).sub(V(IO_PORT_LENGTH+size.x/2-25, IO_PORT_LENGTH+size.y/2-25))).add(p);\r\n            inp.setOrigin(v1);\r\n            inp.setTarget(v2);\r\n        }\r\n        var outputs = this.oports;\r\n        for (var i = 0; i < outputs.length; i++) {\r\n            var out = outputs[i];\r\n            // Scale by large number to make sure that the target pos is not in the IC\r\n            var targ = this.transform.getMatrix().mul(out.target);\r\n            var orig = this.transform.getMatrix().mul(out.origin);\r\n            var pos = targ.add(targ.sub(orig).normalize().scale(10000));\r\n            var p = getNearestPointOnRect(V(-size.x/2, -size.y/2), V(size.x/2, size.y/2), pos);\r\n            var v1 = p.sub(pos).normalize().scale(size.scale(0.5)).add(p);\r\n            var v2 = p.sub(pos).normalize().scale(size.scale(0.5).sub(V(IO_PORT_LENGTH+size.x/2-25, IO_PORT_LENGTH+size.y/2-25))).add(p);\r\n            out.setOrigin(v1);\r\n            out.setTarget(v2);\r\n        }\r\n    }\r\n    getInputAmount() {\r\n        return this.inputs.length;\r\n    }\r\n    getOutputAmount() {\r\n        return this.outputs.length;\r\n    }\r\n    copy() {\r\n        return separateGroup(copyGroup(this.getObjects()).objects);\r\n    }\r\n    getUID() {\r\n        return this.icuid;\r\n    }\r\n    getObjects() {\r\n        return this.inputs.concat(this.components, this.outputs);\r\n    }\r\n    getWires() {\r\n        return this.wires;\r\n    }\r\n    getWidth() {\r\n        return this.transform.getSize().x;\r\n    }\r\n    getHeight() {\r\n        return this.transform.getSize().y;\r\n    }\r\n}\r\nICData.create = function(objects) {\r\n    objects = copyGroup(objects).objects;\r\n    var separate = separateGroup(objects);\r\n    for (var i = 0; i < separate.inputs.length; i++) {\r\n        var input = separate.inputs[i];\r\n        if (input instanceof Clock && input.getName() === input.getDisplayName())\r\n            input.setName(\">\");\r\n    }\r\n    return new ICData(separate.inputs, separate.outputs, separate.components);\r\n}\r\nICData.add = function(data) {\r\n    data.icuid = ICData.ICs.length;\r\n    ICData.ICs.push(data);\r\n}\r\nICData.redistributeUIDs = function() {\r\n    var ics = [];\r\n    for (var i = 0; i < ICData.ICs.length; i++)\r\n        ics[i] = ICData.ICs[i];\r\n    ICData.ICs = [];\r\n    for (var i = 0; i < ics.length; i++) {\r\n        ics[i].icuid = i;\r\n        ICData.ICs[i] = ics[i];\r\n    }\r\n}\r\nICData.ICs = [];\r\n","class Label extends IOObject {\r\n    constructor(context, x, y) {\r\n        super(context, x, y, 0, 0, undefined, true, 0, 0, 60, 30);\r\n        this.setName(\"LABEL\");\r\n\r\n        this.setInputAmount(0);\r\n        this.setOutputAmount(0);\r\n    }\r\n    activate(x) {\r\n    }\r\n    draw() {\r\n        super.draw();\r\n\r\n        var renderer = this.context.getRenderer();\r\n\r\n        this.localSpace();\r\n\r\n        var align = \"center\";\r\n        var padding = 8;\r\n        var ww = renderer.getTextWidth(this.text)/2;\r\n        var pos = V(0, 0);\r\n        renderer.text(this.name, pos.x, pos.y, 0, 0, align);\r\n\r\n        renderer.restore();\r\n    }\r\n    setName(name) {\r\n        super.setName(name);\r\n        var renderer = this.context.getRenderer();\r\n        var width = renderer.getTextWidth(this.name) + 20;\r\n        this.selectionBoxTransform.setSize(V(width, this.selectionBoxTransform.size.y));\r\n        this.onTransformChange();\r\n        render();\r\n    }\r\n    getDisplayName() {\r\n        return this.name;\r\n    }\r\n}\r\nLabel.getXMLName = function() { return \"label\"; }\r\nImporter.types.push(Label);\r\n","class Multiplexer extends Gate {\r\n    constructor(context, x, y) {\r\n        super(context, false, x, y, undefined);\r\n    }\r\n    setInputAmount(target) {\r\n        super.setInputAmount(target + (2 << (target-1)));\r\n\r\n        var width = Math.max(DEFAULT_SIZE/2*(target-1), DEFAULT_SIZE);\r\n        var height = DEFAULT_SIZE/2*(2 << (target-1));\r\n        this.transform.setSize(V(width+10, height));\r\n\r\n        this.selectLines = [];\r\n        for (var i = 0; i < target; i++) {\r\n            var input = this.inputs[i];\r\n            this.selectLines.push(input);\r\n\r\n            var l = -DEFAULT_SIZE/2*(i - target/2 + 0.5);\r\n            if (i === 0) l -= 1;\r\n            if (i === target-1) l += 1;\r\n\r\n            input.setOrigin(V(l, 0));\r\n            input.setTarget(V(l, IO_PORT_LENGTH+height/2-DEFAULT_SIZE/2));\r\n        }\r\n        for (var ii = target; ii < this.inputs.length; ii++) {\r\n            var input = this.inputs[ii];\r\n\r\n            var i = ii - target;\r\n\r\n            var l = -DEFAULT_SIZE/2*(i - (this.inputs.length-target)/2 + 0.5);\r\n            if (i === 0) l -= 1;\r\n            if (i === this.inputs.length-target-1) l += 1;\r\n\r\n            input.setOrigin(V(0, l));\r\n            input.setTarget(V(-IO_PORT_LENGTH-(width/2-DEFAULT_SIZE/2), l));\r\n        }\r\n        var output = this.outputs[0];\r\n        output.target = V(IO_PORT_LENGTH+(width/2-DEFAULT_SIZE/2), output.target.y);\r\n    }\r\n    getInputAmount() {\r\n        return this.selectLines.length;\r\n    }\r\n    activate(x) {\r\n        var num = 0;\r\n        for (var i = 0; i < this.selectLines.length; i++)\r\n            num = num | ((this.selectLines[i].isOn ? 1 : 0) << i);\r\n        super.activate(this.inputs[num + this.selectLines.length].isOn);\r\n    }\r\n    draw() {\r\n        super.draw();\r\n\r\n        var renderer = this.context.getRenderer();\r\n        this.localSpace();\r\n\r\n        var p1 = V(-this.transform.size.x/2, this.transform.size.y/2);\r\n        var p2 = V(-this.transform.size.x/2, -this.transform.size.y/2);\r\n        var p3 = V(this.transform.size.x/2, -this.transform.size.y/2+20);\r\n        var p4 = V(this.transform.size.x/2, this.transform.size.y/2-20);\r\n\r\n        renderer.shape([p1, p2, p3, p4], this.getCol(), this.getBorderColor(), 2);\r\n\r\n        renderer.restore();\r\n    }\r\n    getMinInputFieldCount() {\r\n        return 1;\r\n    }\r\n    getDisplayName() {\r\n        return \"Multiplexer\";\r\n    }\r\n    getXMLName() {\r\n        return \"mux\";\r\n    }\r\n}\r\nMultiplexer.getXMLName = function() { return \"mux\"; }\r\nImporter.types.push(Multiplexer);\r\n","class LED extends IOObject {\r\n    constructor(context, x, y, color) {\r\n        super(context, x, y, DEFAULT_SIZE, DEFAULT_SIZE, images[\"led.svg\"], false, 1, 0);\r\n        this.transform.setPos(V(this.transform.pos.x, this.transform.pos.y - 2*this.transform.size.y));\r\n        this.color = (color == undefined) ? (\"#ffffff\") : (color);\r\n        this.connectorWidth = 5;\r\n\r\n        this.setInputAmount(1);\r\n        this.inputs[0].setOrigin(V(0, 0));\r\n        this.inputs[0].setTarget(V(0, 2*this.transform.size.y));\r\n        this.inputs[0].lineColor = '#ffffff';\r\n        this.inputs[0].dir = V(0, 1);\r\n    }\r\n    updateCullTransform() {\r\n        super.updateCullTransform();\r\n        if (this.isOn) {\r\n            this.cullTransform.setSize(V(3*this.transform.size.x, 4*this.transform.size.y));\r\n            this.cullTransform.setPos(this.transform.pos.add(V(0, (this.inputs[0].target.y - this.transform.size.y*3/2)/2)));\r\n        }\r\n    }\r\n    activate(on, i) {\r\n        super.activate(on, i);\r\n        this.updateCullTransform();\r\n    }\r\n    getImageTint() {\r\n        return this.color;\r\n    }\r\n    draw() {\r\n        super.draw();\r\n\r\n        var renderer = this.context.getRenderer();\r\n\r\n        this.localSpace();\r\n        if (this.isOn)\r\n            renderer.image(images[\"ledLight.svg\"], 0, 0, 3*this.transform.size.x, 3*this.transform.size.y, this.color);\r\n        renderer.restore();\r\n    }\r\n    getDisplayName() {\r\n        return \"LED\";\r\n    }\r\n    copy() {\r\n        var copy = super.copy();\r\n        copy.color = this.color;\r\n        copy.connectorWidth = this.connectorWidth;\r\n        return copy;\r\n    }\r\n    writeTo(node) {\r\n        var LEDNode = super.writeTo(node);\r\n        createTextElement(LEDNode, \"color\", this.color);\r\n        return LEDNode;\r\n    }\r\n    load(node) {\r\n        super.load(node);\r\n        var color = getStringValue(getChildNode(node, \"color\"));\r\n        this.color = color;\r\n        return this;\r\n    }\r\n}\r\nLED.getXMLName = function() { return \"led\"; }\r\nImporter.types.push(LED);\r\n","class SevenSegmentDisplay extends IOObject {\r\n    constructor(context, x, y) {\r\n        super(context, x, y, 100*7/10, 100, undefined, false, 7, 0);\r\n        this.setInputAmount(7);\r\n        this.noChange = true;\r\n        this.segmentWidth = 45;\r\n        this.segmentHeight = 10;\r\n\r\n        for (var ii = 0; ii < 7; ii++) {\r\n            var iport = this.inputs[ii];\r\n            var i = iport.getIndex();\r\n\r\n            var l = -15*(i - iport.getArray().length/2.0 + 0.5);\r\n\r\n            iport.setOrigin(V(iport.origin.x, l));\r\n            iport.setTarget(V(iport.target.x, l));\r\n        }\r\n        var w = this.transform.size.x;\r\n        var h = this.transform.size.y;\r\n\r\n        var padding = 15;\r\n\r\n        var sw = this.segmentWidth;\r\n        var sh = this.segmentHeight;\r\n\r\n        this.segmentPositions = [V(0, -sw+sh),\r\n                                 V(sw/2-sh/2, (-sw+sh)/2),\r\n                                 V(sw/2-sh/2, (+sw-sh)/2),\r\n                                 V(0, sw-sh),\r\n                                 V(-sw/2+sh/2, (+sw-sh)/2),\r\n                                 V(-sw/2+sh/2, (-sw+sh)/2),\r\n                                 V(0, 0)];\r\n        this.segmentSizes = [V(sw,sh), V(sh,sw), V(sh, sw), V(sw, sh), V(sh, sw), V(sh, sw), V(sw, sh)];\r\n        this.segmentImages = [images[\"segment1.svg\"], images[\"segment2.svg\"], images[\"segment2.svg\"], images[\"segment1.svg\"], images[\"segment2.svg\"], images[\"segment2.svg\"], images[\"segment1.svg\"]];\r\n        this.segmentOnImages = [images[\"segment3.svg\"], images[\"segment4.svg\"], images[\"segment4.svg\"], images[\"segment3.svg\"], images[\"segment4.svg\"], images[\"segment4.svg\"], images[\"segment3.svg\"]];\r\n    }\r\n    draw() {\r\n        super.draw();\r\n\r\n        this.localSpace();\r\n        var renderer = this.context.getRenderer();\r\n        renderer.rect(0, 0, this.transform.size.x, this.transform.size.y, this.getCol(), this.getBorderColor());\r\n\r\n        for (var i = 0; i < 7; i++) {\r\n            var pos = this.segmentPositions[i];\r\n            var size = this.segmentSizes[i];\r\n            var on = this.inputs[i].isOn;\r\n            var img = (on ? this.segmentOnImages[i] : this.segmentImages[i]);\r\n\r\n            renderer.image(img, pos.x, pos.y, size.x, size.y, undefined);\r\n        }\r\n\r\n        renderer.restore();\r\n    }\r\n    getDisplayName() {\r\n        return \"7 Segment Display\";\r\n    }\r\n    getXMLName() {\r\n        return \"sevensegmentdisplay\";\r\n    }\r\n}\r\nSevenSegmentDisplay.getXMLName = function() { return \"sevensegmentdisplay\"; }\r\nImporter.types.push(SevenSegmentDisplay);\r\n"]}